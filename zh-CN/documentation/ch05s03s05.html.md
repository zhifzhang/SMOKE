::: {.navheader}
5.3.5. **Gentpro**
:::

[Prev](ch05s03s04.html) 

5.3.  SMOKE Utility Programs

 [Next](ch05s03s06.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_utilities_gentpro}5.3.5. **Gentpro** {#gentpro .title}

</div>

</div>
:::

::: {.toc}
[[5.3.5.1. Description](ch05s03s05.html#d0e19089)]{.section}

[[5.3.5.2. Processing Order](ch05s03s05.html#d0e19516)]{.section}

[[5.3.5.3. Files and Environment
Variables](ch05s03s05.html#d0e19524)]{.section}
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e19089}5.3.5.1. Description {#description .title}

</div>

</div>
:::

The **Gentpro** program estimates emissions temporal profiles for
residential wood combustion (RWC), agricultural ammonia (RC\_NH3),
livestock ammonia (BASH\_NH3) or generic area sources by relating
meteorology to air emission fluxes. **Gentpro** reads in hourly gridded
meteorology data from the Meteorology-Chemistry Interface Processor
(MCIP) and a gridded spatial surrogate (commonly used in SMOKE) to
produce temporal profiles and cross-reference data in a comma separated
value (CSV) format and/or a temporal data binary netCDF file. Annual
MCIP input data are required to calculate temporal profiles with
**Gentpro**. Spatial surrogate(s) are used to identify the grid cells
for computing county averaged meteorology variables.

**Gentpro** provides an option to specify a profile method
\[`PROFILE_METHOD`{.envar}\], which can be set to generate RWC,
BASH\_NH3, RC\_HNH3, or generic meteorology-based temporal profiles. the
RWC, BASH\_NH3 and RC\_NH3 temporal profiles are based on algorithms
described by Adelman (2009 and 2010), Mansell et al. (2000), and Bash et
al. (2012) respectively, while the MET profiles can ben generated from
any user-selected meteorology variable. The RWC profile method produces
county-specific daily temporal profiles to convert annual or monthly
inventories to daily emissions estimates. Diurnal profiles must then be
applied to estimate hourly RWC emissions from the daily estimates.
**Gentpro** provides the option to aggregate the daily RWC profiles to
month-of-year profiles as well, which can be used to compute monthly
inventory estimates from annual inventory data. The BASH\_NH3 and
RC\_NH3 profile methods produce county-specific hourly temporal profiles
to convert annual, monthly, or daily inventories to hourly emissions
estimates. **Gentpro** provides the option to aggregate the hourly
profiles to day-of-year or month-of-year profiles as well. The MET
profile method represents time series of a selected meteorology variable
as a temporal profile and can be used to convert annual, monthly, or
daily inventories to hourly emissions estimates. **Gentpro** also
provides the option to aggregate the hourly MET profiles to day-of-year
or month-of-year profiles. All of the **Gentpro** profile options create
temporal cross-reference files that associate county FIPS codes in a
modeling domain to the new profiles.

**\[1\] RWC**

A regression equation relating observed daily minimum temperatures and
chemical tracers of wood combustion was developed using data from sites
in the Pacific Northwest of the United States (Adelman, 2009; Adelman,
2010). The sites selected to develop the algorithm were screened to be
representative of RWC activities. Equation (1) uses estimates of daily
PM2.5 emissions to build either annual-to-daily or annual-to-monthly
emission profiles for application to RWC sources. The algorithm uses
county average daily or monthly minimum temperatures to estimate the
percentage of RWC emissions allocated to each day or month of the year.
**Gentpro** includes a temperature threshold setting to limit RWC
emissions from allocated to days too warm to have much (if any) RWC
emissions. A temperature threshold (T~t~) variable is implemented in
**Gentpro** to allow users to set a maximum temperature cutoff by either
state or county. By default, **Gentpro** estimates RWC emissions at
temperatures below 50°F. If the temperature threshold variable is set in
the Gentpro script, RWC emissions will be activated below T~t~. A
look-up table of state/county FIPs codes and temperatures (°F) can be
input to **Gentpro** to set several different temperature thresholds
across a modeling domain. The purpose of using the temperature threshold
override is to control when RWC emissions are activated in regions where
the 50°F cutoff may not be appropriate. For example, counties in
southern Florida may only experience one or two days in an entire year
when the minimum temperature dips below 50°F. Without using the
threshold override, all of the RWC emissions for these counties will be
allocated to these one or two days, producing large emissions spikes
that may not be realistic. By increasing the temperature threshold,
these spikes can be avoided by activating the RWC algorithm on other
days. The outputs from this algorithm are temporal profiles that convert
annual or monthly RWC inventories to daily emissions for every county in
the modeling domain.

Two alternative RWC temporal profile algorithms are implemented in
**Gentpro**. Equation 1 below shows the algorithm developed from the
Pacific Northwest Sites described by Adelman (2009; 2010).

The second RWC temporal algorithm is an ad hoc approximation of the
original equation that broadens its application by removing the
intercept term. By removing the intercept term, Equation 2 below will
not produce negative emissions when the temperature threshold is
increased above 53.3°F.

The alternate RWC algorithms can be selected using
`RWC_ALT_EQ_YN`{.envar} listed below. When `RWC_ALT_EQ_YN`{.envar} = N,
Equation 1 will be used to calculate RWC temporal profiles.

::: {.orderedlist}
1.  **Original RWC Algorithm developed by Adelman (2009;2010)**

    When T~[*i,d*]{.emphasis}~ is equal or less than 50°F,

    PE~[*i,d*]{.emphasis}~ = (42.12 - 0.79 x T~[*i,d*]{.emphasis}~) /
    Sum (42.12 - 0.79 x T~[*i,d*]{.emphasis}~)

    When T~[*i,d*]{.emphasis}~ is greater than T~[*t*]{.emphasis}~,

    PE~[*i,d*]{.emphasis}~ = 0.0

    When T~[*i,d*]{.emphasis}~ is greater than 50°F and
    T~[*i,d*]{.emphasis}~ is less than T~[*t*]{.emphasis}~,

    PE~[*i,d*]{.emphasis}~ = (42.12 - 0.79 x 50) / Sum (42.12 - 0.79
    x 50)

2.  **Alternative RWC Algorithm**

    When T~[*i,d*]{.emphasis}~ is equal or greater than
    T~[*t*]{.emphasis}~,

    PE~[*i,d*]{.emphasis}~ = 0.0

    When T~[*i,d*]{.emphasis}~ is less than T~[*t*]{.emphasis}~,

    PE~[*i,d*]{.emphasis}~ = \[0.79 x (T~[*i,t*]{.emphasis}~ -
    T~[*i,d*]{.emphasis}~)\] / Sum \[0.79 x (T~[*i,t*]{.emphasis}~ -
    T~[*i,d*]{.emphasis}~)\]
:::

where

::: {.itemizedlist}
-   PE~[*i,d*]{.emphasis}~ = Percentage of emissions in county
    [*i*]{.emphasis} on day [*d*]{.emphasis}
-   T~[*i,d*]{.emphasis}~ = Daily minimum ambient temperature (°F) in
    county [*i*]{.emphasis} on day [*d*]{.emphasis}
-   T~[*i,t*]{.emphasis}~ = Daily threshold ambient temperature (°F) in
    county [*i*]{.emphasis}
-   T~[*t*]{.emphasis}~ = Daily threshold ambient temperature (default =
    50°F)
-   Note: T~[*i,m*]{.emphasis}~ can be replaced by monthly minimum
    ambient temperature in county [*i*]{.emphasis} on month
    [*m*]{.emphasis}
:::

**\[2\] NH3**

Two NH3 profile methods are implemented in **Gentpro** to estimate
hourly temporal allocation factors, which are output as temporal
profiles to convert annual, monthly, or daily livestock ammonia
inventories to hourly emissions for every county in the modeling domain.
**Gentpro** can output hour-of-month and hour-of-year temporal profiles
that can be input to the **Temporal**. The recommended application of
the BASH\_NH3 and RC\_NH3 profile methods are to convert monthly
agricultural ammonia inventories to hourly emissions.

::: {.orderedlist}
1.  RC\_NH3 profile method: Russell and Cass (1986) developed a
    theoretical equation based on investigations of NH3 emissions from
    animal waste decomposition conducted by Muck and Steenhuis (1982) to
    predict diurnal NH3 emission variations as a function of daily
    meteorology. The Russell and Cass equation (a.k.a RC\_METHOD) listed
    below is adapted for this application to use county average
    meteorology and implemented in **Gentpro** to estimate hourly
    emissions from county annual, monthly, or daily agricultural
    livestock NH~3~ inventories.

    E~[*i,h*]{.emphasis}~ = \[2.36^(T~[*i,h*]{.emphasis}~-273)/10^\] x
    V~[*i,h*]{.emphasis}~

2.  BASH\_NH3 profile method: Zhu, Henze, et al. (2013) developed an
    empirical equation based on observations from the TES instrument
    with the GEOS-Chem model and its adjoint to estimate diurnal NH3
    emission variations from livestocks as a function of ambient
    temperature and aerodynamic resistance meteorological variable. The
    equation is listed below.

    E~[*i,h*]{.emphasis}~ = \[161500/T~[*i,h*]{.emphasis}~ x
    e^(-1380/T~[*i,h*]{.emphasis}~)^\] x AR~[*i,h*]{.emphasis}~
:::

::: {.itemizedlist}
-   PE~[*i,h*]{.emphasis}~ = E~[*i,h*]{.emphasis}~ /
    Sum(E~[*i,h*]{.emphasis}~)
:::

where

::: {.itemizedlist}
-   PE~[*i,h*]{.emphasis}~ = Percentage of emissions in county
    [*i*]{.emphasis} on hour [*h*]{.emphasis}
-   E~[*i,h*]{.emphasis}~ = Emission rate in county [*i*]{.emphasis} on
    hour [*h*]{.emphasis}
-   T~[*i,h*]{.emphasis}~ = Ambient temperature (Kelvin) in county
    [*i*]{.emphasis} on hour [*h*]{.emphasis}
-   V~[*i,h*]{.emphasis}~ = Wind speed (meter/sec) in county
    [*i*]{.emphasis} (minimum wind speed is 0.1 meter/sec)
-   AR~[*i,h*]{.emphasis}~ = Aerodynamic resistance in county
    [*i*]{.emphasis}
:::

**\[3\] MET: Generic Meteorology Profile Algorithm**

This is a simple algorithm that computes the percentage of emissions to
allocate to each hour based on the hourly fractional contribution of a
selected meteorology variable relative to the annual, monthly, and daily
sum of all hourly values for that variable. While the fractional
contribution of county-average wind speed for each hour of the year is
somewhat meaningless, it does provide a way to build a time series that
can be applied to an annual/monthly inventory to estimate hourly values
using monthly, daily and/or hourly MET profiles.

::: {.orderedlist}
1.  PE~[*i,h*]{.emphasis}~ = m~[*i,h*]{.emphasis}~ /
    Sum(m~[*i,h*]{.emphasis}~)
:::

where

::: {.itemizedlist}
-   PE~[*i,h*]{.emphasis}~ = Percentage of emissions in county
    [*i*]{.emphasis} on hour [*h*]{.emphasis}
-   m~[*i,h*]{.emphasis}~ = Meteorology variable in county
    [*i*]{.emphasis} on hour [*h*]{.emphasis}
:::

**\[Reference\]**

Adelman, Z. (2010) \'Proposal: Estimating Temporal Profiles for
Residential Wood Combustion Emissions\', Prepared for U.S. EPA, OAQPS,
Research Triangle Park, NC under Contract No. EP-D-07-102 Assignment No.
3-07 (M. Houyoux, WAM) by UNC, Chapel Hill, NC.

Adelman, Z. (2009) \'Technical Memo: Emissions Modeling Improvements
Task 2 -- Temporal Allocation for Residential Wood Combustion\',
Prepared for U.S. EPA, OAQPS, Research Triangle Park, NC under Contract
No. EP-D-07-102 Assignment No. 2-13 (M. Houyoux, WAM) by UNC, Chapel
Hill, NC.

Mansell, G, S. Kemball-Cook, L. Ma (2009) \'Draft Report: Temporal
Allocation of Agricultural Ammonia Emissions\', Prepared for U.S. EPA,
OAQPS, Research Triangle Park, NC under Contract No. EP-D-07-102
Assignment No. 2-13 (M. Houyoux, WAM) by ENVIRON, Novato, CA.

Muck, R.E., and T.S. Steenhuis (1982) \'Nitrogen Losses from Manure\',
Agricultural Wastes, 4: 41-54.

Russell, A.G. and G.R. Cass (1986) \'Verification of a Mathematical
Model for Aerosol Nitrate and Nitric Acid Formation and Its Use for
Control Measure Evaluation\', Atmospheric Environment, 20: 2011-2025.

Zue, Henze, et al (2013) \'Constraining U.S. Ammonia Emissions using TES
Remote Sensing Observations and the GEOS-Chem adjoint model\', Journal
of Geophysical Research: Atmospheres, 118: 1-14.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e19516}5.3.5.2. Processing Order {#processing-order .title}

</div>

</div>
:::

This optional program must run prior to **Temporal**.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e19524}5.3.5.3. Files and Environment Variables {#files-and-environment-variables .title}

</div>

</div>
:::

::: {.toc}
[[5.3.5.3.1. Input Files](ch05s03s05.html#d0e19537)]{.section}

[[5.3.5.3.2. Input Environment
Variables](ch05s03s05.html#d0e19633)]{.section}

[[5.3.5.3.3. Output Files](ch05s03s05.html#d0e19831)]{.section}
:::

::: {.figure}
[]{#fig_programs_gentpro}

**Figure 5.1. Gentpro input and output files**

::: {.mediaobject}
![Gentpro input and output files](images\programs\gentpro_html.jpg)
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e19537}5.3.5.3.1. Input Files {#input-files .title}

</div>

</div>
:::

::: {.informaltable}
  File Name                                                                                                Format   Description
  -------------------------------------------------------------------------------------------------------- -------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  `COSTCY`{.envar}                                                                                         ASCII    Five digit code for country, state and county
  [`GEOCODE_LEVEL[1-4]`{.envar}](ch08s10s03.html "8.10.3. GEOCODE_LEVEL[1-4]: Geographical Input Files")   ASCII    Geographical level codes and descriptions for gridded inventories, only when USE\_EXP\_GEO\_CODES is set to Y, (COSTCY is ignored when [Section 8.10.3, "`GEOCODE_LEVEL[1-4]: Geographical Input Files`{.envar}"](ch08s10s03.html "8.10.3. GEOCODE_LEVEL[1-4]: Geographical Input Files") files are used)
  `GRIDDESC`{.envar}                                                                                       ASCII    Grid descriptions file that defines the output grid for the output surrogates file created by the program. It must include the name of the grid set by the `IOAPI_GRIDNAME     _1`{.envar} environment variable setting.
  `METLIST`{.envar}                                                                                        ASCII    A list of meteorology files containing temperature, mixing ratio, and surface pressure data created by **Metcombine**
  `RWC_COUNTY_TEMP (optional)`{.envar}                                                                     ASCII    County-specific minimum temperature for RWC equations (see [Section 8.10.9, "`RWC_COUNTY_TEMP`{.envar}: County-specific minimum temperature for Residential Wood Combustion (RWC) Equations"](ch08s10s09.html "8.10.9. RWC_COUNTY_TEMP: County-specific minimum temperature for Residential Wood Combustion (RWC) Equations"))
  `SRGDESC`{.envar}                                                                                        ASCII    Spatial surrogate description file produced by MCIP (see [Section 8.4.1, "`SRGDESC`{.envar}: Surrogate Designation, Description and Surrogate profile filename."](ch08s04.html#sect_input_srgdesc "8.4.1. SRGDESC: Surrogate Designation, Description and Surrogate profile filename."))
  Surrogate File(s)                                                                                        ASCII    Spatial surrogate file(s) selected by `SRG_LIST`{.envar}
  `TREF_IN`{.envar}                                                                                        ASCII    Temporal cross-reference input file (see [Section 8.3.2, "`[A|M|P]TREF`{.envar}: Temporal cross-reference file"](ch08s03s02.html "8.3.2. [A|M|P]TREF: Temporal cross-reference file"))
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e19633}5.3.5.3.2. Input Environment Variables {#input-environment-variables .title}

</div>

</div>
:::

::: {.itemizedlist}
-   `AERO_RESISTANCE_VAR`{.envar}: \[default: blank\]

    Define the aerodynamic resistance variable name for Bash\'s
    algorithm for livestock ammonia sources

-   `SLOPE`{.envar}: \[default: 0.79\]

    Define the value of the slope of RWC equation

-   `CONSTANT`{.envar}: \[default: 42.12\]

    Define the value of constant of RWC equation

-   `ENDDATE`{.envar}: \[default: 0\]

    Defines the last day of year (December 31st) for a proper temporal
    profile calculation. MCIP file must cover last hour of December 31st
    of all counties in modeling output time zone (i.e., GMT).

-   `PROFILE_METHOD`{.envar}: \[default: MET\]

    Indicates which of the three temporal profile types to generate by
    **Gentpro**

    ::: {.itemizedlist}
    -   RWC: use the Adelman\'s regression equation to calculate
        temporal profiles for residential wood combustion (RWC) sources
    -   BASH\_NH3: use the Bash\'s algorithm to calculate temporal
        profiles for livestock ammonia sources
    -   RC\_NH3: use the Russell and Cass algorithm to calculate
        temporal hourly profiles for agricultural ammonia sources
    -   MET: use the time series of the selected meteorology variable to
        calculate temporal profiles
    :::

-   `RWC_COUNTY_TEMP_YN`{.envar}: \[default: N\]

    Allows the user to determine county-specific minimum temperature for
    RWC estimate equations. It will override default minimum temperature
    \[`DEFAULT_TEMP_RWC`{.envar}\] listed above.

    ::: {.itemizedlist}
    -   Y: use the county-specific minimum temperature from
        [`RWC_COUNTY_TEMP`{.envar}](ch08s10s09.html "8.10.9. RWC_COUNTY_TEMP: County-specific minimum temperature for Residential Wood Combustion (RWC) Equations")
        input file.
    -   N: do not use the county-specific minimum temperature for RWC
        equations.
    :::

-   `RWC_EQ_ALT_YN`{.envar}: \[default: Y\]

    Allows the user to choose the alternative RWC equation listed above
    to avoid negative RWC emissions.

    ::: {.itemizedlist}
    -   Y: use the alternative RWC equation to compute RWC emissions.
    -   N: use the original RWC equations to compute RWC emissions.
    :::

-   `SCC_LIST`{.envar}: \[default: blank\]

    Defines a comma-separated list of SCCs that will use the temporal
    profiles generated by **Gentpro**, example: setenv SCC\_LIST
    \"2104008000,2104008001,2104008002\"

-   `SRG_LIST`{.envar}: \[default: 0\]

    Defines a comma-separated list of SCCs that will use the temporal
    profiles generated by **Gentpro**, example setenv SRG\_LIST
    \"340,100\"

-   `SRGDESC`{.envar}: \[default: none\]

    Directory path and name of the spatial surrogate file for computing
    averaged meteorology.

-   `SRGPRO_PATH`{.envar}: \[default: blank\]

    Defines the location of spatial surrogate files

-   `STDATE`{.envar}: \[default: 0\]

    Defines the first day of year (January 1st) for a proper temporal
    profile calculation. MCIP file must cover first hour of January 1st
    of all counties in modeling output time zone (i.e., GMT).

-   `TEMP_VAR`{.envar}: \[default: blank\]

    Must define the name of variable for the all PROFILE\_METHOD
    settings to use in the profile calculations. The program looks for
    the selected meteorology variables first in the METLIST file (set
    below) that contains a list of Metcombine program output files or
    MET files that contain targeted variables from the MET\_CRO\_3D
    or/and MET\_CRO\_2D files. If it doesn\'t find the variable(s) in
    either file, it stops with an error.

-   `TPRO_OUTPUT`{.envar}: \[default: ALL\]

    Specifies the type of temporal profiles to produce

    ::: {.itemizedlist}
    -   MONTHLY: generate month-of-year temporal profiles
    -   DAILY: generate both month-of-year and day-of-month temporal
        profiles
    -   HOURLY: generate hour-of-year, hour-of-month, and hour-of-day
        temporal profiles
        ::: {.itemizedlist}
        -   Not applicable when PROF\_METHOD = RWC
        :::
    -   ALL: generate all possible profiles for the selected profile
        method
        ::: {.itemizedlist}
        -   No hourly profiles will be generated when PROF\_METHOD = RWC
        :::
    :::

-   `TREF_IN`{.envar}: \[default: blank\]

    Defines an input temporal cross-reference file for supplying
    monthly, daily, weekly, and hourly profile IDs. The TREF\_IN file
    will be scanned for the FIPS/SCC combinations of sources associated
    with profiles generated by **Gentpro**. If there are no entries in
    TREF for the specific FIPS/SCC combinations being simulated with
    **Gentpro**, the program will look for default cross-reference
    entries (FIPS=0, SCC=0).

    ::: {.itemizedlist}
    -   If TPRO\_OUTPUT = DAILY, month-of-year and day-of-month temporal
        profiles will be generated by **Gentpro**. Users need to provide
        diurnal (hourly) profiles will be needed to convert from daily
        to hourly emissions.
    -   If TPRO\_OUTPUT = MONTHLY, month-of-year profiles will be
        generated by **Gentpro**. Users need to provide weekly and
        diurnal profiles will be needed to estimate hourly emissions.
    -   If PROFILE\_METHOD = BASH\_NH3 or RC\_NH3, hour-of-year profiles
        will be generated by **Gentpro** to estimate hourly emissions
        using monthly inventory
    -   If PROFILE\_METHOD = MET and TPRO\_OUTPUT = HOURLY\[or ALL\],
        hour-of-year, hour-of-month and hour-of-day temporal profiles
        will be output to netCDF TPRO\_HOUR by **Gentpro**
    :::

-   `USE_EXP_GEO_CODES`{.envar}: \[default: N\]

    If set to Y then use GEOCODE\_LEVEL\[1-4\] files instead of the
    COSTCY file to define expanded geographical detail such as
    country-level(GEOCODE\_LEVEL1), country/state-level
    (GEOCODE\_LEVEL2), country/state/county-level (GEOCODE\_LEVEL3) or
    country/state/county/tribal-level (GEOCODE\_LEVEL4).

-   `WSPEED_VAR`{.envar}: \[default: blank\]

    Defines the name of wind speed variable from MET files. It is only
    used when PROFILE\_METHOD is set to \"RC\_NH3\". example: setenv
    WSPEED\_VAR \"WSPD10\"
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e19831}5.3.5.3.3. Output Files {#output-files .title}

</div>

</div>
:::

::: {.informaltable}
  File Name             Format           Description
  --------------------- ---------------- ------------------------------------------
  `TPRO_MON`{.envar}    ASCII            Month-of-year temporal profiles
  `TPRO_DAY`{.envar}    ASCII            Day-of-month temporal profiles
  `TPRO_HOUR`{.envar}   I/O API netCDF   Hourly temporal profiles
  `TREF_OUT`{.envar}    ASCII            Temporal cross-references input file.
  `LOGFILE`{.envar}     ASCII            Log generated from executing **Gentpro**
:::
:::
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  -------------------------- -------------------- --------------------------
  [Prev](ch05s03s04.html)     [Up](ch05s03.html)     [Next](ch05s03s06.html)
  5.3.4. **CEMScan**          [Home](index.html)           5.3.6. **Geofac**
  -------------------------- -------------------- --------------------------
:::
