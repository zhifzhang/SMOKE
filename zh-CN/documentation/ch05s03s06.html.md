::: {.navheader}
5.3.6. **Geofac**
:::

[Prev](ch05s03s05.html) 

5.3.  SMOKE Utility Programs

 [Next](ch05s03s07.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_utilities_geofac}5.3.6. **Geofac** {#geofac .title}

</div>

</div>
:::

::: {.toc}
[[5.3.6.1. Description](ch05s03s06.html#d0e19894)]{.section}

[[5.3.6.2. Processing Order](ch05s03s06.html#d0e19918)]{.section}

[[5.3.6.3. Files and Environment
Variables](ch05s03s06.html#d0e19932)]{.section}
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e19894}5.3.6.1. Description {#description .title}

</div>

</div>
:::

The **Geofac** program provides a means for adjusting emissions by grid
cell after SMOKE has already created model-ready inputs. For example,
the program could be used to zero emissions from all grid cells that
intersect a certain state, which would be a rough approximation of
removing that state's inventory from the model-ready files. Although it
is more accurate to modify the emissions using the **Cntlmat** program,
that approach takes longer and is possible only if the SMOKE input files
used to create the model ready emissions are still available. **Geofac**
is useful in situations where speed and simplicity are more important
than the accuracy of the emissions, or when only the gridded model-ready
inputs are available and the inventories used to create them are not.

**Geofac** reads in a gridded 2-D or 3-D SMOKE emissions file (output
from the **Smkmerge** program) and multiplies the emissions with a
user-supplied adjustment factor for each individual species in the
emissions file. The factors are assigned by grid-cell regions, which are
defined by the input "[mask]{.quote}" file. Each grid cell either
receives the factors or it does not (the mask is simply an on-off
switch). The resulting hourly, gridded, speciated emissions data are
output to a new I/O API file with the same spatial and temporal
resolution and the same model species with different values.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e19918}5.3.6.2. Processing Order {#processing-order .title}

</div>

</div>
:::

This optional program can be run after **Smkmerge** and before either
**Mrggrid** (if it is being used to merge several **Smkmerge** output
files together) or the AQM of interest.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e19932}5.3.6.3. Files and Environment Variables {#files-and-environment-variables .title}

</div>

</div>
:::

::: {.toc}
[[5.3.6.3.1. Input Files](ch05s03s06.html#d0e19935)]{.section}

[[5.3.6.3.2. Input Environment
Variables](ch05s03s06.html#d0e20032)]{.section}

[[5.3.6.3.3. Output Files](ch05s03s06.html#d0e20037)]{.section}
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e19935}5.3.6.3.1. Input Files {#input-files .title}

</div>

</div>
:::

::: {.informaltable}
+--------------------+----------------+------------------------------+
| File Name          | Format         | Description                  |
+====================+================+==============================+
| `GEOMASK`{.envar}  | I/O API NetCDF | Gridded, time-independent    |
|                    |                | file that assigns a 1 to any |
|                    |                | grid cell whose emissions    |
|                    |                | you want to adjust. The      |
|                    |                | emissions from               |
|                    |                | `INFILE`{.envar} in grid     |
|                    |                | cells that have a 1 in       |
|                    |                | `GEOMASK`{.envar} are        |
|                    |                | multiplied by the factor     |
|                    |                | provided in                  |
|                    |                | `SPECFACS`{.envar}. All      |
|                    |                | other emissions and grid     |
|                    |                | cells are untouched.         |
+--------------------+----------------+------------------------------+
| `INFILE`{.envar}   | I/O API NetCDF | Hourly, gridded, speciated   |
|                    |                | inputs from **Smkmerge**.    |
|                    |                | `INFILE`{.envar} should be   |
|                    |                | set to logical file name     |
|                    |                | `AGTS_[L|S]`{.envar},        |
|                    |                | `BGTS_[L|S]`{.envar},        |
|                    |                | `MGTS_[L|S]`{.envar},        |
|                    |                | `PGTS_[L|S]`{.envar},        |
|                    |                | `PGTS3D_[L|S]`{.envar},      |
|                    |                | `EGTS_[L|S]`{.envar}, or     |
|                    |                | `EGTS3D_[L|S]`{.envar},      |
|                    |                | which are the output files   |
|                    |                | from **Smkmerge**.           |
+--------------------+----------------+------------------------------+
| `SPECFACS`{.envar} | ASCII          | File that lists the species  |
|                    |                | name and the factor to be    |
|                    |                | applied to all grid cells    |
|                    |                | with a 1 value in the        |
|                    |                | `GEOMASK`{.envar} file. The  |
|                    |                | species name must be in      |
|                    |                | columns 1-16 and the factor  |
|                    |                | in columns 17-22. For        |
|                    |                | example, the following       |
|                    |                | `SPECFACS`{.envar} file      |
|                    |                | sample would multiply NO and |
|                    |                | NO~2~ emissions by 1.3 (30%  |
|                    |                | increase) and multiply PAR   |
|                    |                | by 0.6 (40% decrease).       |
|                    |                |                              |
|                    |                | ``` {.programlisting}        |
|                    |                | NO              1.3          |
|                    |                | NO2             1.3          |
|                    |                | PAR             0.6          |
|                    |                | ```                          |
+--------------------+----------------+------------------------------+
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e20032}5.3.6.3.2. Input Environment Variables {#input-environment-variables .title}

</div>

</div>
:::

None
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e20037}5.3.6.3.3. Output Files {#output-files .title}

</div>

</div>
:::

::: {.informaltable}
  File Name           Format           Description
  ------------------- ---------------- ---------------------------------------------------------------------------------------------------
  `LOGFILE`{.envar}   ASCII            Log generated from executing **Geofac**
  `OUTFILE`{.envar}   I/O API NetCDF   Hourly, gridded, speciated emissions, adjusted based on `GEOMASK`{.envar} and `SPECFACS`{.envar}.
:::
:::
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  -------------------------- -------------------- --------------------------
  [Prev](ch05s03s05.html)     [Up](ch05s03.html)     [Next](ch05s03s07.html)
  5.3.5. **Gentpro**          [Home](index.html)       5.3.7. **Inlineto2D**
  -------------------------- -------------------- --------------------------
:::
