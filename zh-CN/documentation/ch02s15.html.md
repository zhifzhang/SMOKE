::: {.navheader}
2.15. Elevated-source processing
:::

[Prev](ch02s14s07.html) 

Chapter 2. SMOKE Concepts

 [Next](ch02s15s02.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

[]{#sect_concepts_elevated_processing}2.15. Elevated-source processing {#elevated-source-processing .title style="clear: both"}
----------------------------------------------------------------------

</div>

</div>
:::

::: {.toc}
[[2.15.1. Computing layer fractions for
CMAQ](ch02s15.html#sect_concepts_compute_layer_cmaq)]{.section}

[[2.15.2. Creating an elevated-source file for UAM and
CAM~X~](ch02s15s02.html)]{.section}
:::

As introduced in [Section 2.5.3, "Model-ready
files"](ch02s05s03.html "2.5.3. Model-ready files") and further
explained in [Section 2.8.5, "Point-source
processing"](ch02s08s05.html "2.8.5. Point-source processing"), there
are two major approaches to processing elevated point sources for air
quality modeling. The first approach is to have SMOKE compute the layer
assignments for the point sources; this method is used for the CMAQ
model. The second approach, which is used for the UAM models and CAM~X~,
is to select specific sources as elevated and then create a special
elevated-point-source file that contains the information needed so that
the AQM can compute the plume rise. In both cases, users can select
elevated sources specifically (in the second approach, that selection is
mandatory). Also, PinG sources can be selected in both cases.

The two approaches have some steps that are the same and some that are
different. The rest of this section is split into the following two
subsections, one for each elevated-point-source processing approach:

::: {.orderedlist}
1.  Computing layer fractions for CMAQ

2.  Creating an elevated-source file for UAM and CAM~X~
:::

Each subsection first overviews the steps in the approach, then gives
more details on some of them.

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_concepts_compute_layer_cmaq}2.15.1. Computing layer fractions for CMAQ {#computing-layer-fractions-for-cmaq .title}

</div>

</div>
:::

::: {.toc}
[[2.15.1.1. Using **Elevpoint**](ch02s15.html#d0e6672)]{.section}

[[2.15.1.2. Using **Laypoint**](ch02s15.html#d0e6719)]{.section}

[[2.15.1.3. Using **Smkmerge**](ch02s15.html#d0e6751)]{.section}

[[2.15.1.4. Optional use of
**Smkreport**](ch02s15.html#d0e6772)]{.section}
:::

The CMAQ model requires the layer fractions for elevated point sources
to be computed by SMOKE. To do this, SMOKE performs the following steps:

::: {.itemizedlist}
-   Uses the **Smkinven** program to import the annual, average-day,
    day-specific, and/or hour-specific emissions.

-   Optionally uses the **Temporal** program to calculate hourly
    emissions if emissions will be used as a criterion for selecting
    elevated sources or PinG sources. For example, you may wish to
    select facilities with NO~x~ emissions greater than 100 tons/day.

-   Uses the **Elevpoint** program to select elevated and/or PinG
    sources. This step is required if modeling with PinG sources, but
    optional otherwise.

-   Uses the **Elevpoint** program to create the `STACK_GROUPS`{.envar}
    file, which is needed for processing PinG sources with CMAQ.

-   Uses the **Laypoint** program to compute elevated plume rise for all
    elevated sources, and store the layer fractions for each source.
    This step can optionally read the output file from **Elevpoint** to
    identify the elevated sources, but otherwise will compute plume rise
    for [*all*]{.emphasis} sources.

-   Uses the **Smkmerge** program to combine the layer fractions with
    the hourly emissions to generate the model-ready output files and
    optionally generate the PinG hourly emissions file for CMAQ.

-   Optionally uses the **Smkreport** program to report on elevated or
    PinG sources
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e6672}2.15.1.1. Using **Elevpoint** {#using-elevpoint .title}

</div>

</div>
:::

**Elevpoint** can select elevated and PinG sources using multiple
criteria based on emissions values, emissions rank, stack parameters,
plant numbers, and an analytical plume rise calculation. The elevated
criteria and PinG criteria are provided to **Elevpoint** using a file
called `PELVCONFIG`{.envar}. You must configure this file to contain the
criteria needed to select elevated and PinG source (if these selection
are needed at all). If emissions values is one of the criteria, the
**Elevpoint** program reads all of the hourly point-source files using
the `PTMPLIST`{.envar} file. This file is a list of all `PTMP`{.envar}
files that will be evaluated to determine which sources have maximum
daily emissions that exceed the specified selection criteria or to
determine the emissions rank. Only the maximum daily facility-total
emissions can be used by **Elevpoint** to select sources based on
emissions.

The elevated sources and PinG sources can each be selected using
different criteria. In general, there are many more elevated sources
than PinG sources for typical applications of SMOKE and AQMs.
**Elevpoint** also permits you to group PinG sources and creates the
`STACK_GROUPS`{.envar} file so that the sources are treated as a single
source in the PinG rise calculation by CMAQ. Grouping is useful to
reduce the total number of PinG stacks processed by CMAQ (PinG
processing is a computationally expensive calculation). Using grouping
makes sense when several stacks at the same plant have the same, or
nearly the same, stack parameters. When that is true, the emissions from
the multiple stacks can be grouped and treated as a single PinG stack.
Finally, there are two SMOKE settings (`SMK_ELEV_METHOD`{.envar} and
`SMK_PING_METHOD`{.envar}) that instruct **Elevpoint** and other SMOKE
programs to actually use these criteria to select the elevated and PinG
sources. If these settings are not set to "[1]{.quote}" the elevated and
PinG selections will not be made, and so will not affect any further
processing steps.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e6719}2.15.1.2. Using **Laypoint** {#using-laypoint .title}

</div>

</div>
:::

In this CMAQ approach, **Laypoint** uses gridded, hourly meteorological
data and stack parameters to calculate the plume rise for all
point-source emissions. The program's approach is based on the Briggs
algorithm, as explained in detail in [Section 6.3.1.1, "Plume rise
calculation"](ch06s03.html#sect_programs_elevpoint_briggs "6.3.1.1. Plume rise calculation"),
and provides the top and bottom heights of the plume. **Laypoint** uses
these heights to compute the plumes' distributions into the vertical
layers that the plumes intersect, using the pressure difference across
each layer over the pressure difference across the entire plume as a
weighting factor to make this calculation. This approach gives plume
fractions by layer and source. Only these fractions are stored in the
output file (`PLAY`{.envar}) from the **Laypoint** program (not the
emissions in each layer).

If explicit plume rise sources (e.g., wildfires with precomputed hourly
plume rise) are included in the inventory, **Laypoint** will skip the
plume rise calculation for these sources. Instead, it will use the
hourly data from the SMOKE `PHOUR`{.envar} intermediate file, which
describe the fraction of emissions in layer 1 and the top and bottom of
the plume. **Laypoint** will combine these data with the pressure
weights used for all elevated point sources to compute the fraction of
emissions to go into each layer.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e6751}2.15.1.3. Using **Smkmerge** {#using-smkmerge .title}

</div>

</div>
:::

**Smkmerge** applies the layer fractions from **Laypoint** to the
elevated sources to compute the emissions in each layer. This approach
has the advantage of allowing you to avoid repeating the plume rise
calculations for each control strategy or grid. If the
`SMK_PING_METHOD`{.envar} setting (discussed above) indicates that the
special CMAQ PinG file should be created, the **Smkmerge** program will
also output this special file, called the `PINGTS_L`{.envar} file. It
contains the hourly, speciated emissions for each PinG source (which
could be a stack group, as explained above).
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e6772}2.15.1.4. Optional use of **Smkreport** {#optional-use-of-smkreport .title}

</div>

</div>
:::

If desired, **Smkreport** can apply the layer fractions and elevated or
PinG statuses to the inventory to generate reports that include layer
information and/or the elevated or PinG status. This reporting could be
used, for example, to create a list of all PinG sources in the
inventory, or to determine the elevated versus layer-1 emissions by
state or SCC.
:::
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  -------------------------------------------------------------------------------------------- -------------------- --------------------------------------------------------------
  [Prev](ch02s14s07.html)                                                                        [Up](ch02.html)                                           [Next](ch02s15s02.html)
  2.14.7. Using **Smkmerge** to apply the multiplicative and/or reactivity control matrices     [Home](index.html)     2.15.2. Creating an elevated-source file for UAM and CAM~X~
  -------------------------------------------------------------------------------------------- -------------------- --------------------------------------------------------------
:::
