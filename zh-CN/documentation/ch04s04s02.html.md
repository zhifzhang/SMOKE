::: {.navheader}
4.4.2. Use new inventory data
:::

[Prev](ch04s04.html) 

4.4. How to use SMOKE

 [Next](ch04s04s03.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_scripts_use_new_inv}4.4.2. Use new inventory data {#use-new-inventory-data .title}

</div>

</div>
:::

::: {.toc}
[[4.4.2.1. Area/non-point
inventories](ch04s04s02.html#sect_scripts_area_invs)]{.section}

[[4.4.2.2. Nonroad mobile
inventories](ch04s04s02.html#sect_scripts_nonroad_invs)]{.section}

[[4.4.2.3. On-road mobile
inventories](ch04s04s02.html#d0e12518)]{.section}

[[4.4.2.4. Point/fires inventories](ch04s04s02.html#d0e12634)]{.section}

[[4.4.2.5. Day-specific and hour-specific point and fire
inventories](ch04s04s02.html#sect_scripts_hour_day_invs)]{.section}

[[4.4.2.6. Future-year
inventories](ch04s04s02.html#sect_scripts_future_invs)]{.section}

[[4.4.2.7. Pre-gridded
inventories](ch04s04s02.html#sect_scripts_pregridded)]{.section}

[[4.4.2.8. Files and settings for all
inventories](ch04s04s02.html#sect_scripts_all_invs)]{.section}

[[4.4.2.9. Using average-day and annual data in the same
run](ch04s04s02.html#sect_scripts_average_day_invs)]{.section}
:::

This section describes what steps are necessary to take when using new
inventory data for anthropogenic sources. For information on biogenic
sources, see [Section 4.4.15, "Use
BEIS3"](ch04s04s15.html "4.4.15. Use BEIS3"). For more information about
the details of each source category (e.g., what is the difference
between using MOVES emission factors or precomputed on-road mobile
emissions), see [Section 2.8.1, "Summary of SMOKE processing
categories"](ch02s08.html#sect_concepts_summary_source_processing "2.8.1. Summary of SMOKE processing categories").

Because this section is so spread out, we provide a small section guide
here. This section includes the following subsections:

::: {.itemizedlist}
-   Area/non-point inventories
-   Nonroad mobile inventories
-   On-road mobile inventories
-   Point inventories
-   Day-specific and hour-specific point and fire inventories
-   Future-year inventories
-   Pre-gridded inventories (for same output modeling domain or for
    converting to a different modeling domain (example: EDGAR/RCP/HTAP
    to CMAQ ready emissions file)
-   Using seasonal and annual data in the same run
-   Files and settings for all inventories
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#sect_scripts_area_invs}4.4.2.1. Area/non-point inventories {#areanon-point-inventories .title}

</div>

</div>
:::

::: {.orderedlist}
1.  Determine the file format that you have (for preformatted data) or
    want to create (for new data).

    ::: {.orderedlist}
    a.  Preformatted data considerations

        ::: {.itemizedlist}
        -   If you have preexisting data in SMOKE input format, then you
            will most likely want to use that format to input to SMOKE,
            unless you discover that you need a different format to take
            advantage of a SMOKE feature not available in a different
            format.

        -   If you have multiple files in a single format, then you can
            combine these into a single SMOKE run using a list file.

        -   If you have data in more than one format other than the case
            just mentioned, you must convert all files to the same
            format or process them separately in SMOKE, merging the
            hourly, gridded, speciated emissions files using
            **Mrggrid**.

        -   If your area inventory includes nonroad mobile sources, you
            can process nonroad mobile sources with stationary area
            sources in most cases (see next bullet for exception).

        -   If you want to combine nonroad mobile criteria and toxics
            inventories, you need to process nonroad mobile sources
            separately from area sources (see [Section 4.4.2.2, "Nonroad
            mobile
            inventories"](ch04s04s02.html#sect_scripts_nonroad_invs "4.4.2.2. Nonroad mobile inventories")).

        -   Pregridded data from any source category can be input to
            SMOKE as an area source, but you must convert the data to an
            I/O API NetCDF file format first. See [Section 4.4.2.7.1,
            "Pre-gridded inventories from the same modeling domain as an
            area source without source characterization or
            attributes"](ch04s04s02.html#sect_scripts_pregridded_invs_same "4.4.2.7.1. Pre-gridded inventories from the same modeling domain as an area source without source characterization or attributes")
            for more information.
        :::
    :::

2.  Collect or create inventories in correct formats.

    Inventory files for area sources are usually named starting with
    "[arinv]{.quote}", because `ARINV`{.envar} is the logical file name
    (environment variable) that **Smkinven** uses to read the file. The
    formats available for area/non-point sources are:

    ::: {.orderedlist}
    a.  List format. The list format is simply an ASCII file that lists
        all of the files that you want SMOKE to import in a single run.

    b.  List Grid format. The list grid format is simply an ASCII file
        that lists all of the global gridded inventory files that you
        want SMOKE to import in a single run. The List Grid format has
        four columns. Assigned SCC, Pollutant ID, Local Variable Name,
        Month of inventory and Full inventory fine directory path and
        filename.

    c.  ORL and FF10 formats. These formats are most appropriate for
        non-point toxics inventories, but also can be used for any
        inventory data.

    d.  Pregridded I/O API format. This format can only be used for
        pregridded data that has been converted to a time-independent,
        gridded I/O API file. The variables in the file are the
        pollutants. No SCCs or other source information can be provided
        with this format.
    :::

3.  Set and/or check the file headers that apply for your file format.

    ::: {.orderedlist}
    a.  File format header: Make sure that the first line of the list
        file or individual files start with the \#LIST (for list files
        only),\#LIST GRID, \#ORL, \#FF10 (see [Section 8.2.1.2, "File
        format
        header"](ch08s02.html#sect_input_inventory_format "8.2.1.2. File format header")).

    b.  File type (\#TYPE header): The type is important because it
        helps SMOKE determine the file format. Make sure that the header
        has been set according to the directions in [Section 8.2.1.4,
        "Header
        records"](ch08s02.html#sect_input_inventory_header "8.2.1.4. Header records").

    c.  Country (\#COUNTRY header): Make sure that this head has been
        used and that the country name used in this header matches the
        name in the country section of the `COSTCY`{.envar} or
        `GEOCODE_LEVEL[1-4]`{.envar} file (if USE\_EXP\_GEOCODE Y) file.

    d.  Inventory year (\#YEAR). Make sure that the inventory year is
        accurately reflected in the header. This is the only way SMOKE
        knows what year the data is for. If this year is not a base year
        but a future-year, make sure to follow the additional
        instructions in [Section 4.4.2.6, "Future-year
        inventories"](ch04s04s02.html#sect_scripts_future_invs "4.4.2.6. Future-year inventories").

    e.  Description (\#DESC header): Although this header is not
        required, it is good practice to take advantage of it and
        include as much information about the data as you have. There is
        no limit to the number of \#DESC headers that can be included in
        the file.

    f.  Data header (\#POLID or \#DATA header): Make sure that this
        required header is included in the file. It should accurately
        reflect the data values provided on each line of the file. If
        there are data fields at the end of the file that you want to
        drop from being imported, you can leave them off of the \#POLID
        or \#DATA header to cause them to not be imported by
        **Smkinven** (see also the `INVTABLE`{.envar} file for dropping
        emissions during import).

        For ORL format, this header does not apply. The pollutants are
        designated by code number (i.e., CAS number) in the file format
        and therefore the header is not needed.
    :::

4.  Install inventory files in `$ARDAT`{.filename} directory.

    This directory is
    `$SMKDAT`{.filename}/inventory/`$INVID`{.envar}/area.

5.  Ensure the Assigns file has the `ARINV`{.envar} variable set to the
    `ARINV`{.envar} file name for your area-source inventory file.

6.  Optionally, set up to assign point-source locations to area sources
    using the `ARTOPNT`{.envar} file.

    ::: {.orderedlist}
    a.  Put the `ARTOPNT`{.envar} file in the `$INVDIR`{.filename}/other
        directory.

    b.  Ensure the name of the `ARTOPNT`{.envar} file is consistent with
        the `ARTOPNT`{.envar} setting in the Assigns file.

    c.  Make sure that the `ARTOPNT`{.envar} file data are consistent
        with the year of your inventory (e.g., use 1999 coordinates for
        a 1999 inventory), or that you can accept any discrepancies.
    :::

7.  See also steps for all source categories in [Section 4.4.2.8, "Files
    and settings for all
    inventories"](ch04s04s02.html#sect_scripts_all_invs "4.4.2.8. Files and settings for all inventories").
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#sect_scripts_nonroad_invs}4.4.2.2. Nonroad mobile inventories {#nonroad-mobile-inventories .title}

</div>

</div>
:::

::: {.orderedlist}
1.  Determine the file format that you have (for preformatted data) or
    want to create (for new data).

    ::: {.orderedlist}
    a.  ::: {.itemizedlist}
        -   See [Section 4.4.2.1, "Area/non-point
            inventories"](ch04s04s02.html#sect_scripts_area_invs "4.4.2.1. Area/non-point inventories")
            for issues relating to stationary area / non-point sources.
            These are the same issues as for nonroad mobile sources.

        -   If you need to process nonroad mobile separately from
            stationary area/non-point sources because of recommendations
            in [Section 4.4.2.1, "Area/non-point
            inventories"](ch04s04s02.html#sect_scripts_area_invs "4.4.2.1. Area/non-point inventories"),
            you must separate the stationary area/non-point and nonroad
            mobile sources to two separate files if they are not already
            separated. There is no SMOKE utility to do this, but the
            UNIX **grep** command can be used to search for all SCCs in
            the nonroad mobile inventory; for example, all SCCs starting
            with "[22]{.quote}".
        :::

    b.  New data considerations

        ::: {.itemizedlist}
        -   See [Section 4.4.2.1, "Area/non-point
            inventories"](ch04s04s02.html#sect_scripts_area_invs "4.4.2.1. Area/non-point inventories")
            for issues relating to stationary area and non-point
            sources. These are the same issues as for nonroad mobile
            sources.

        -   Decide whether area and nonroad mobile sources will be
            processed together, which may depend on whether the
            available inventory data include both area and nonroad
            mobile or whether they are already separate. One reason for
            separate processing is if you anticipate control strategies
            that affect only stationary area or only nonroad mobile
            sources, though it is not required that the processing be
            separate to apply such controls. A second reason for
            separate files if you are also using toxics inventories.
        :::
    :::

    [*If processing nonroad mobile sources separately, continue with
    these steps. Otherwise, the steps for area/non-point sources listed
    in [Section 4.4.2.1, "Area/non-point
    inventories"](ch04s04s02.html#sect_scripts_area_invs "4.4.2.1. Area/non-point inventories")
    will be sufficient.*]{.emphasis}

2.  Collect or create inventories in correct formats.

    Inventory files for nonroad sources are usually named starting with
    "[nrinv]{.quote}", because the Assigns file uses the `NRINV`{.envar}
    environment variable to set the `ARINV`{.envar} logical file name
    (environment variable) that **Smkinven** uses to read the file. The
    list of available formats for nonroad mobile sources is:

    ::: {.orderedlist}
    a.  List format. The list format is simply an ASCII file that lists
        all of the files that you want SMOKE to import in a single run.

    b.  ORL format. This format is most appropriate for criteria and
        toxics inventories, but also can be used for any inventory data.

    c.  FF10 format. This format is most appropriate for criteria and
        toxics inventories, but also can be used for any inventory data.
    :::

3.  Set and/or check the file headers that apply for your file format.

    ::: {.orderedlist}
    a.  File format header: Make sure that the first line of the list
        file or individual files start with the \#LIST (for list files
        only),\#LIST GRID, \#ORL, \#FF10.

    b.  For other headers, please refer to the documentation in step (3)
        of the area/non-point steps in [Section 4.4.2.1, "Area/non-point
        inventories"](ch04s04s02.html#sect_scripts_area_invs "4.4.2.1. Area/non-point inventories").
    :::

4.  Install inventory files in `$NRDAT`{.filename} directory.

    This directory is
    `$SMKDAT`{.filename}/inventory/`$INVID`{.envar}/nonroad.

5.  Ensure the Assigns file has the `NRINV`{.envar} variable set to the
    `NRINV`{.envar} file name for your new nonroad-mobile-source
    inventory file.

6.  Optionally, set up to assign point-source locations to nonroad
    mobile sources using the `ARTOPNT`{.envar} file.

    Please refer to the documentation in step (6) of the area/non-point
    steps in [Section 4.4.2.1, "Area/non-point
    inventories"](ch04s04s02.html#sect_scripts_area_invs "4.4.2.1. Area/non-point inventories").

7.  See also steps for all source categories in [Section 4.4.2.8, "Files
    and settings for all
    inventories"](ch04s04s02.html#sect_scripts_all_invs "4.4.2.8. Files and settings for all inventories").
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e12518}4.4.2.3. On-road mobile inventories {#on-road-mobile-inventories .title}

</div>

</div>
:::

::: {.orderedlist}
1.  Determine the file format that you have (for preformatted data) or
    want to create (for new data).

    ::: {.orderedlist}
    ::: {.itemizedlist}
    -   If using MOVES emission factors through SMOKE, create a VMT file
        in FF10 on-road mobile activity format (or use in combination
        with list format).

    -   If using both VMT and emissions, you [*must*]{.emphasis} use a
        list-format to import the two separate inventories together.

    -   If using both criteria and toxics data and wish to have the full
        functionality of SMOKE for both inventories, you must use a list
        file to list both inventory files (criteria and toxics) for
        SMOKE to combine.
    :::
    :::

2.  Collect or create inventories in correct formats.

    Inventory files for on-road mobile sources are usually named
    starting with "[mbinv]{.quote}", because **Smkinven** uses the
    `MBINV`{.envar} logical file name (environment variable) to read the
    file. The list of available formats for on-road mobile sources is:

    ::: {.orderedlist}
    a.  List format. The list format is simply an ASCII file that lists
        all of the files that you want SMOKE to import in a single run.

    b.  ORL and FF10 format. These formats are most appropriate for
        toxics inventories, but also can be used for any inventory data.
    :::

3.  Set and/or check the file headers that apply for your file format.

    ::: {.orderedlist}
    a.  Please refer to the documentation in step (3) of the
        area/non-point steps in [Section 4.4.2.1, "Area/non-point
        inventories"](ch04s04s02.html#sect_scripts_area_invs "4.4.2.1. Area/non-point inventories").
    :::

4.  Install inventory files in `$MBDAT`{.filename} directory.

    This directory is
    `$SMKDAT`{.filename}/inventory/`$INVID`{.envar}/mobile

5.  Install other mobile-specific files in inventory directories.

    The following mobile-specific files must also be installed in the
    `MBDAT`{.envar} directory. These files can usually be copied from
    the example files provided with the SMOKE installation. The formats
    and additional discussion about the contents of these files can be
    found in [Section 8.9.2, "Mobile"](ch08s09s02.html "8.9.2. Mobile").
    These files are:

    ::: {.itemizedlist}
    -   `MCXREF`{.envar} (MOVES usage only)

    -   `MFMREF`{.envar} (MOVES usage only)

    -   `MEPROC`{.envar} (MOVES usage only)
    :::

    For all inputs needed for MOVES usage only, refer to
    [Section 4.4.12, "Use MOVES for on-road mobile
    sources"](ch04s04s12.html "4.4.12. Use MOVES for on-road mobile sources").

6.  See also steps for all source categories in [Section 4.4.2.8, "Files
    and settings for all
    inventories"](ch04s04s02.html#sect_scripts_all_invs "4.4.2.8. Files and settings for all inventories").
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e12634}4.4.2.4. Point/fires inventories {#pointfires-inventories .title}

</div>

</div>
:::

::: {.orderedlist}
1.  Determine the file format that you have (for preformatted data) or
    want to create (for new data).

    ::: {.orderedlist}
    a.  Preformatted data considerations

        ::: {.itemizedlist}
        -   If you have preexisting data in SMOKE input format, then you
            will most likely want to use that format to input to SMOKE,
            unless you discover that you need a different format to take
            advantage of a SMOKE feature not available in a different
            format.

        -   Pregridded data must be input as an area source.
        :::

    b.  New data considerations

        ::: {.itemizedlist}
        -   Hour-specific or day-specific data (including precomputed
            plume-rise data) are covered in [Section 4.4.2.5,
            "Day-specific and hour-specific point and fire
            inventories"](ch04s04s02.html#sect_scripts_hour_day_invs "4.4.2.5. Day-specific and hour-specific point and fire inventories").

        -   For wildfires and prescribed fires emission modeling without
            precomputed plume rise, you could use `ORL FIRE`{.envar}
            format for both criteria and toxics inventory together.
            Using a master (annual) inventory file (`PTINV`{.envar}) for
            fires described in [Section 8.2.8.3, "ORL FIRE
            Format"](ch08s02s08.html#sect_input_ptinv_fire "8.2.8.3. ORL FIRE Format"),
            SMOKE requires day-specific inventory file(s)
            (`PTDAY`{.envar}) described in [Section 8.2.6.2, "ORL
            FIREEMIS Emission
            Format"](ch08s02s06.html#sect_input_ptday_fireemis "8.2.6.2. ORL FIREEMIS Emission Format")
            to provide both criteria and toxics inventories for those
            matched sources. See more infomation about how-to-do at
            [Section 4.4.17, "Plume Rise Calculation for
            Fires"](ch04s04s17.html "4.4.17. Plume Rise Calculation for Fires").
        :::
    :::

2.  Collect or create inventories in correct formats.

    ::: {.orderedlist}
    a.  List format. The list format is simply an ASCII file that lists
        all of the files that you want SMOKE to import in a single run.

    b.  ORL format. This format is most appropriate for point toxics
        inventories, but also can be used for any inventory data.
    :::

3.  Set and/or check the file headers that apply for your file format.

    Please refer to the documentation in step (3) of the area/non-point
    steps in [Section 4.4.2.1, "Area/non-point
    inventories"](ch04s04s02.html#sect_scripts_area_invs "4.4.2.1. Area/non-point inventories").

4.  Install inventory files in `$PTDAT`{.filename} directory.

    This directory is
    `$SMKDAT`{.filename}/inventory/`$INVID`{.envar}/point

5.  Ensure the Assigns file has the `PTINV`{.envar} variable set to the
    `PTINV`{.envar} file name for your point-source inventory file.

6.  For hour-specific and day-specific data, including fire data, see
    [Section 4.4.2.5, "Day-specific and hour-specific point and fire
    inventories"](ch04s04s02.html#sect_scripts_hour_day_invs "4.4.2.5. Day-specific and hour-specific point and fire inventories").

7.  See also steps for all source categories in [Section 4.4.2.8, "Files
    and settings for all
    inventories"](ch04s04s02.html#sect_scripts_all_invs "4.4.2.8. Files and settings for all inventories").
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#sect_scripts_hour_day_invs}4.4.2.5. Day-specific and hour-specific point and fire inventories {#day-specific-and-hour-specific-point-and-fire-inventories .title}

</div>

</div>
:::

Point sources in SMOKE can include day-specific or hour-specific data.
This can include fire emissions and plume rise data. The following steps
must be performed to use day-specific and/or hour-specific data in
SMOKE.

::: {.orderedlist}
1.  Determine the files that need to be created and their formats

    ::: {.orderedlist}
    a.  For day-specific emissions data, create the list file
        `PTDAY`{.envar} and one or more files with day-specific
        emissions in the format provided in [Section 8.2.6,
        "`PTDAY`{.envar}: Point source day-specific
        emissions"](ch08s02s06.html "8.2.6. PTDAY: Point source day-specific emissions").
        The format requires that a list file be used to point to the
        actual data files, even if a single data file with emissions
        data is used.

    b.  For day-specific emissions data, the daily total should ideally
        be based on the same time zone as is being modeled by SMOKE.
        SMOKE needs to use the same output time zone (set with the
        `OUTZONE`{.envar} setting) as is used in the meteorology data
        that will be input to the air quality model. For example, if the
        time zone being modeled by SMOKE were GMT, then ideally the
        daily total emissions would be from 0 GMT to 23 GMT for each
        day.

    c.  For hour-specific emissions data that is [*not*]{.emphasis} CEM
        data, create the list file `PTHOUR`{.envar} and one or more
        files with hour-specific emissions in the format provided in
        [Section 8.2.7, "`PTHOUR`{.envar}: Point source hour-specific
        emissions"](ch08s02s07.html "8.2.7. PTHOUR: Point source hour-specific emissions").
        The format requires that a list file be used to point to the
        actual data files, even if a single data file with emissions
        data is used.

    d.  If using CEM data, the data files for 1995 through 2000 are
        available with SMOKE. A list file `PTHOUR`{.envar} must be
        created to list the one or more CEM data files that will be
        input. To speed processing, the DATERANGE setting can be used in
        the list file `PTHOUR`{.envar} to cause SMOKE to skip the dates
        in the CEM files that are not needed. Detail information is
        described in [Section 2.9.19, "Processing hour-specific CEM
        data"](ch02s09s19.html "2.9.19. Processing hour-specific CEM data")

    e.  If using hourly precomputed plume rise (e.g., for fire data),
        the `PTHOUR`{.envar} file should be created as described above
        for emissions data, but specific variable names must be
        provided. The allowable data includes the fraction of the plume
        in layer 1, the plume bottom height, and the plume top height.

    f.  If using daily fire inventories without precomputed plume rise,
        the `PTDAY`{.envar} file should be created as described above
        for emissions data and specific variables ( size of acres
        burned, fuel loading, and duration of fire ) must be provided
        for plume rise calculation and re-normalization of temporal
        profiles, as described in the file format documentation in
        [Section 8.2.8.3, "ORL FIRE
        Format"](ch08s02s08.html#sect_input_ptinv_fire "8.2.8.3. ORL FIRE Format")
        and [Section 8.2.6.2, "ORL FIREEMIS Emission
        Format"](ch08s02s06.html#sect_input_ptday_fireemis "8.2.6.2. ORL FIREEMIS Emission Format").

    g.  If using hourly stack exit temperature, velocity, or flow rates,
        the `PTHOUR`{.envar} file should be created as described above
        for emissions data, but specific variable names must be
        provided, as described in the file format documentation in
        [Section 8.2.7, "`PTHOUR`{.envar}: Point source hour-specific
        emissions"](ch08s02s07.html "8.2.7. PTHOUR: Point source hour-specific emissions").
    :::

2.  Install inventory files in `$PTDAT`{.filename} directory.

    This directory is
    `$SMKDAT`{.filename}/inventory/`$INVID`{.envar}/point

3.  Ensure the Assigns file has the `PTHOUR`{.envar} and `PTDAY`{.envar}
    variables set to the `PTHOUR`{.envar} and `PTDAY`{.envar} file names
    for your inventory files.

4.  Ensure script settings will use the day-specific and hour-specific
    data.

    ::: {.orderedlist}
    a.  For day-specific data import and usage, set
        `DAY_SPECIFIC_YN`{.envar} setting to Y.

    b.  For hour-specific data import and usage, set
        `HOUR_SPECIFIC_YN`{.envar} setting to Y. This applies to using
        either hourly emissions or hourly-precomputed plume rise.
    :::

5.  If using hourly data, make sure the `OUTZONE`{.envar} setting is
    consistent with what will be used for other SMOKE processing steps.

    The example SMOKE scripts make it difficult to not use the same
    `OUTZONE`{.envar} setting for all processing steps. Nevertheless,
    the user is responsible for ensuring that the same setting is used
    for all SMOKE processing steps, including import of hourly
    inventories. The `OUTZONE`{.envar} setting will affect the hourly
    inventory import because the hourly emissions will be adjusted by
    **Smkinven** from the local time zones in the `PTHOUR`{.envar} input
    files to the output time zone set by `OUTZONE`{.envar} to create the
    `PHOUR`{.envar} intermediate file.

6.  If using precomputed plume rise, ensure script settings will cause
    SMOKE to use the plume rise data.

    ::: {.orderedlist}
    a.  Set `HOUR_PLUMEDATA_YN`{.envar} setting to Y.

    b.  For UAM and CAM~X~ modeling, set:

        ::: {.itemizedlist}
        -   `RUN_LAYPOINT`{.envar} setting to Y (this program is not
            usually needed for these models)

        -   `EXPLICIT_PLUMES_YN`{.envar} setting to Y
        :::
    :::

7.  For fires emission modeling with internal plume rise calculation,
    SMOKE compute the plume rise data with internally computed heat flux
    from fuel loading and burned area. See detail at [Section 4.4.17,
    "Plume Rise Calculation for
    Fires"](ch04s04s17.html "4.4.17. Plume Rise Calculation for Fires")

8.  If providing future-year hour-specific data, ensure that the dates
    used in the file are consistent with the [*base year*]{.emphasis}
    dates. The dates must match the dates of the meteorology data that
    will be used by the air quality model.
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#sect_scripts_future_invs}4.4.2.6. Future-year inventories {#future-year-inventories .title}

</div>

</div>
:::

For future-year modeling, you can choose to input future-year
inventories to SMOKE. This is a different approach from importing a
base-year inventory and using SMOKE growth to create a future-year
inventory. The future-year inventory could be created outside of SMOKE
and would need to be in one of the SMOKE input formats available for the
source categories of interest.

A future-year inventory could also be created by SMOKE, since the
**Grwinven** program can output emissions in ORL format. In this
section, we do not cover importing base year inventories and using SMOKE
to grow them to a future year; that topic is covered in [Section 4.4.11,
"Setup projection and control
scenarios"](ch04s04s11.html "4.4.11. Setup projection and control scenarios").
Following the instructions in that section, it is feasible to create a
future-year inventory in SMOKE raw input format and use it as we
describe in this section.

::: {.orderedlist}
1.  Set the \#YEAR setting in the inventory input files to the future
    inventory year.

2.  Set the `SMK_BASEYR_OVERRIDE`{.envar} setting in the run script to
    the value of the base year.

    Ordinarily, this setting would simply be set to zero, which
    indicates that it is not to be used and the inventory year is the
    same as the base year. In this case, the base year cannot be set by
    the inventory year, so this setting provides the actual year to use.
    The base year is most often the same year as the year of meteorology
    data you are using to model your episode. When this setting is
    defined by a script, **Smkinven** will set the base year with that
    setting and set the future year as the year of the inventory data.

3.  Set the `YEAR`{.envar} setting in the Assigns file to the base year.

4.  Set the `FYEAR`{.envar} setting in the run scripts to the future
    year.

5.  Set the `SMK_FUTURE_YN`{.envar} setting in the run scripts to Y.
:::

See [Section 4.2.4, "Script
settings"](ch04s02s04.html "4.2.4. Script settings") for more
information about how this setting affects the output directory
structure and file names.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#sect_scripts_pregridded}4.4.2.7. Pre-gridded inventories {#pre-gridded-inventories .title}

</div>

</div>
:::

::: {.toc}
[[4.4.2.7.1. Pre-gridded inventories from the same modeling domain as an
area source without source characterization or
attributes](ch04s04s02.html#sect_scripts_pregridded_invs_same)]{.section}

[[4.4.2.7.2. Pre-gridded inventories processing for converting between
different modeling domains with source characterization and
attributes](ch04s04s02.html#sect_scripts_pregridded_invs_different)]{.section}
:::

Smoke has two ways of processing the pregridded inventory data. If the
inventory data is in native netCDF format then see [Section 4.4.2.7.1,
"Pre-gridded inventories from the same modeling domain as an area source
without source characterization or
attributes"](ch04s04s02.html#sect_scripts_pregridded_invs_same "4.4.2.7.1. Pre-gridded inventories from the same modeling domain as an area source without source characterization or attributes").
If the inventory is in IO-API/netCDF format then see [Section 4.4.2.7.2,
"Pre-gridded inventories processing for converting between different
modeling domains with source characterization and
attributes"](ch04s04s02.html#sect_scripts_pregridded_invs_different "4.4.2.7.2. Pre-gridded inventories processing for converting between different modeling domains with source characterization and attributes")

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#sect_scripts_pregridded_invs_same}4.4.2.7.1. Pre-gridded inventories from the same modeling domain as an area source without source characterization or attributes {#pre-gridded-inventories-from-the-same-modeling-domain-as-an-area-source-without-source-characterization-or-attributes .title}

</div>

</div>
:::

SMOKE has a limited capability to import pre-gridded data from the same
modeling domain. It can import the data if it is time-independent and if
the grid cell and pollutant names are the only attributes needed to
identify the emissions. If SCC or other attributes are available, SMOKE
cannot use these directly; though in the case of SCCs, each SCC could
conceivably be tediously input as a separate dataset and modeled as a
separate inventory.

If any source category is available as pre-gridded data, the following
steps must be taken.

::: {.orderedlist}
1.  Plan to import the data as an area source.

    Only SMOKE area-source processing can use pre-gridded data, no
    matter that actual source category of origin for the data.
    Essentially, once emissions data no longer has attributes such as
    SCCs, stack information for point sources, or country/state/county
    codes, it all appears to be the same type of data to SMOKE and can
    be processed as an area source.

    This is not to say that all pre-gridded inventories can be processed
    correctly by SMOKE. For example, if a pre-gridded point source
    inventory including stack identifiers and stack parameters were
    provided with grid cell numbers instead of lat/lon coordinates, this
    could not be appropriately processed by SMOKE area processing as
    pre-gridded data.

    If any SMOKE processing steps such as chemical speciation or
    temporal allocation need to be done based on SCC, this is not
    possible. Only a single default profile for speciation or temporal
    allocation can be applied to each pre-gridded inventory.

2.  Convert data to I/O API format.

    Users must convert the pre-gridded data to I/O API format. The
    format is like the `AG`{.envar} file that can be output from
    **Smkmerge**. This format has each pollutant stored as a variable
    and is time independent. Some sort of ASCII-to-I/O API converter
    must be created and used to perform this step. At this time, there
    is no general-purpose tool to make such a conversion released with
    the SMOKE system.

3.  Set the `IMPORT_GRDIOAPI_YN`{.envar} setting to Y.

    This setting will cause **Smkinven** to expect the I/O API gridded
    input and will request the `AG`{.envar} logical file name instead of
    the `ARINV`{.envar} file.

4.  Ensure that the `AG`{.envar} logical file name is set by the Assigns
    file or by the run script.

    This logical file name must be set to the I/O API-formatted
    pre-gridded inventory file.
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#sect_scripts_pregridded_invs_different}4.4.2.7.2. Pre-gridded inventories processing for converting between different modeling domains with source characterization and attributes {#pre-gridded-inventories-processing-for-converting-between-different-modeling-domains-with-source-characterization-and-attributes .title}

</div>

</div>
:::

SMOKE will regrid the data from the native NetCDF-formatted pregridded
inventory data (e.g. lat-lon for global inventories) to the CMAQ
modeling grid, and apply a unique source ID to each grid cell to allow
SMOKE to perform chemical speciation, temporal allocation from annual to
hourly timesteps, and elevated source selection and vertical allocation.
The pre-gridded inventory files each contain data for a different
sector, the sector and pollutant contained in each pre-gridded inventory
file is specified in the ARINV file using the \#LIST GRID format.

To process pre-gridded data from different modeling domains, the
following steps must be taken.

::: {.orderedlist}
1.  Set the `IMPORT_GRDNETCDF_YN`{.envar} to Y to read the native netCDF
    annual inventory files.

2.  Grdmat is used to convert the data from the input data grid (e.g.
    lat-lon for EDGAR/RCP/HTAP) to the output modeling grid. Set the
    `IOAPI_GRIDNAME_1`{.envar} to specify the output grid.

3.  SMOKE reads each grid cell in the gridded inventory file as a unique
    source that will have a unique source ID. The lower left corner of
    inventory grid will be source 1, cell (2,1) will be source 2, cell
    (3,1) source 3, etc

4.  For each gridded inventory file, a Geographical Code Mask Input file
    (GRIDMASK) is provided by UNC for EDGAR inventory files that assigns
    a GEOGRID\_LEVEL2 value to each grid cell.

5.  The ARINV file is used to read in a list of gridded inventory files
    and to specify the SCC associated with each gridded inventory file

6.  Set the `NETCDF_POL_UNIT`{.envar} to kg m-2 -s

7.  Set the `NETCDF_INV_YEAR`{.envar} to the year of the inventory
    (e.g. 2010)

8.  To apply control factors to adjust emissions by GEOCODE\_LEVEL and
    SCC use the CONTROL packet in the GCNTL file

9.  To apply vertical profiles to gridded inventory data using the SMOKE
    Utility Program Layalloc. The EDGAR inventory includes fixed
    vertical profiles by sector that define the percentages of emissions
    by altitude band. Layalloc will create 3-d output files for the
    gridded emissions sectors that emit above the surface layer (e.g.
    energy and industrial sources).
:::
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#sect_scripts_all_invs}4.4.2.8. Files and settings for all inventories {#files-and-settings-for-all-inventories .title}

</div>

</div>
:::

For importing all inventories, the following steps should be taken to
review settings and change them as appropriate for your specific
modeling case.

Assigns file settings:

::: {.orderedlist}
1.  Change the Assigns files inventory settings.

    Following the settings in [Section 4.4.1, "Change Assigns file to
    set scenario names, grid names, and other case-specific
    configuration
    information"](ch04s04.html#sect_scripts_change_assigns "4.4.1. Change Assigns file to set scenario names, grid names, and other case-specific configuration information"),
    you should have created a new Assigns file for your case and set the
    `INVID`{.envar}, `INVEN`{.envar}, and `INVOP`{.envar} settings
    described in [Table 4.1, "Variable in Assigns file for naming files
    and
    directories"](ch04s04.html#tbl_scripts_variables_files "Table 4.1. Variable in Assigns file for naming files and directories").
    Since the inventory input directories depend on the `INVID`{.envar}
    setting, you should make sure that the value set for `INVID`{.envar}
    is consistent with the location of the inventory files. For example,
    the `ARINV`{.envar} files should be installed in
    `$SMKDAT`{.filename}/inventory/`$INVID`{.envar}/area. Make sure that
    `$INVID`{.envar} label in the paths for the files installed in prior
    subsections is the same as the `$INVID`{.envar} label in the Assigns
    file that is included in the Assigns file you will use.

2.  Set the `ABASE`{.envar}, `MBASE`{.envar}, `PBASE`{.envar}, and
    `EBASE`{.envar} settings described in [Table 4.1, "Variable in
    Assigns file for naming files and
    directories"](ch04s04.html#tbl_scripts_variables_files "Table 4.1. Variable in Assigns file for naming files and directories").
    This is usually done for a new inventory, and can also be done for
    new scenarios with an existing inventory.
:::

Script settings:

::: {.orderedlist}
3.  Double check that the correct Assigns file (e.g., the one with the
    correct `$INVID`{.envar} setting) is used by the run scripts for
    your case.

4.  Set the `RAW_DUP_CHECK`{.envar} setting to Y if you want
    **Smkinven** to give an error if any duplicate entries are found in
    the inventory. See [Section 6.13,
    "**Smkinven**"](ch06s13.html "6.13. Smkinven") for more information.

5.  Set the `SMKINVEN_FORMULA`{.envar} setting to compute one or more
    pollutant values from teh values of other pollutants.

    This is most commonly used to compute coarse particulates (PMC) from
    PM~10~ and PM~2.5~ using the setting "[PMC = PM10 -
    PM2\_5]{.quote}".

6.  Set the `WEST_HSPHERE`{.envar} setting to reset any positive
    longitude values that are intended for the Western hemisphere to a
    negative value.

7.  Set the `WKDAY_NORMALIZE`{.envar} setting to account for the desired
    weekday normalization approach to be used for hourly emissions. See
    [Section 6.13, "**Smkinven**"](ch06s13.html "6.13. Smkinven") for
    more information.

8.  Set the `SMK_PROCESS_HAPS`{.envar} to read the `NHAPEXCLUDE`{.envar}
    file.

    This setting is only relevant when importing both criteria and toxic
    inventories. In this case, if there are VOCs in both inventories and
    the `INVTABLE`{.envar} has indicate which toxics are VOCs,
    **Smkinven** will attempt to integrate VOC emissions for all sources
    from the criteria and toxics inventories. The `NHAPEXCLUDE`{.envar}
    file provides a list of SCCs for which **Smkinven** should not
    integrate the inventories and should instead drop the toxic VOC
    emissions to prevent double counting. Toxic emissions of explicit
    model species are never dropped, however. More information is
    available in [Section 2.9.5, "Combine toxics and criteria
    inventories"](ch02s09s05.html "2.9.5. Combine toxics and criteria inventories").

9.  Set the `SMK_ARTOPNT_YN`{.envar} setting to Y when **Smkinven**
    should use the `ARTOPNT`{.envar} file to assign point source
    locations to area-source emissions.

10. Set the `FILL_ANNUAL`{.envar} setting to Y to fill annual emissions
    values with average-day values, when average-day values are
    available but annual values are not.

    See [Section 4.4.2.9, "Using average-day and annual data in the same
    run"](ch04s04s02.html#sect_scripts_average_day_invs "4.4.2.9. Using average-day and annual data in the same run")
    for more information on why one might want to use this option.
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#sect_scripts_average_day_invs}4.4.2.9. Using average-day and annual data in the same run {#using-average-day-and-annual-data-in-the-same-run .title}

</div>

</div>
:::

The ORL and FF10 formats provide fields for both annual and average-day
emissions values. SMOKE will import both values when either of these
formats are used and store all emissions in the SMOKE intermediate
inventory files. To configure the **Temporal** allocation step, you have
the option of using the `SMK_AVEDAY_YN`{.envar} setting to select using
either the annual or average-day data when both are available. This
option and its typical usage will be explained with the **Temporal**
settings.

This section describes what to do when both annual data and average-day
data need to be used in the same SMOKE run. This can occur when part of
an inventory has been provided using annual inventories only (the
average-day values are missing or incorrect) and a different part with
average-day inventories only (the annual values are missing). This is
only a problem when you want to run all of the sources in a single run;
so, if nonroad and stationary area sources are provided with the two
different temporal resolutions, these can just be run with separate
SMOKE runs. If two parts of the stationary area source inventory are
provided with two different temporal resolutions, then this section can
help to setup the modeling correctly.

Two approaches are available in SMOKE to resolve this situation. In the
first approach, one can set SMOKE to run using the average-day data, and
in the second approach, set to use the annual data. These lists describe
these two approaches:

Run all sources using "[annual]{.quote}" data

::: {.orderedlist}
1.  Set the `FILL_ANNUAL`{.envar} setting to Y. This will cause the
    missing annual data to be filled in with the available average-day
    data by multiplying the number of days in the year, accounting for
    leap years.

2.  Ensure that the monthly temporal profile assignments made by the
    `ATREF`{.envar}, `MTREF`{.envar}, or `PTREF`{.envar} files assign
    uniform monthly profiles to any all sources that have the annual
    numbers filled in with seasonal values.

3.  During temporal processing, set `SMK_AVEDAY_YN`{.envar} to N. This
    will ensure that both the annual values that were available in the
    inventory and the annual values that were computed will be used by
    the **Temporal** program. Since the monthly temporal profiles for
    the filled-in annual emissions have been set to uniform, the
    average-day values will be calculated from the filled-in annual
    values.
:::

Run all sources using average-day data

::: {.orderedlist}
1.  Set the `FILL_ANNUAL`{.envar} setting to N. By default, **Smkinven**
    computes an average-day value when none is provided by dividing the
    annual value by the number of days in the year, accounting for leap
    years.

2.  During temporal processing, set `SMK_AVEDAY_YN`{.envar} to Y. This
    will ensure that both the average-day values that were available in
    the inventory and the average-day values that were computed will be
    used by the **Temporal** program.

3.  Note that no monthly profiles are applied to average-day emissions,
    so if monthly variation is needed, it will need to be calculated
    outside of SMOKE. In this case, it might be easier to run all
    sources as annual, as described above.
:::
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  ------------------------ -------------------- -----------------------------------------------------------
  [Prev](ch04s04.html)      [Up](ch04s04.html)                                      [Next](ch04s04s03.html)
  4.4. How to use SMOKE     [Home](index.html)     4.4.3. Select which pollutants in the inventory are kept
  ------------------------ -------------------- -----------------------------------------------------------
:::
