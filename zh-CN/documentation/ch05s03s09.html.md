::: {.navheader}
5.3.9. **Layalloc**
:::

[Prev](ch05s03s08.html) 

5.3.  SMOKE Utility Programs

 [Next](ch05s03s10.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_utilities_layalloc}5.3.9. **Layalloc** {#layalloc .title}

</div>

</div>
:::

::: {.toc}
[[5.3.9.1. Description](ch05s03s09.html#d0e20328)]{.section}

[[5.3.9.2. Processing Order](ch05s03s09.html#d0e20349)]{.section}

[[5.3.9.3. Files and Environment
Variables](ch05s03s09.html#d0e20363)]{.section}
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e20328}5.3.9.1. Description {#description .title}

</div>

</div>
:::

The **Layalloc** program calculates 3-D emissions from a 2-D pre-gridded
emissions file. **Layalloc** is used to reallocate single layer 2-D
surface layer emissions into multiple model layers. This approach is
useful for processing pre-gridded or industrial area source inventories
that do not contain stack information for plume rise treatment but
represent elevated sources.

**Layalloc** reads in a gridded 2-D pre-gridded emissions file (either
output from the **Smkmerge** program or from a pregridded global
emission inventory (EDGAR/RCP/HTAP)) and redistributes the emissions
into multiple model layers based on a user-defined vertical profile. The
vertical profiles that are input to **Layalloc** consist of a layer
bottom height, layer top height, and the fraction of emissions to
allocate to the layer. SMOKE willl interpolate from the layer heights
(in meters) to the model layers (in sigma-pressure). This approach
assumes that the vertical factors are uniformly applied over all
horizontal grid cells. The resulting hourly, gridded, speciated 3-D
emissions data are output to a new I/O API file with the same temporal
resolution and the same model species as the original 2-D emissions
file.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e20349}5.3.9.2. Processing Order {#processing-order .title}

</div>

</div>
:::

This optional program can be run after **Smkmerge** and before either
**Mrggrid** (if it is being used to merge several **Smkmerge** output
files together) or the AQM of interest.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e20363}5.3.9.3. Files and Environment Variables {#files-and-environment-variables .title}

</div>

</div>
:::

::: {.toc}
[[5.3.9.3.1. Input Files](ch05s03s09.html#d0e20366)]{.section}

[[5.3.9.3.2. Input Environment
Variables](ch05s03s09.html#d0e20441)]{.section}

[[5.3.9.3.3. Output Files](ch05s03s09.html#d0e20446)]{.section}
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e20366}5.3.9.3.1. Input Files {#input-files .title}

</div>

</div>
:::

::: {.informaltable}
+-------------------------+----------------+-------------------------+
| File Name               | Format         | Description             |
+=========================+================+=========================+
| `INFILE`{.envar}        | I/O API NetCDF | 2-D hourly, gridded,    |
|                         |                | speciated inputs from   |
|                         |                | **Smkmerge**.           |
|                         |                | `INFILE`{.envar} should |
|                         |                | be set to logical file  |
|                         |                | name                    |
|                         |                | `AGTS_[L|S]`{.envar},   |
|                         |                | `BGTS_[L|S]`{.envar},   |
|                         |                | `MGTS_[L|S]`{.envar},   |
|                         |                | `PGTS_[L|S]`{.envar},   |
|                         |                | or                      |
|                         |                | `EGTS_[L|S]`{.envar},   |
|                         |                | which are the output    |
|                         |                | files from              |
|                         |                | **Smkmerge**.           |
+-------------------------+----------------+-------------------------+
| `MET_CRO_3D`{.envar}    | I/O API NetCDF | Meteorology file        |
|                         |                | contains a variable     |
|                         |                | "[ZF]{.quote}" which is |
|                         |                | full-layer height above |
|                         |                | ground (m)              |
+-------------------------+----------------+-------------------------+
| `                       | ASCII          | File that lists the     |
| LAYER_FRACTION`{.envar} |                | layer top and bottom    |
|                         |                | heights in meter(s)     |
|                         |                | along with a percentage |
|                         |                | factor. For example,    |
|                         |                | the following           |
|                         |                | `                       |
|                         |                | LAYER_FRACTION`{.envar} |
|                         |                | file sample would       |
|                         |                | distribute 2-D          |
|                         |                | emissions into multiple |
|                         |                | model layers based upon |
|                         |                | five user-defined       |
|                         |                | layers.                 |
|                         |                |                         |
|                         |                | ``` {.programlisting}   |
|                         |                | No., Bottom Ht(         |
|                         |                | m), Top Ht(m), Fraction |
|                         |                | 1,         0,           |
|                         |                |        100,        0.60 |
|                         |                | 2,       100,           |
|                         |                |        200,        0.20 |
|                         |                | 3,       200,           |
|                         |                |        400,        0.10 |
|                         |                | 4,       400,           |
|                         |                |        600,        0.07 |
|                         |                | 5,       600,           |
|                         |                |       1000,        0.03 |
|                         |                | ```                     |
+-------------------------+----------------+-------------------------+
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e20441}5.3.9.3.2. Input Environment Variables {#input-environment-variables .title}

</div>

</div>
:::

None
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e20446}5.3.9.3.3. Output Files {#output-files .title}

</div>

</div>
:::

::: {.informaltable}
  File Name           Format           Description
  ------------------- ---------------- ---------------------------------------------------------------------------------------
  `LOGFILE`{.envar}   ASCII            Log generated from executing **Layalloc**
  `OUTFILE`{.envar}   I/O API NetCDF   3-D hourly, gridded, speciated emissions, adjusted based on `LAYER_FRACTION`{.envar}.
:::
:::
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  -------------------------- -------------------- --------------------------
  [Prev](ch05s03s08.html)     [Up](ch05s03.html)     [Next](ch05s03s10.html)
  5.3.8. **Invsplit**         [Home](index.html)      5.3.10. **Metcombine**
  -------------------------- -------------------- --------------------------
:::
