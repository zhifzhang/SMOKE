::: {.navheader}
Chapter 7. SMOKE Quality Assurance
:::

[Prev](ch06s17s03.html) 

 

 [Next](ch07s02.html)

------------------------------------------------------------------------

::: {.chapter lang="en"}
::: {.titlepage}
<div>

<div>

[]{#ch_quality_assurance}Chapter 7. SMOKE Quality Assurance {#chapter-7.-smoke-quality-assurance .title}
-----------------------------------------------------------

</div>

</div>
:::

::: {.toc}
[[7.1. Introduction](ch07.html#d0e32876)]{.section}

[[7.2. **Smkreport** Program](ch07s02.html)]{.section}

[[7.3. `REPCONFIG`{.envar} Input File](ch07s03.html)]{.section}

[[7.4. Reports Created by **Smkreport**](ch07s04.html)]{.section}

[[7.5. Quality Assurance Methods](ch07s05.html)]{.section}
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

[]{#d0e32876}7.1. Introduction {#introduction .title style="clear: both"}
------------------------------

</div>

</div>
:::

This chapter provides documentation on SMOKE's quality assurance (QA)
capabilities. Quality assurance of emissions modeling results is a very
important component of using SMOKE. Because emission modeling is a
complex procedure that includes many disparate data sets and many
processing steps, it is critical that quality assurance be performed on
the emissions modeling results prior to using the model-ready emissions
in air quality modeling. Failure to quality assure the results will
almost surely result in undesirable errors in SMOKE's output caused by
factors such as user inexperience, file formatting errors,
misunderstanding of software capabilities, and software bugs. It is far
preferable to catch emissions modeling problems during emissions
modeling rather than after the emissions results have already been used
and policy decisions made based on them.

SMOKE quality assurance consists of at least the following components:

::: {.itemizedlist}
-   Setting up SMOKE using available documentation (this manual) on file
    formats and script setup.

-   Reviewing log files for errors and warnings, then resolving any
    problems.

-   Reviewing reports generated by SMOKE core programs (e.g., reports
    from the **Cntlmat** program indicating which controls were applied
    and the changes made to the inventory emissions).

-   Reviewing and customizing reports generated by the **Smkreport**
    program, and comparing these to one another and to totals from the
    emission inventory.
:::

In this chapter, we provide documentation on the **Smkreport** program
([Section 7.2, "**Smkreport**
Program"](ch07s02.html "7.2. Smkreport Program")), on its main input
file `REPCONFIG`{.envar} ([Section 7.3, "`REPCONFIG`{.envar} Input
File"](ch07s03.html "7.3. REPCONFIG Input File")), and on the
**Smkreport** output reports ([Section 7.4, "Reports Created by
**Smkreport**"](ch07s04.html "7.4. Reports Created by Smkreport")). In
the final section of this chapter ([Section 7.5, "Quality Assurance
Methods"](ch07s05.html "7.5. Quality Assurance Methods")), we outline QA
methods that SMOKE users can apply to ensure that their inventory and
emissions modeling efforts are as correct as possible.
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  ------------------------------------------ -------------------- -----------------------------
  [Prev](ch06s17s03.html)                                                  [Next](ch07s02.html)
  6.17.3. Files and Environment Variables     [Home](index.html)     7.2. **Smkreport** Program
  ------------------------------------------ -------------------- -----------------------------
:::
::: {.navheader}
7.2. **Smkreport** Program
:::

[Prev](ch07.html) 

Chapter 7. SMOKE Quality Assurance

 [Next](ch07s02s02.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

[]{#sect_qa_smkreport}7.2. **Smkreport** Program {#smkreport-program .title style="clear: both"}
------------------------------------------------

</div>

</div>
:::

::: {.toc}
[[7.2.1. Description](ch07s02.html#d0e32926)]{.section}

[[7.2.2. Processing Order](ch07s02s02.html)]{.section}

[[7.2.3. Files and Environment Variables](ch07s02s03.html)]{.section}
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#d0e32926}7.2.1. Description {#description .title}

</div>

</div>
:::

**Smkreport** uses the SMOKE intermediate files generated by other SMOKE
programs to create a large variety of emissions and activity data totals
to be used for QA of the emissions data. This QA is in addition to the
QA performed by other SMOKE programs for checking file formats and input
quality, and it focuses on analysis of the emissions values processed
and output by SMOKE. **Smkreport** operates on one source category
(area, mobile, or point) in a given run, though it does not operate on
biogenic emissions because biogenic does not have the same structure of
intermediate files that **Smkreport** uses for inputs. Each run of
**Smkreport** is also limited to one speciation scenario, one grid
projection and resolution, and one hourly emissions file. **Smkreport**
can also read in growth or multiplicative control matrices, but not
reactivity control matrices. All of these component datasets are
optional, however, and their use is controlled by the settings in the
Report Configuration File (`REPCONFIG`{.envar}), described in
[Section 7.3, "`REPCONFIG`{.envar} Input
File"](ch07s03.html "7.3. REPCONFIG Input File"). Analysis of multiple
source categories (area/mobile/point) in the same report is a
postprocessing step in which the user can import multiple reports from
different source categories and analyze across multiple source
categories.

The most important input file to **Smkreport** is the
`REPCONFIG`{.envar} file. Through this file, you have a tremendous
amount of flexibility in generating different types of reports. Options
are invoked by using reporting "[instructions]{.quote}", which you
prepares before using **Smkreport**. See the `REPCONFIG`{.envar}
documentation in [Section 7.3, "`REPCONFIG`{.envar} Input
File"](ch07s03.html "7.3. REPCONFIG Input File") for more information on
the reporting options. Additionally, in [Section 7.5, "Quality Assurance
Methods"](ch07s05.html "7.5. Quality Assurance Methods") we provide some
guidance on the types of analyses you can perform using reports created
by **Smkreport**, and reasons why you might want to use those analyses.

**Smkreport** can generate multiple reports with a single run of the
program. Multiple report writing is helpful, because a large part of the
time that the program takes to run is reading in the SMOKE intermediate
files. Note that the multiple reports are all for a single source
category for one run of **Smkreport**. As described in the [Section 7.4,
"Reports Created by
**Smkreport**"](ch07s04.html "7.4. Reports Created by Smkreport"), the
report output names are configured by the `REPCONFIG`{.envar} file. You
may specify either physical file names (including the path) in
`REPCONFIG`{.envar}, or you may specify logical file names and then make
sure your script sets the logical file names to physical file names.
[Chapter 4, *How to Use SMOKE*](ch04.html "Chapter 4. How to Use SMOKE")
describes the default configuration of reports in the example SMOKE
scripts. At the end of [Chapter 4, *How to Use
SMOKE*](ch04.html "Chapter 4. How to Use SMOKE"), we also provide
information about how to configure the scripts to change the output
reports that SMOKE will create.
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  ------------------------------------- -------------------- --------------------------
  [Prev](ch07.html)                       [Up](ch07.html)       [Next](ch07s02s02.html)
  Chapter 7. SMOKE Quality Assurance     [Home](index.html)     7.2.2. Processing Order
  ------------------------------------- -------------------- --------------------------
:::
::: {.navheader}
7.2.2. Processing Order
:::

[Prev](ch07s02.html) 

7.2. **Smkreport** Program

 [Next](ch07s02s03.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#d0e32993}7.2.2. Processing Order {#processing-order .title}

</div>

</div>
:::

**Smkreport** can only be used after [*at least*]{.emphasis}
**Smkinven** (for inventory import) has been run. Depending on the
reporting options selected in the `REPCONFIG`{.envar} input file, other
processing steps may need to have been run. For example, to create a
report of county total emissions after gridding, the **Grdmat** (for
spatial allocation) program must have been run already to create the
gridding matrix. **Smkreport** can use output files from the following
programs: **Smkinven**, **Temporal** (for temporal allocation),
**Spcmat** (for chemical speciation), **Grdmat**, **Elevpoint** (for
elevated source selection), **Laypoint** (for plume rise calculations),
and **Cntlmat**.
:::

::: {.navfooter}

------------------------------------------------------------------------

  ----------------------------- -------------------- -----------------------------------------
  [Prev](ch07s02.html)           [Up](ch07s02.html)                    [Next](ch07s02s03.html)
  7.2. **Smkreport** Program     [Home](index.html)     7.2.3. Files and Environment Variables
  ----------------------------- -------------------- -----------------------------------------
:::
::: {.navheader}
7.2.3. Files and Environment Variables
:::

[Prev](ch07s02s02.html) 

7.2. **Smkreport** Program

 [Next](ch07s03.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#d0e33036}7.2.3. Files and Environment Variables {#files-and-environment-variables .title}

</div>

</div>
:::

::: {.toc}
[[7.2.3.1. Input Files](ch07s02s03.html#d0e33039)]{.section}

[[7.2.3.2. Input Environment
Variables](ch07s02s03.html#sect_qa_smkreport_envar)]{.section}

[[7.2.3.3. Output Files](ch07s02s03.html#d0e33484)]{.section}
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e33039}7.2.3.1. Input Files {#input-files .title}

</div>

</div>
:::

The input files depend upon the `SMK_SOURCE`{.envar} input instruction
in the `REPCONFIG`{.envar} input file setting when the program is
started. With the exception of the SMOKE intermediate inventory file
(`AREA`{.envar}, `MOBL`{.envar}, `PNTS`{.envar}), whether a file is
optional or not depends on the settings in `REPCONFIG`{.envar}. If
**Smkreport** is being executed to produce speciated, gridded,
temporally allocated area sources, for instance, then the area-source
inventory, speciation matrix, gridding matrix, and hourly emissions are
required. Also, the source category of the input file depends on the
`REPCONFIG`{.envar} file setting for `SMK_SOURCE`{.envar}. For example,
if only area sources are being merged (`SMK_SOURCE`{.envar} is set to
A), then only area-source-related inputs are required.

::: {.informaltable}
  File Name                      Format           Source Type   Description
  ------------------------------ ---------------- ------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  `[A|M|P]CMAT`{.envar}          I/O API NetCDF   A, M, P       Multiplicative control matrix from **Cntlmat**
  `[A|M|P]GMAT`{.envar}          I/O API NetCDF   A, M, P       Gridding matrix from **Grdmat**
  `[A|M]GSUP`{.envar}            ASCII            A, M          Supplementary file from **Grdmat** that contains all gridding surrogate codes assigned to each source
  `[A|M|P]PMAT`{.envar}          I/O API NetCDF   A, M, P       Growth matrix from **Cntlmat**
  `[A|M|P]RMAT`{.envar}          I/O API NetCDF   A, M, P       Mass-based or mole-based reactivity matrix from **Cntlmat** (optional, [*not yet supported by SMOKE*]{.emphasis})
  `[A|M|P]SMAT`{.envar}          I/O API NetCDF   A, M, P       Mass-based or mole-based speciation matrix from **Spcmat**
  `[A|M|P]SSUP`{.envar}          ASCII            A, M, P       Supplementary file from **Spcmat** that contains all speciation profile codes assigned to each source
  `[A|M|P]TMP`{.envar}           I/O API NetCDF   A, M, P       Temporally allocated emissions from **Temporal**
  `[A|M|P]TSUP`{.envar}          ASCII            A, M, P       Supplementary file from **Temporal** that contains all monthly, weekly, and diurnal profile codes assigned to each source. [**This file will only work when profiles have not been applied by pollutant.**]{.bold}
  `AREA`{.envar}                 SMOKE map        A             Intermediate area-source emissions inventory from **Smkinven**
  `COSTCY`{.envar}               ASCII            A, M, P       Country, state and county file with time zones and, optionally, population
  `ELEVTS_[L|S]`{.envar}         ASCII            P             Elevated point-source file written by **Smkmerge** for UAM and CAM~X~ modeling. See `MRG_GRDOUT_UNIT`{.envar} environment variable setting in [Section 7.2.3.2, "Input Environment Variables"](ch07s02s03.html#sect_qa_smkreport_envar "7.2.3.2. Input Environment Variables").
  `GEOCODE_LEVEL[1-4]`{.envar}   ASCII            A, B, M, P    Geographic level codes and descriptions (also contains Time Zone for GEOCODE\_LEVEL4) note: used if USE\_EXP\_GEO\_CODES set to Y and COSTCY file is ignored. See more detail about GEOCODE\_LEVELS in [Section 8.10.3, "`GEOCODE_LEVEL[1-4]: Geographical Input Files`{.envar}"](ch08s10s03.html "8.10.3. GEOCODE_LEVEL[1-4]: Geographical Input Files").
  `GRIDDESC`{.envar}             ASCII            A, M, P       Contains description of the modeling grid
  `MACTDESC`{.envar}             ASCII            A, P          MACT code descriptions
  `MOBL`{.envar}                 SMOKE map        M             Intermediate mobile-source emissions and/or activity inventory from **Smkinven**
  `NAICSDESC`{.envar}            ASCII            A, P          NAICS code descriptions
  `ORISDESC`{.envar}             ASCII            A, P          ORIS ID code descriptions
  `PELV`{.envar}                 ASCII            P             Elevated point-sources identification file; if reporting based on elevated point sources
  `PLAY`{.envar}                 I/O API NetCDF   P             Layer fractions file output by the **Laypoint** program
  `PNTS`{.envar}                 SMOKE map        P             Intermediate point-source emissions inventory from **Smkinven**
  `REPCONFIG`{.envar}            ASCII            A, M, P       Report configuration file
  `SCCDESC`{.envar}              ASCII            A, M, P       SCC descriptions
  `SICDESC`{.envar}              ASCII            A, M, P       SIC descriptions
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#sect_qa_smkreport_envar}7.2.3.2. Input Environment Variables {#input-environment-variables .title}

</div>

</div>
:::

::: {.itemizedlist}
-   `USE_EXP_GEO_CODES`{.envar}: \[default: N\]

    If set to Y, this variable is used to specify the use of expanded
    12-character geograpic codes contained in the
    **GEOCODE\_LEVEL\[1-4\]** input files. For **Smkreport**, it
    controls which ASCII GEOCODE file to use. The user can select the
    data extraction summary format in the `REPCONFIG`{.envar} file. If
    the REPCONFIG file contains `CARB_QADEF`{.envar} setting, then
    **Smkreport** creates reports in the CARB QA Data Extraction Format.
    If the REPCONFIG file contains the `BY GEOCODE_LEVEL1[NAME]`{.envar}
    or `BY GEOCODE_LEVEL2[NAME]`{.envar} or
    `BY GEOCODE_LEVEL3[NAME]`{.envar} or
    `BY GEOCODE_LEVEL4[NAME]`{.envar} then **Smkreport** creates reports
    at each geographic level with its description and local time zone.

-   `MRG_GRDOUT_UNIT`{.envar}: \[default: blank\]

    This variable is the same one used to control the **Smkmerge**
    output units. For **Smkreport**, it controls which ASCII elevated
    file to use, when the ASCIIELEV instruction is included in the
    `REPCONFIG`{.envar} file. If the first letter of this setting is an
    "[m]{.quote}" (for mole), then **Smkreport** opens the
    `ELEVTS_L`{.envar} file to use in the report; otherwise,
    **Smkreport** opens and uses the `ELEVTS_S`{.envar} file. This
    setting does not do anything to the behavior of **Smkreport** unless
    the ASCIIELEV setting is included in the `REPCONFIG`{.envar} file.
    The default setting of `MRG_GRDOUT_UNIT`{.envar} results in the
    `ELEVTS_S`{.envar} file being used by **Smkreport**.

-   `REPORT_ZERO_VALUES`{.envar}: \[default: N\]

    Determines if **Smkreport** should keep report entries whose data
    values are all zero

    ::: {.itemizedlist}
    -   Y: Print entries whose values are zero

    -   N: Do not print entries whose values are zero
    :::
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e33484}7.2.3.3. Output Files {#output-files .title}

</div>

</div>
:::

::: {.informaltable}
  File Name             Format   Description
  --------------------- -------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  `LOGFILE`{.envar}     ASCII    Log generated from executing **Smkreport**
  `REPORT[#]`{.envar}   ASCII    Multiple ASCII reports. **Smkreport** will output file names of `REPORT1`{.envar}, `REPORT2`{.envar}, `REPORT3`{.envar}, etc., if no other file names are given with the /NEWFILE/ instruction (see the `REPCONFIG`{.envar} file documentation in [Section 7.3, "`REPCONFIG`{.envar} Input File"](ch07s03.html "7.3. REPCONFIG Input File")). If the /NEWFILE/ instructions include physical file names, **Smkreport** will open those files. If the /NEWFILE/ instructions include logical file names (`REPORT1`{.envar}, etc.), **Smkreport** will attempt to find the value of the logical file name in the run-time UNIX shell environment. It the logical file name is defined, **Smkreport** will open the physical file associated with the logical file name; otherwise **Smkreport** opens a physical file with the same name as the logical file name.
:::
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  -------------------------- -------------------- --------------------------------------
  [Prev](ch07s02s02.html)     [Up](ch07s02.html)                    [Next](ch07s03.html)
  7.2.2. Processing Order     [Home](index.html)     7.3. `REPCONFIG`{.envar} Input File
  -------------------------- -------------------- --------------------------------------
:::
::: {.navheader}
7.3. `REPCONFIG`{.envar} Input File
:::

[Prev](ch07s02s03.html) 

Chapter 7. SMOKE Quality Assurance

 [Next](ch07s03s02.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

[]{#sect_qa_repconfig}7.3. `REPCONFIG`{.envar} Input File {#repconfig-input-file .title style="clear: both"}
---------------------------------------------------------

</div>

</div>
:::

::: {.toc}
[[7.3.1. One-time
section](ch07s03.html#sect_qa_repconfig_one_time)]{.section}

[[7.3.2. Define-group section](ch07s03s02.html)]{.section}

[[7.3.3. Create-report Section](ch07s03s03.html)]{.section}

[[7.3.4. The /DELIMITER/ packet](ch07s03s04.html)]{.section}

[[7.3.5. The /SET LABEL/ packet](ch07s03s05.html)]{.section}

[[7.3.6. The /REPORT TIME/ packet](ch07s03s06.html)]{.section}

[[7.3.7. The /AVEDAY/ packet](ch07s03s07.html)]{.section}

[[7.3.8. The /NEWFILE/ packet](ch07s03s08.html)]{.section}
:::

The `REPCONFIG`{.envar} file is used to control the **Smkreport**
program. As noted earlier, each run of **Smkreport** is constrained to a
single source category (area, mobile, or point), at most one speciation
scenario, at most one grid, and at most one hourly emissions file. All
of these component datasets are optional, however, and their use is
controlled by the settings in `REPCONFIG`{.envar}. This file also
controls the number and types of reports created by **Smkreport**, which
can create an unlimited number of reports in each program run.

The file works on the principles of "[packets]{.quote}" and
"[instructions]{.quote}". Packets are groups of instructions or a single
action that have been predefined by the `REPCONFIG`{.envar} file format
to control the **Smkreport** outputs; instructions are settings that
tell **Smkreport** what to do. Some types of packets must appear in one
of three sections, while other packets can appear anywhere in the
`REPCONFIG`{.envar} file. The three sections are: "[One-time]{.quote}"
(see [Section 7.3.1, "One-time
section"](ch07s03.html#sect_qa_repconfig_one_time "7.3.1. One-time section")),
"[Define-group]{.quote}" (see [Section 7.3.2, "Define-group
section"](ch07s03s02.html "7.3.2. Define-group section")), and
"[Create-report]{.quote}" (see [Section 7.3.3, "Create-report
Section"](ch07s03s03.html "7.3.3. Create-report Section")); each file
section has a large number of options. In this section of the chapter,
we first provide details on these three file sections and their packets,
and then we describe four additional packets that can appear between
other packets at any point in the `REPCONFIG`{.envar} file.

The full list of packets that one can use in the `REPCONFIG`{.envar}
input file are as follows:

One-time section ([Section 7.3.1, "One-time
section"](ch07s03.html#sect_qa_repconfig_one_time "7.3.1. One-time section"))

::: {.itemizedlist}
-   SMK\_SOURCE
:::

Define-group section ([Section 7.3.2, "Define-group
section"](ch07s03s02.html "7.3.2. Define-group section"))

::: {.itemizedlist}
-   /DEFINE GROUP REGION/

-   /DEFINE SUBGRID/
:::

Create-report section ([Section 7.3.3, "Create-report
Section"](ch07s03s03.html "7.3.3. Create-report Section"))

::: {.itemizedlist}
-   /CREATE REPORT/
:::

Packets that can appear anywhere in the file

::: {.itemizedlist}
-   /DELIMITER/ ([Section 7.3.4, "The /DELIMITER/
    packet"](ch07s03s04.html "7.3.4. The /DELIMITER/ packet"))

-   /AVEDAY/ ([Section 7.3.7, "The /AVEDAY/
    packet"](ch07s03s07.html "7.3.7. The /AVEDAY/ packet"))

-   /REPORT TIME/ ([Section 7.3.6, "The /REPORT TIME/
    packet"](ch07s03s06.html "7.3.6. The /REPORT TIME/ packet"))

-   /NEWFILE/ ([Section 7.3.8, "The /NEWFILE/
    packet"](ch07s03s08.html "7.3.8. The /NEWFILE/ packet"))

-   /SET LABEL/ ([Section 7.3.5, "The /SET LABEL/
    packet"](ch07s03s05.html "7.3.5. The /SET LABEL/ packet"))
:::

Comments can be put in the file using a pound sign (\#) at the first
column of a line, or a double pound sign (\#\#) anywhere else on a line.
The double pound can appear after packet labels or instructions in the
file.

Finally, note that the maximum number of characters that can be read on
any line in this file is 300. This can be important in particular for
the SELECT DATA instruction.

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_qa_repconfig_one_time}7.3.1. One-time section {#one-time-section .title}

</div>

</div>
:::

The first section of the file is the One-time section, and it is a
required section. This section is used for setting the environment
variables that control **Smkreport** for all reports in a given run. The
variables are set by listing the environment variable as an instruction,
followed by its value. No **setenv** command (used in the C shell) is
needed, because SMOKE is interpreting these values directly. At this
time, the one instruction available in the One-time section is the
SMK\_SOURCE variable:

`SMK_SOURCE`{.envar}: Set as "[A]{.quote}", "[M]{.quote}", or
"[P]{.quote}", for area-source reporting, mobile-source reporting, and
point-source reporting, respectively.

An example of the way this setting would appear in the
`REPCONFIG`{.envar} file is the following:

``` {.programlisting}
SMK_SOURCE   A
```
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  ----------------------------------------- -------------------- ------------------------------
  [Prev](ch07s02s03.html)                     [Up](ch07.html)           [Next](ch07s03s02.html)
  7.2.3. Files and Environment Variables     [Home](index.html)     7.3.2. Define-group section
  ----------------------------------------- -------------------- ------------------------------
:::
::: {.navheader}
7.3.2. Define-group section
:::

[Prev](ch07s03.html) 

7.3. `REPCONFIG`{.envar} Input File

 [Next](ch07s03s03.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_qa_repconfig_define_group}7.3.2. Define-group section {#define-group-section .title}

</div>

</div>
:::

::: {.toc}
[[7.3.2.1. /DEFINE GROUP REGION/
packet](ch07s03s02.html#d0e33714)]{.section}

[[7.3.2.2. /DEFINE SUBGRID/ packet](ch07s03s02.html#d0e33735)]{.section}

[[7.3.2.3. Group labels](ch07s03s02.html#d0e33774)]{.section}

[[7.3.2.4. INCLUDE and EXCLUDE
instructions](ch07s03s02.html#d0e33779)]{.section}

[[7.3.2.5. Future grouping options](ch07s03s02.html#d0e33827)]{.section}
:::

The second section of the `REPCONFIG`{.envar} file is the Define-group
section. This optional section is used for defining groups of source
characteristics for use later in the Create-reports section. The
Define-group section uses packets for defining groups. There are
currently two types of groupings, and therefore two packet types for
this section: regions and subgrids.

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e33714}7.3.2.1. /DEFINE GROUP REGION/ packet {#define-group-region-packet .title}

</div>

</div>
:::

The /DEFINE GROUP REGION/ packet is used for defining groups by the
country, state, and county codes in the inventory. The packet contains
the following entries.

::: {.itemizedlist}
-   /DEFINE GROUP REGION/ \<Label\>

    Must appear to start the packet. A label (see below) is required for
    naming the group.

-   INCLUDE and/or EXCLUDE instruction(s) (see below). These are
    optional.

    Country, state, and county codes in format NSSCCC, where N is the
    country number, SS is the state code, and CCC is the county code.
    Zeros can be used in place of CCC to select all counties in a state,
    or in place of SSCCC to select all counties and states in a country.

-   /END/

    Must appear to end the packet.
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e33735}7.3.2.2. /DEFINE SUBGRID/ packet {#define-subgrid-packet .title}

</div>

</div>
:::

The /DEFINE SUBGRID/ packet is used for defining subdomains based on
cell numbers from the full grid being applied using the gridding
matrices. The packet contains the following entries.

::: {.itemizedlist}
-   /DEFINE SUBGRID/ \<Label\>

    Must appear to start the packet. A label (see below) is required for
    naming the subgrid.

-   INCLUDE and/or EXCLUDE instruction(s) (see below) These are
    optional.

    (X cell, Y cell):

    Cell numbers should appear for all cells in the subgrid. The count
    (i.e. the x-cell count and the y-cell count) of the cells depends on
    the grid defined by the gridding matrix being used by **Smkreport**.
    A range can be given with the following syntax:

    (X cell, Y cell) TO (X cell, Y cell)

    If only one cell is to be specified, the range must still appear,
    with both entries indicating the same cell.

    **Smkreport** is not very sensitive to the spacing of this
    instruction, and additional spaces or no spaces may be placed
    between the parentheses, the cell numbers, and the commas. Spaces
    around the "[TO]{.quote}" are recommended.

    The maximum width of these lines is 100 characters. Multiple entries
    of this type may appear in the packet, allowing for the grouping of
    spatially unconnected cells/regions or non-rectangular regions.

-   /END/

    Must appear to end the packet.
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e33774}7.3.2.3. Group labels {#group-labels .title}

</div>

</div>
:::

Group labels, denoted above by \<Label\>, are used to name a group for
identification when creating a report in the Create-report section. The
text appearing in the placeholder \<Label\> can be any alphanumeric
combination of characters up to 200 characters, including intervening
blanks. The text string (less trailing blanks) that occurs after /DEFINE
\.../ and before a comment (indicated with \#\#), is treated as the
group label. References to the group label in the Create-report section
do not have to be consistent in the case of the text; SMOKE will ignore
the case of the text, treating lower- and uppercase characters as if
they were the same.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e33779}7.3.2.4. INCLUDE and EXCLUDE instructions {#include-and-exclude-instructions .title}

</div>

</div>
:::

The INCLUDE and EXCLUDE instructions are used for defining the meaning
of the entries in the packet. If the INCLUDE instruction appears, then
**Smkreport** interprets the subsequent entries in the packet as
identifying records to [*include*]{.emphasis} in the output report(s).
On the other hand, if the EXCLUDE instruction appears, then
**Smkreport** interprets the subsequent entries in the packet as
identifying records to [*exclude*]{.emphasis} from the output report(s).
The INCLUDE and EXCLUDE instructions may appear in both the /DEFINE
GROUP REGION/ and /DEFINE SUBGRID/ packets. These instructions act as
toggle switches, and **Smkreport** will give a warning if a county
previously included is later excluded. All packet entries after an
instruction will be interpreted according to the instruction, until
another instruction is given, or until the packet ends. The INCLUDE
instruction is the default, so if neither instruction is given, SMOKE
will assume that the records in the packet are those to be only in the
report.

The ordering of INCLUDE or EXCLUDE instructions in a group definition
can change the meaning of the group definition. If INCLUDE is given
first, **Smkreport** will initialize the group to exclude all grid cells
and then proceed with interpreting the instructions. On the other hand,
if EXCLUDE is given first, **Smkreport** will initialize the group to
include all grid cells. Here is an example for a small 6-cell by 6-cell
grid, which shows how the order of the INCLUDE and EXCLUDE statements
changes the meaning of a group definition.

If the instructions are

``` {.programlisting}
/DEFINE SUBGRID/ Example subgrid
    INCLUDE
      (2,2) TO (6,6)
    EXCLUDE 
      (3,3) TO (5,5)
    INCLUDE 
      (4,4) TO (4,4)
/END/
```

then the following cells (shown in gray) will be selected:

::: {.informalfigure}
::: {.mediaobject}
![](images\qa\group_1_html.jpg)
:::
:::

If the instructions were rearranged to have the EXCLUDE statement first,
then the initialized status for all cells would be INCLUDE. The
additional INCLUDE statements are therefore unneeded, and the definition
of the group changes to the following:

::: {.informalfigure}
::: {.mediaobject}
![](images\qa\group_2_html.jpg)
:::
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e33827}7.3.2.5. Future grouping options {#future-grouping-options .title}

</div>

</div>
:::

As noted above, the `REPCONFIG`{.envar} file currently can have only two
possible groups in the Define-group section (regions and subgrids) In
the future, other types of groups could be permitted if a need for them
is identified:

::: {.itemizedlist}
-   /DEFINE GROUP SCC/: Permits user-defined SCC groups

-   /DEFINE GROUP PLANT/ Permits user-defined groups by
    country/state/county code and plant ID

-   /DEFINE GROUP STACK/ Permits user-define groups by
    country/state/county code, plant ID, and stack ID

-   /DEFINE GROUP POINT/ / Permits user-define groups by
    country/state/county code, plant ID, stack ID, and point ID

-   /DEFINE GROUP SOURCE/: Permits user-defined source groups by SMOKE
    source ID

-   /DEFINE GROUP HOURS/: Permits user-defined hour groupings
:::
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  -------------------------------------- -------------------- -------------------------------
  [Prev](ch07s03.html)                    [Up](ch07s03.html)          [Next](ch07s03s03.html)
  7.3. `REPCONFIG`{.envar} Input File     [Home](index.html)     7.3.3. Create-report Section
  -------------------------------------- -------------------- -------------------------------
:::
::: {.navheader}
7.3.3. Create-report Section
:::

[Prev](ch07s03s02.html) 

7.3. `REPCONFIG`{.envar} Input File

 [Next](ch07s03s04.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_qa_repconfig_create_report}7.3.3. Create-report Section {#create-report-section .title}

</div>

</div>
:::

::: {.toc}
[[7.3.3.1. AERMOD instruction](ch07s03s03.html#d0e33902)]{.section}

[[7.3.3.2. ARRANGE instruction](ch07s03s03.html#d0e33931)]{.section}

[[7.3.3.3. ASCIIELEV instruction](ch07s03s03.html#d0e34020)]{.section}

[[7.3.3.4. BY instruction](ch07s03s03.html#d0e34088)]{.section}

[[7.3.3.5. CONTROL instruction](ch07s03s03.html#d0e34328)]{.section}

[[7.3.3.6. CROSSWALK instruction](ch07s03s03.html#d0e34336)]{.section}

[[7.3.3.7. GRIDDING instruction](ch07s03s03.html#d0e34349)]{.section}

[[7.3.3.8. LAYFRAC instruction](ch07s03s03.html#d0e34366)]{.section}

[[7.3.3.9. NORMALIZE instruction](ch07s03s03.html#d0e34386)]{.section}

[[7.3.3.10. NUMBER instruction](ch07s03s03.html#d0e34488)]{.section}

[[7.3.3.11. PROJECTION instruction](ch07s03s03.html#d0e34514)]{.section}

[[7.3.3.12. SELECT instruction](ch07s03s03.html#d0e34519)]{.section}

[[7.3.3.13. SPECIATION instruction](ch07s03s03.html#d0e34622)]{.section}

[[7.3.3.14. TEMPORAL instruction](ch07s03s03.html#d0e34640)]{.section}

[[7.3.3.15. TITLE instruction](ch07s03s03.html#d0e34683)]{.section}

[[7.3.3.16. UNITS instruction](ch07s03s03.html#d0e34693)]{.section}
:::

The third section of the `REPCONFIG`{.envar} file is called the
Create-report section. It is responsible for providing instructions to
**Smkreport** for generating the reports. The /CREATE REPORT/ packet is
used in this section. This packet uses the following types of
instructions (listed in alphabetical order):

::: {.itemizedlist}
-   ARRANGE
-   ASCIIELEV
-   BY
-   CONTROL
-   GRIDDING
-   LAYFRAC
-   NORMALIZE
-   NUMBER
-   PROJECTION
-   SELECT
-   SPECIATION
-   TEMPORAL
-   TITLE
-   UNITS
:::

By using these instructions (some of which have a number of different
options), many different types of outputs can be achieved by
**Smkreport**. The ordering of the instructions in the packet is not
important, [*with one exception*]{.emphasis}: if multiple titles are
used, they will be printed to the report in the order in which they
appear in the packet. The remainder of this subsection provides
descriptions of each of these instructions.

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e33902}7.3.3.1. AERMOD instruction {#aermod-instruction .title}

</div>

</div>
:::

The AERMOD instruction causes **Smkreport** to generate the customized
summary reports for [SMOKE4AERMOD post-processing
scripts](https://github.com/CEMPD/SMOKE/tree/master/scripts/aermod) that
create AERMOD helper input files. The report includes daily total
emissions by the grid cell, states, counties, SCC, temporal profiles
assignments, grid cell coordinates, and so on. The list of output
contents varies by the type of inventory source. For stationary point
sources, it will include a few additional variables, such as point
source facility ID, unit ID, release point ID, process ID, and stack
parameters (stack height, stack diameter, exit gas temperature and exit
gas velocity).

The syntax of the AERMOD instruction is:

AERMOD \<option 1\> \<option 2\>

with the following valid options:

::: {.itemizedlist}
-   option 1: There are two options. One is for stationary point sources
    \[ POINT \] and the other is for area sources \[ NONPOINT \].

-   option 2: This option 2 is only applicable when option 1 is defined
    as \[ POINT \]. PTEGU is designed for point sources with hourly CEM
    inventory dataset, and PTNONIPM is for the rest of stationary point
    sources.
:::

See the example:

::: {.itemizedlist}
-   AERMOD \[ POINT \| NONPOINT \] \[ PTEGU \| PTNONIPM \]
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e33931}7.3.3.2. ARRANGE instruction {#arrange-instruction .title}

</div>

</div>
:::

The ARRANGE instruction controls the arrangement of variables and files
for a single report. This instruction sets how many variables are
included in a report or a section of a report, and can set the number of
sections that a report will have. It also permits a database format that
includes an emissions data value for each record in the report.

If no ARRANGE instruction is provided for a report, **Smkreport** will
attempt to write all of the variables requested in the report to the
same file and section. If too many variables are requested in the
report, this could cause **Smkreport** to abort with an error. [*In
general, if you have more than 20 variables that will be written to a
given report, you should consider using the ARRANGE
instruction.*]{.emphasis}

The syntax of the ARRANGE instruction is:

ARRANGE \<option\>

with the following valid options:

::: {.itemizedlist}
-   MULTIFILE \[[*number of variables*]{.emphasis}\]: Writes the report
    into multiple output files. This is different from the **Smkreport**
    capability of creating multiple reports: the instruction applies to
    a single report and indicates that the report should be output as
    multiple files. The file names in this case are created
    automatically by **Smkreport** based on the file name set by the
    associated NEWFILE instruction (explained in [Section 7.3.8, "The
    /NEWFILE/ packet"](ch07s03s08.html "7.3.8. The /NEWFILE/ packet")),
    by appending a "[\_1]{.quote}", "[\_2]{.quote}", "[\_3]{.quote}",
    and so forth to the file name that would otherwise be output by
    **Smkreport**. For example, if the output report setting
    `REPORT1`{.envar} is defined as
    `/outdir/test/report1.myfile.txt`{.filename}, but that report
    requires two files, then the actual files that would be written
    would be `/outdir/test/report1.myfile.txt_1`{.filename} and
    `/outdir/test/report1.myfile.txt_2`{.filename}.

    The [*number of variables*]{.emphasis} option controls the number of
    variables written to each file of the report. For example, if the
    report will include 100 variables and the number of variables is set
    to 15, then **Smkreport** will create a report using seven separate
    files, six that include 15 variables (taking care of the first 90
    variables) and a seventh file that has the remaining 10 variables.
    [***Smkreport** allows a maximum of 30 variables per file using the
    MULTIFILE instruction.*]{.emphasis}

-   ONEFILE \[[*number of variables*]{.emphasis}\]: Writes the report
    into a single output file with multiple sections. Like the MULTIFILE
    option, this is different from the **Smkreport** capability of
    creating multiple reports: the instruction applies to a single
    report, but permits multiple sections of the report to be written to
    the same file.

    The [*number of variables*]{.emphasis} option controls the number of
    variables written to each section of the report. The number of
    sections is set automatically by dividing the number of data
    variables selected for the report by the number of variables.

-   DATABASE: Writes the report one variable at a time, with only one
    data variable on each row of the report. The attributes of the row
    are repeated for all variables, and all entries are written for one
    variable before the next variable is written. For example, if a
    report BY SCC10 is requested for the variables NOX and SO2, the
    report will list all SCCs with the NOX emissions as a data variable,
    followed by all SCCs again with SO2 emissions. Without the DATABASE
    instruction, the NOX and SO2 values would be written to the same
    line of the report and the SCC codes would be written only once.
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34020}7.3.3.3. ASCIIELEV instruction {#asciielev-instruction .title}

</div>

</div>
:::

The ASCIIELEV instruction causes **Smkreport** to use the elevated ASCII
emissions file (`ELEVTS_L`{.envar} or `ELEVTS_S`{.envar}) written by
**Smkmerge** as the sole source for emissions information in the report.
This option can be used only for point sources (SMK\_SOURCE is set to
P). When this option is included in a `REPCONFIG`{.envar} file, all
other reports in the `REPCONFIG`{.envar} file must also include the
ASCIIELEV instruction, or **Smkreport** will produce an error.

Using this instruction, **Smkreport** will use the emissions in the
`ELEVTS_S`{.envar} or `ELEVTS_L`{.envar} file as the sole source of
emissions and inventory information. These files include information
about the states, counties, plants, stacks, stack parameters, hour, cell
number, and speciated emissions. Therefore, only certain instructions
may be used with the ASCIIELEV instruction, or else a warning will be
printed to the log file and the unusable instruction will be ignored.
The following subset of /CREATE REPORT/ instructions can be used with
the ASCIIELEV instruction:

::: {.itemizedlist}
-   ARRANGE
-   BY \<COUNTRY \| STATE \| COUNTY \| CELL \| ELEVSTAT \| HOUR \| PLANT
    \| SOURCE \| STACK\>; other BY options will be ignored
-   NORMALIZE
-   NUMBER
-   SELECT
-   TITLE
-   UNITS
:::

The following instructions are implied by the ASCIIELEV instruction:

::: {.itemizedlist}
-   CONTROL (implied only if the emissions in the elevated ASCII file
    are controlled)
-   GRIDDING
-   PROJECTION (implied only if the emissions in the elevated ASCII file
    are grown)
-   SPECIATION \[MASS\|MOLE\] (which option is used depends on the
    `MRG_GRDOUT_UNIT`{.envar} setting, described below)
-   TEMPORAL
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34088}7.3.3.4. BY instruction {#by-instruction .title}

</div>

</div>
:::

The BY instruction controls what columns in addition to data columns
will be printed in the output report. Multiple BY commands may appear in
the same /CREATE REPORT/ packet, but not all combinations make sense.
The BY instructions tell the program the basis on which to sum the
emissions or activity values. The syntax of the BY instruction is:

BY \<option\>

with the following valid options:

::: {.itemizedlist}
-   CELL: Records are printed by cell. This option requires the GRIDDING
    instruction, so **Smkreport** automatically adds the GRIDDING
    instruction when the BY CELL instruction is used (even if it is not
    actually in the `REPCONFIG`{.envar} file).

-   COUNTRY \[NAME\]: Records are printed by country total. This option
    invokes use of the `COSTCY`{.envar} file. NAME can be appended to
    the option to additionally output the country name instead of only
    the country number.

-   COUNTY \[NAME\]: Records are printed by county total. This option
    invokes use of the `COSTCY`{.envar} file. NAME can be appended to
    the option to additionally output the county name instead of only
    the county number.

-   DOMCODE: Records are printed by Day of Month profile code. This
    option will work correctly only when monthly temporal profiles have
    not been applied by pollutant.

-   ELEVSTAT \[STACKGROUP\]: Records include the status of sources as
    elevated (E), plume-in-grid (P), and low-level (L). All elevated
    statuses could appear in the same report, depending on the inventory
    and elevated source selection criteria. `STACKGROUP`{.envar} can be
    appended to the option to additionally output stack group number
    from `PELV`{.envar}. This instruction can be used for point sources
    only.

-   FRICODE: Records are printed by Friday diurnal profile code. This
    option will work correctly only when monthly temporal profiles have
    not been applied by pollutant.

-   GEOCODE\_LEVEL1: Records are printed by the Country-level geographic
    code.

-   GEOCODE\_LEVEL2: Records are printed by the State-level geographic
    code.

-   GEOCODE\_LEVEL3: Records are printed by the County-level geographic
    code.

-   GEOCODE\_LEVEL4: Records are printed by the Tribal-level geographic
    code.

-   HOUR: Records are printed by hour total for each day. This option
    implies the TEMPORAL instruction, so **Smkreport** automatically
    adds that instruction even if it was not included in the input.

-   INTEGRATE: Records are printed by the integration status of sources.
    "[Y]{.quote}" willl appear for the integrated sources that were used
    to calculate the NONHAP\[VOC\|TOG\] inventory pollutant.

-   LAYER: For point sources, daily emissions are printed by vertical
    layer. This option implies the LAYFRAC option (discussed later) that
    requires input of the `PLAY`{.envar} SMOKE intermediate file. In the
    report, records are written first for one layer, then the next, and
    so on. [Only records with nonzero emissions in a layer are
    written.]{.remark} When used to together with the HOUR instruction
    (above), emissions will be written by hour as well as by layer.
    Since the number of records the report when using HOUR instruction
    is very large, we recommend that a source group be used to subselect
    the inventory records when appropriate.

-   MACT \[NAME\]: Records are printed by MACT code. NAME can be
    appended to the option to additionally output the MACT code
    description (from the `MACTDESC`{.envar} file) instead of only the
    MACT code.

-   MATBURNED: For wildfire point sources, records are printed by
    MATBURNED code.

-   METCODE: Records are printed by Meteorology-based hourly profile
    code. This option will work correctly only when monthly temporal
    profiles have not been applied by pollutant.

-   MONCODE: Records are printed by Mothly profile code. This option
    will work correctly only when monthly temporal profiles have not
    been applied by pollutant.

-   MNDCODE: Records are printed by Monday diurnal profile code. This
    option will work correctly only when monthly temporal profiles have
    not been applied by pollutant.

-   NFDRSCODE: For wildfire point sources, records are printed by
    NFDRSCODE code.

-   NAICS \[NAME\]: Records are printed by NAICS code. NAME can be
    appended to the option to additional output the NAICS code
    description (from the `NAICSDESC`{.envar} file) instead of only the
    NAICS code.

-   ORIS \[NAME\]: Records are printed by ORIS ID code. NAME can be
    appended to the option to additional output the ORIS ID code
    description (from the `ORISDESC`{.envar} file) instead of only the
    ORIS ID code.

-   PLANT \[NAME\]: For point sources, emissions are printed by plant
    total. This option cannot be used in conjunction with the BY SOURCE
    option; if the `REPCONFIG`{.envar} file contains both instructions,
    SMOKE will ignore the BY PLANT instruction.

    When the NAME option is included, the plant name will be included in
    the report. Otherwise, only the plant number will be included.

-   ROADCLASS: Records are printed by road class total. This option can
    only be used for mobile sources.

-   SATCODE: Records are printed by Saturday diurnal profile code. This
    option will work correctly only when monthly temporal profiles have
    not been applied by pollutant.

-   SCC \[N\] \[NAME\]: Records are printed and summed by all or part of
    the SCC, depending on the value of N, which can be set to 1, 2, 3,
    or 4. These numbers correspond to the SCC levels described in
    [Section 2.3.5, "Source Classification
    Codes"](ch02s03s05.html "2.3.5. Source Classification Codes"). When
    N = 4, the full SCC is used. When N = 1, 2, or 3, the records are
    summed and reported by the corresponding SCC level. Differences
    between point and nonpoint/mobile SCCs are handled as described by
    the SCC structures. If no value is given. N is assumed to be 4 by
    default.

    The NAME option can be used for any N value. The SCC description is
    truncated assuming that semicolons separate the different parts of
    the SCC descriptions. If there are more than 3 semicolons in an SCC
    description (dividing into 4 parts), then all of the SCC sections
    after part 3 are put into part 4. The SCC description written by
    **Smkreport** will match the value of N by including all parts of
    the SCC description up to and including the value of N.

-   SCC10 \[NAME\]: This option maintains backward compatibility with
    previous versions of **Smkreport**. It is the same as the option
    \"SCC 4 \[NAME\]\".

-   SIC \[NAME\]: Records are printed by SIC totals.

    When the "[NAME]{.quote}" option is included, the SIC name will be
    included in the report. Otherwise, only the SIC code will be
    included. As with the BY SCC10 NAME instruction, the BY SIC NAME
    instruction will change the column delimiter from a semi-colon to
    the pipe symbol ("[\|]{.quote}"). The SIC name will also be enclosed
    in double quotes.

-   SOURCE \[STACKPARM\] \[NAME\] \[LATLON\]: Records are printed by
    source totals. Source characteristics are printed as well:

    ::: {.itemizedlist}
    -   Point: country/state/county code, plant ID, stack ID, point ID,
        segment ID, SCC, and SIC
    -   Area: country/state/county code and SCC
    -   Mobile: country/state/county code, road type code, vehicle type
        code, link ID, and SCC
    :::

    For area and mobile sources, the SCC descriptions will automatically
    be included in the report. This is the same as adding the "[BY SCC10
    NAME]{.quote}" instruction to the report instructions. There is no
    way to turn off this feature.

    For point sources, STACKPARM can be appended to the option to also
    output the stack parameters (height, diameter, exit velocity, exit
    temperature). Also for point sources, NAME can be appended to the
    option to get the facility names in the output file. LATLON can be
    appended to the option to print each source's x- and y-coordinates.

-   SPCCODE \<POLLUTANT\>: Records are printed by speciation profile
    codes assigned to sources by the speciation cross-reference file.
    [*Only one pollutant can appear with this command throughout the
    entire `REPCONFIG`{.envar} file.*]{.emphasis} The pollutant should
    be one that is in the inventory file and that was processed as part
    of the chemical speciation file run. This BY option does not imply
    the SPECIATION instruction (see below), and it can be used without
    included speciated emissions in the report. For example, the BY
    SPCCODE instruction may be used to indicate which speciation
    profiles were assigned to total VOC emissions (without reporting
    speciated VOC emissions). [**NOTE: this BY SPCCODE option can\'t be
    used more than once in a REPCONFIG file.**]{.bold}

-   SRCTYPE: Records are printed by source type code.

-   SRGCODE \[FALLBACK\]: Records are printed by surrogate codes
    assigned to sources by the gridding cross-reference file. If no
    option is used, both primary and fallback surrogate codes are
    included in the output report. If the FALLBACK option is used, only
    the fallback surrogate codes are included in the output report, and
    a zero is used for all records that did not use a fallback surrogate
    (i.e., their primary surrogate did not cause emissions to go to
    zero). This BY option does not imply the GRIDDING instruction (see
    below); therefore, it can be used without applying the gridding
    matrix in the report. A value of -9 is used for fallback surrogate
    IDs in the resulting report.

-   STATE \[NAME\]: Records are printed by state totals. This option
    invokes the use of the `COSTCY`{.envar} file. NAME can be appended
    to the option to additionally output the state name instead of only
    the state number.

-   SUNCODE: Records are printed by Sunday diurnal profile code. This
    option will work correctly only when monthly temporal profiles have
    not been applied by pollutant.

-   THUCODE: Records are printed by Thursday diurnal profile code. This
    option will work correctly only when monthly temporal profiles have
    not been applied by pollutant.

-   TUECODE: Records are printed by Tuesday diurnal profile code. This
    option will work correctly only when monthly temporal profiles have
    not been applied by pollutant.

-   WEKCODE: Records are printed by Weekly profile code. This option
    will work correctly only when monthly temporal profiles have not
    been applied by pollutant. Note that this option spelling is
    [*not*]{.emphasis} WEEKCODE.

-   WEDCODE: Records are printed by Wednesday diurnal profile code. This
    option will work correctly only when monthly temporal profiles have
    not been applied by pollutant.
:::

The most detailed BY instruction will determine the resolution of the
emissions and activity totals. For example, the COUNTRY, STATE, and
COUNTY options can be used in the same report to affect the column
headers, but the data output will not be different because the emissions
totals will be at the finest resolution specified. In other words, if
the instructs are to report BY COUNTY and BY STATE, the emission totals
in that report will be by county, and the BY STATE instruction will
merely add the state code to the columns printed. Another example is
that the BY SCC10 instruction will override the resolution of BY
ROADCLASS.

Future versions of the BY command may support the following options, if
a need for them is identified by SMOKE users:

::: {.itemizedlist}
-   STACK \[NAME\]: For point sources only, records are printed as
    facility and stack totals. NAME can be appended to the option to get
    the facility names in the output file.

-   POINT \[NAME\]: For point sources only, records are printed as
    facility, stack, and point totals. NAME can be appended to the
    option to get the facility names in the output file.

-   VTYPE: For mobile sources only, records are printed as vehicle-type
    totals.

-   GROUP \<option\>: Records are printed based on the user-defined
    groups, with the following options:

    ::: {.itemizedlist}
    -   REGION: Rows in report are user-defined region groups.
    -   SCC: Rows in report are user-defined SCC groups.
    -   SOURCE: Rows in report are user-defined source groups, by SMOKE
        record number.
    -   HOURS: Rows in report are user-defined hour groups.
    :::
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34328}7.3.3.5. CONTROL instruction {#control-instruction .title}

</div>

</div>
:::

The CONTROL instruction applies the multiplicative control matrix to all
pollutants and species requested in the report. This instruction does
not limit the options available for resolution of the report, so reports
that have the CONTROL instruction can also include any combination of BY
instructions. **Smkreport** is unable to apply the reactivity control
matrix at this time.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34336}7.3.3.6. CROSSWALK instruction {#crosswalk-instruction .title}

</div>

</div>
:::

The CROSSWALK instruction allows users to generate the crosswalk output
file that maps how the point inventory sources are grouped into the
output source for a single report. This option is only limited to
stationary point sources (SMK\_SOURCE is set to P). The file names in
this case are created automatically by **Smkreport** based on the file
name set by the associated NEWFILE instruction (explained in
[Section 7.3.8, "The /NEWFILE/
packet"](ch07s03s08.html "7.3.8. The /NEWFILE/ packet")), by appending a
"[\_crosswalk]{.quote}".
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34349}7.3.3.7. GRIDDING instruction {#gridding-instruction .title}

</div>

</div>
:::

The GRIDDING instruction controls whether or not the gridding matrix is
used by **Smkreport**. When the instruction is present, the gridding
matrix is used in generating the report; the matrix is applied to the
emissions before the totals are made. The gridding matrix file name is
determined by the environment variables set at run time. One use of the
GRIDDING instruction would be the following: a report could be generated
without GRIDDING to see emission totals before gridding, and another
report could be generated with GRIDDING to see the totals after
gridding. The totals from the two reports could be compared to see if
any emissions were lost because of the gridding step.

The GRIDDING instruction is assumed when any of the following other
instructions appear in the packet:

::: {.itemizedlist}
-   SELECT SUBGRID
-   BY CELL
-   NORMALIZE CELLAREA
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34366}7.3.3.8. LAYFRAC instruction {#layfrac-instruction .title}

</div>

</div>
:::

The LAYFRAC instruction controls whether or not the point source layer
fractions file (`PLAY`{.envar}) from the **Laypoint** program is used in
determining elevated and low-level sources. If the `PLAY`{.envar} file
is not used for determining elevated sources, the `PELV`{.envar} file
from the **Elevpoint** program will be required.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34386}7.3.3.9. NORMALIZE instruction {#normalize-instruction .title}

</div>

</div>
:::

The NORMALIZE instruction controls whether or not the emission values
will be normalized using some other data value. Two normalize options
are currently supported; CELLAREA and POPULATION. Emissions
normalization can provide additional insight to the inventory, more than
can be obtained by simply summarizing emissions values.

The syntax of the NORMALIZE instruction is:

NORMALIZE \<option\>

with the following valid options:

::: {.itemizedlist}
-   CELLAREA: Normalize emissions based on grid cell area. When the
    emissions are normalized by cell area, they are divided by the area
    of each cell (or just the cells selected, if a subgrid is used).
    Normalizing by grid cell area is useful for comparing emission
    reports from grids at different resolutions, including nested grids,
    to ensure that a consistent emissions density is maintained across
    the multiple grid resolutions.

    For Lambert and UTM grids, the cell ares are computed using the
    formula:

    [*DX*]{.emphasis} \* [*DY*]{.emphasis}

    where

    ::: {.itemizedlist}
    -   [*DX*]{.emphasis} is the cell x-direction size in meters
    -   [*DY*]{.emphasis} is the cell y-direction size in meters
    :::

    For lat-lon grids, the area of the lat-lon cell are estimated using
    the formula:

    (cos [*Y*]{.emphasis})\*( π \* [*DX*]{.emphasis} \* [*R*]{.emphasis}
    / 180 )\*( π \* [*DY*]{.emphasis} \* [*R*]{.emphasis} / 180 )

    where

    ::: {.itemizedlist}
    -   [*DX*]{.emphasis} is the cell x-direction size in degrees
        longitude
    -   [*DY*]{.emphasis} is the cell y-direction size in degrees
        latitude
    -   [*Y*]{.emphasis} is the cell center in degrees latitude
    -   [*R*]{.emphasis} is the radius of the earth in meters
    :::

    [The NORMALIZE CELLAREA command cannot be used with polar
    stereographic grids at this time.]{.remark}

    This instruction requires that the GRIDDING instruction also be
    used, because the gridding information is needed in order to
    normalize the emissions by grid area. If the GRIDDING instruction is
    left out of the report instructions, **Smkreport** will add it to
    the report and continue.

-   POPULATION: Normalize emission based on county population. Emissions
    in the report are divided by county population, regardless of
    whether the BY COUNTY instruction has been used in the report
    instructions.

    This option requires that the `COSTCY`{.envar} input file to
    **Smkreport** include an additional field and a \#POPULATION header
    (as is described in the `COSTCY`{.envar} documentation in
    [Chapter 8, *SMOKE Input
    Files*](ch08.html "Chapter 8. SMOKE Input Files")).
:::

Future versions of the NORMALIZE instruction may support the following
option, if a need for this option is identified by SMOKE users:

::: {.itemizedlist}
-   NORMALIZE COUNTYAREA: Normalize emissions based on county area.
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34488}7.3.3.10. NUMBER instruction {#number-instruction .title}

</div>

</div>
:::

The NUMBER instruction controls the format used to display [*data
values*]{.emphasis} in the report. The argument for the number
instruction applies to all data values that are written to the report,
and the structure of the argument is simply the formats supported by
Fortran. The data values in the reports are rounded to the nearest value
allowed based on the format selected. A value of 5 is rounded up to the
next decimal place, when such rounded is needed.

The syntax of the NUMBER instruction is simply:

NUMBER \<format\>

where \<format\> is the Fortran format specification. The common formats
you might use are the following:

::: {.itemizedlist}
-   Float format: F\<x\>.\<y\>: where \<x\> is the number of digits for
    the number, including the decimal place, and \<y\> is the number of
    digits shown after the decimal place.

-   Exponential format: E\<x\>.\<y\>: where \<x\> is the complete width
    of the value, including five characters for "[E+00]{.quote}" and the
    decimal, and \<y\> is the number of significant figures.
:::

If the NUMBER instruction does not appear in the report instructions,
the E8.3 format is used.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34514}7.3.3.11. PROJECTION instruction {#projection-instruction .title}

</div>

</div>
:::

The PROJECTION instruction will apply the growth matrix to all
pollutants and species requested in the report. This instruction does
not limit the options available for resolution of the report, so reports
that have the PROJECTION instruction can also include any combination of
BY instructions.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34519}7.3.3.12. SELECT instruction {#select-instruction .title}

</div>

</div>
:::

The SELECT instruction controls which records in the inventory are used
in generating the report. It allows the user to extract particular
records from the inventory, for inclusion in the report. This
instruction also permits references to the groups defined in the
Define-groups section of the `REPCONFIG`{.envar} file. If no SELECT
instruction is used, then the other report instructions will be applied
to all records in the inventory. Only one SELECT statement of each type
is permitted in per report; for example, only one SELECT REGION
statement and one SELECT SUBGRID statement could be used for a single
report. Of course, different SELECT REGION or SELECT SUBGRID
instructions could be used for different reports in the same output
file.

The syntax of the command is:

SELECT \<options\> \<label\>

where \<label\> is an optional field, depending on the \<option\>
selected. The following options are available for the SELECT
instruction:

::: {.itemizedlist}
-   DATA \<label\>: Selects data values to include in the report. When
    no SELECT DATA instruction is used, all pollutants, activities, or
    species found in the input file(s) are reported. When species are
    being reported, the corresponding pollutants in the inventory or
    hourly emissions file are reported as well as the speciated emission
    values. The \<label\> must be a space-delimited list of pollutant,
    activity, or species names. Do not include the pollutant names in
    the list when species are listed, as these will be included by
    default.

    To specify a species value when the species name is the same as the
    pollutant name, an "[S]{.quote}" and a hyphen can be inserted before
    the species name. You can also use this method for specifying the
    sum of post-speciated emissions. For instance, to specify carbon
    monoxide after speciation, the SELECT instruction should be:

    SELECT DATA S-CO

    To specify the sum of VOC emissions after speciation, the SELECT
    instruction should be:

    SELECT DATA S-VOC

    [*Note that **Smkreport** does not determine whether the summation
    makes sense, and does not correct for species molecular
    weights.*]{.emphasis} You must ensure that the data you request
    makes sense.

    Also note that the maximum number of characters that can be read on
    any line in this file is 1024. This can limit the number of
    pollutants that you can specifically request in a SELECT DATA
    statement.

-   ELEVATED \[PING\]: Selects all elevated point sources (recognized
    for point sources only). If no elevated sources are found (after
    applying all other selection criteria), the report will contain a
    warning to that effect. If the PING option appears, only
    plume-in-grid sources will be selected. When the ELEVATED
    instruction is used by any report, the `PELV`{.envar} file (from
    **Elevpoint**) or `PLAY`{.envar} file (from **Laypoint**) will be
    required to determine which sources are elevated. The latter will be
    used when the LAYFRAC instruction is also included in the report
    instructions. If the PING option is used, the `PELV`{.envar} file
    will be required in all cases, although the LAYFRAC instruction can
    still be used to set the elevated source status based on the layer
    fractions.

-   NOELEVATED: Selects all low-level point sources (recognized for
    point sources only). If both the ELEVATED and NOELEVATED commands
    appear in the same report, a warning will be given, and the latter
    setting will be used to generate the report. If no low-level sources
    are found (after applying all other selection criteria), the report
    will contain a warning to this effect. The same rules apply for use
    of the `PELV`{.envar} or `PLAY`{.envar} files as described for the
    ELEVATED option.

-   REGION \<label\>: Selects a region using the country/state/county
    code or a region group. For this option, \<label\> must be either a
    country/state/county code in NSSCCC format, or a region group label
    from the Define-group section of the `REPCONFIG`{.envar} file.

-   SUBGRID \<label\>: Selects a subgrid using the grid cell numbers or
    a subgrid group label. For this option, \<label\> must be either a
    range of grid cells, or a subgrid label from the Define-group
    Section of the file. When the \<label\> defines the cell range, you
    should use the same syntax that was specified above for the /DEFINE
    SUBGRID/ packet. However, the INCLUDE setting is assumed, and
    **Smkreport** will not understand the INCLUDE and EXCLUDE commands
    as part of the \<label\>.

    For the REGION and SUBGRID options, the value of \<label\> must
    either match a group or subgrid label or match characteristics of
    the inventory or grid. Also, the \<label\> for the REGION and
    SUBGRID options must be 200 characters or fewer.
:::

Future versions of **Smkreport** may support the following additional
options, if a need is identified:

::: {.itemizedlist}
-   SCC \<label\>: Select a single SCC or SCC group for reporting.

-   PLANT \<label\>: Select a single point source plant, or a plant
    group for reporting.

-   STACK \<label\>: Select a single point source stack, or a stack
    group for reporting.

-   POINT \<label\>: Select a single point source point, or a point
    group for reporting.

-   HOURS \<label\>: Select a single hour or hour group for reporting.

-   SOURCE \<label\>: Select a single source or source group for
    reporting.
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34622}7.3.3.13. SPECIATION instruction {#speciation-instruction .title}

</div>

</div>
:::

The SPECIATION instruction controls whether the speciation matrix is
used by the program. This option controls the columns of data that will
be printed in the output file. When the SPECIATION instruction is in the
report instructions, the columns in the output file will include
speciated emissions values as well as inventory emissions from the SMOKE
inventory or hourly emissions file (depending on whether or not the
TEMPORAL instruction is used). When the SPECIATION instruction is not
used, the columns in the output file will be inventory emissions and/or
activities.

The syntax of the SPECIATION instruction is:

SPECIATION \<option\>

where the following options are supported

::: {.itemizedlist}
-   MOLE: Uses the mole-based speciation matrix.

-   MASS: Uses the mass-based speciation matrix.
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34640}7.3.3.14. TEMPORAL instruction {#temporal-instruction .title}

</div>

</div>
:::

The TEMPORAL instruction controls whether or not emission values are
used from the hourly emission files `ATMP`{.envar}, `MTMP`{.envar}, or
`PTMP`{.envar}. When this instruction is used, the default behavior of
**Smkreport** is to sum up the emissions by day and report emissions as
daily totals. To override this behavior, the BY HOUR instruction must be
used.

When dates and times are given in the report, the hours are reported in
the time zone from the `ATMP`{.envar}, `MTMP`{.envar}, or `PTMP`{.envar}
file. Hours are reported as [*standard*]{.emphasis} time values for the
time zone stored in the header of the hourly emissions file; hours are
never reported as [*daylight*]{.emphasis} time values.

The TEMPORAL instruction is assumed when either of the following options
appear in the report instructions:

::: {.itemizedlist}
-   SELECT HOURS
-   BY HOUR
:::

In the future, we may be able to enhance this instruction to permit the
reported hour values to be labeled with a different time zone than is in
the hourly emissions file.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34683}7.3.3.15. TITLE instruction {#title-instruction .title}

</div>

</div>
:::

The TITLE instruction allows one or more titles to be added to a report.
The titles are printed into the report in the order in which they appear
in the packet. Quotes are [*not*]{.emphasis} needed in titles with blank
spaces. The title will be ended at the last character on the line, or at
a double pound sign (\#\#), whichever appears first on the line. Double
pound signs cannot be printed in the titles of reports. It is
recommended that titles be 80 characters wide. The maximum title width
is 300 characters. The syntax of the TITLE instruction is the following:

TITLE \<title text\>
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34693}7.3.3.16. UNITS instruction {#units-instruction .title}

</div>

</div>
:::

The UNITS instruction allows you to control the units of the output
data. The current version of **Smkreport** does not permit you to vary
the units by data value; instead, the same units must be used for all
data values, or the default units will be used. Future versions of
**Smkreport** may permit control of the units by data variable.

All unit conversions that [*can*]{.emphasis} be done, will be done. For
example, if the inventory is stored in tons/hour, and the output is
requested in fathoms/day, the hour-to-day conversion will be made, while
the impossible tons-to-fathoms conversion will not be made. The syntax
of the UNITS instruction is the following:

UNITS ALL \<units\>

Valid values for the \<units\> option numerator are the following:

::: {.itemizedlist}
-   ton(s)
-   g, gm(s), gram(s)
-   kg(s)
-   mole(s), gm mole(s)
:::

Valid values for the \<units\> option denominator are the following:

::: {.itemizedlist}
-   year(s), yr(s)
-   day
-   hour(s), hr(s)
-   min(s)
-   day(s)
-   s, sec(s)
:::

No quotes are needed around the unit labels, and they must be 30
characters or fewer. Some examples of the units instruction are the
following:

``` {.programlisting}
UNITS ALL gm moles/s
UNITS ALL tons/hr
UNITS ALL kg/year
```
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  ------------------------------ -------------------- --------------------------------
  [Prev](ch07s03s02.html)         [Up](ch07s03.html)           [Next](ch07s03s04.html)
  7.3.2. Define-group section     [Home](index.html)     7.3.4. The /DELIMITER/ packet
  ------------------------------ -------------------- --------------------------------
:::
::: {.navheader}
7.3.4. The /DELIMITER/ packet
:::

[Prev](ch07s03s03.html) 

7.3. `REPCONFIG`{.envar} Input File

 [Next](ch07s03s05.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_qa_repconfig_delimiter}7.3.4. The /DELIMITER/ packet {#the-delimiter-packet .title}

</div>

</div>
:::

The /DELIMITER/ packet can be used to change the column delimiter used
in the output reports from **Smkreport**. The default delimiter is a
semicolon (;). You can change the delimiter to any single-character
value to suit your needs, although using a space as a delimiter may
result in slightly misformatted reports. Some reasons to change the
delimiter from the default are:

::: {.itemizedlist}
-   You are reporting "[BY SOURCE]{.quote}" and including the source
    name, and it has semicolons included in one or more of the names.
    This would prevent those records in the output report from being
    read into another program using semicolon as the delimeter.

-   Software you want to use to read the **Smkreport** output report
    does not support semi-colons for delimiters.

-   You prefer a different appearance in the reports; you can select
    another delimiter that does not conflict with other fields in your
    report.
:::

The syntax of this instruction is the following:

/DELIMITER/ ,

This example results in a comma (,) being used as the delimiter for
columns of any results from /CREATE REPORT/ instructions that followed
this instruction in the `REPCONFIG`{.envar} file.
:::

::: {.navfooter}

------------------------------------------------------------------------

  ------------------------------- -------------------- --------------------------------
  [Prev](ch07s03s03.html)          [Up](ch07s03.html)           [Next](ch07s03s05.html)
  7.3.3. Create-report Section     [Home](index.html)     7.3.5. The /SET LABEL/ packet
  ------------------------------- -------------------- --------------------------------
:::
::: {.navheader}
7.3.5. The /SET LABEL/ packet
:::

[Prev](ch07s03s04.html) 

7.3. `REPCONFIG`{.envar} Input File

 [Next](ch07s03s06.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_qa_repconfig_set_label}7.3.5. The /SET LABEL/ packet {#the-set-label-packet .title}

</div>

</div>
:::

The /SET LABEL/ packet can be used to set a label to include on every
row of every subsequent report defined in the `REPCONFIG`{.envar} file.
The label text can be either the text that appears in the packet, or the
label can be defined by an environment variable. This feature
facilitates combining multiple reports from separate SMOKE runs into a
single report more easily. For example, if the packet is used to create
state reports for all sectors run through SMOKE, then those state
reports could be concatenated, the file headers removed (except for the
first header), and the individual sectors would be idenfified by the
labels on the rows.

The syntax for the packet is as follows:

/SET LABEL/ \<label\>

where \<label\> is limited to 200 characters and is one of the
following:

::: {.itemizedlist}
-   a string of text that will appear near the beginning of every data
    line of the report. The only invalid string is the word \"OFF\" in
    capital letters.

    Example: /SET LABEL/ NonEGU Point

    In this example, all subsequent reports will contain a new column
    called \"Label\" and every value in the entire report will be
    \"NonEGU Point\".

-   an environment variable designated by \<label\> starting with a
    dollar sign.

    Example: /SET LABEL/ \$RUN\_ID

    In this example, **Smkreport** will attempt to evaluate the
    environment variable `RUN_ID`{.envar} from the shell running
    **Smkreport**. If `RUN_ID`{.envar} is a defined environment variable
    (e.g., the shell had set `RUN_ID`{.envar} to \"oarea\"), then all
    subsequent reports will contain a new column called \"Label\" and
    every value in the entire report will be \"oarea\".

    If the environment variable is not defined, set to blank, or
    otherwise invalid, the instruction will behave like the /SET LABEL/
    OFF case below.

-   the word \"OFF\".

    Example: /SET LABEL/ OFF

    This syntax turns off use of the label in all subsequent reports
    until a new valid /SET LABEL/ packet is found.
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  -------------------------------- -------------------- ----------------------------------
  [Prev](ch07s03s04.html)           [Up](ch07s03.html)             [Next](ch07s03s06.html)
  7.3.4. The /DELIMITER/ packet     [Home](index.html)     7.3.6. The /REPORT TIME/ packet
  -------------------------------- -------------------- ----------------------------------
:::
::: {.navheader}
7.3.6. The /REPORT TIME/ packet
:::

[Prev](ch07s03s05.html) 

7.3. `REPCONFIG`{.envar} Input File

 [Next](ch07s03s07.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_qa_repconfig_report_time}7.3.6. The /REPORT TIME/ packet {#the-report-time-packet .title}

</div>

</div>
:::

The /REPORT TIME/ packet can be used to change the hour value for which
daily-total hourly emissions are output. The syntax of this instruction
is the following:

/REPORT TIME/ \<HHMMSS\>

The setting uses HHMMSS format, in which HH is the hour and MMSS is
0000. The time specified is in the time zone of the input hourly data
file. This setting is ignored when hourly data are not input to
**Smkreport**. The default behavior of **Smkreport** is to report at the
last hour of the day, hour 23 (hours are counted from 0 to 23). This
setting must be consistent with the SMOKE intermediate files, which use
hour numbers 0 through 23 because they are based on the I/O API.
However, these hour numbers are different from those included in the
report because of the "[BY HOUR]{.quote}" instruction, which numbers the
hours 1 through 24.
:::

::: {.navfooter}

------------------------------------------------------------------------

  -------------------------------- -------------------- -----------------------------
  [Prev](ch07s03s05.html)           [Up](ch07s03.html)        [Next](ch07s03s07.html)
  7.3.5. The /SET LABEL/ packet     [Home](index.html)     7.3.7. The /AVEDAY/ packet
  -------------------------------- -------------------- -----------------------------
:::
::: {.navheader}
7.3.7. The /AVEDAY/ packet
:::

[Prev](ch07s03s06.html) 

7.3. `REPCONFIG`{.envar} Input File

 [Next](ch07s03s08.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_qa_repconfig_aveday}7.3.7. The /AVEDAY/ packet {#the-aveday-packet .title}

</div>

</div>
:::

The /AVEDAY/ packet can be used to toggle on or off the use of the
average-day emissions from the SMOKE inventory file. The syntax of the
command is the following:

/AVEDAY/ \<option\>

The \<option\> field can be set to Y or N. The default behavior of the
program (if no /AVEDAY/ packet appears) is to [*not*]{.emphasis} use the
average-day emissions in the reports. This packet only affects the
program [*only*]{.emphasis} when the inventory emission are being
reported. If the TEMPORAL instruction is given, the output report will
contain whatever emission values were used to create the hourly
emissions file.
:::

::: {.navfooter}

------------------------------------------------------------------------

  ---------------------------------- -------------------- ------------------------------
  [Prev](ch07s03s06.html)             [Up](ch07s03.html)         [Next](ch07s03s08.html)
  7.3.6. The /REPORT TIME/ packet     [Home](index.html)     7.3.8. The /NEWFILE/ packet
  ---------------------------------- -------------------- ------------------------------
:::
::: {.navheader}
7.3.8. The /NEWFILE/ packet
:::

[Prev](ch07s03s07.html) 

7.3. `REPCONFIG`{.envar} Input File

 [Next](ch07s04.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_qa_repconfig_newfile}7.3.8. The /NEWFILE/ packet {#the-newfile-packet .title}

</div>

</div>
:::

The /NEWFILE/ packet can be used before or between any /CREATE REPORT/
packets to cause **Smkreport** to write out the subsequent reports to a
different report file. The syntax of the command is the following:

/NEWFILE/ \<Filename\>

The placeholder \<Filename\> is replaced by either:

::: {.orderedlist}
1.  A physical file name, including the path.

2.  A logical file name.
:::

**Smkreport** will detect whether the file is a physical or logical file
name by checking to see if the \<Filename\> value is defined with a
nonblank value in the run-time environment. If it is, then **Smkreport**
assumes the value is a logical file name, and opens a file using the
value found from the environment.

If no information is given for \<Filename\>, the output files will be
named by their automatic logical file names, `REPORT[#]`{.envar}, where
\[\#\] is replaced by the number of the report file in order of its
associated /NEWFILE/ packet.
:::

::: {.navfooter}

------------------------------------------------------------------------

  ----------------------------- -------------------- ----------------------------------------
  [Prev](ch07s03s07.html)        [Up](ch07s03.html)                      [Next](ch07s04.html)
  7.3.7. The /AVEDAY/ packet     [Home](index.html)     7.4. Reports Created by **Smkreport**
  ----------------------------- -------------------- ----------------------------------------
:::
::: {.navheader}
7.4. Reports Created by **Smkreport**
:::

[Prev](ch07s03s08.html) 

Chapter 7. SMOKE Quality Assurance

 [Next](ch07s04s02.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

[]{#sect_qa_output}7.4. Reports Created by **Smkreport** {#reports-created-by-smkreport .title style="clear: both"}
--------------------------------------------------------

</div>

</div>
:::

::: {.toc}
[[7.4.1. File format(s)](ch07s04.html#d0e34920)]{.section}

[[7.4.2. Example reports](ch07s04s02.html)]{.section}
:::

As described in [Section 7.2, "**Smkreport**
Program"](ch07s02.html "7.2. Smkreport Program"), the **Smkreport**
program creates user-defined reports and summaries for QA purposes based
on the SMOKE intermediate files (e.g., SMOKE inventory files, hourly
emissions, speciation matrix, gridding matrix). The reports that are
created by **Smkreport** can easily be imported into a spreadsheet
program or into a database because the ASCII output format is delimited.
Note that report files larger than about 60,000 lines will not import
into Excel because of limitations of that software.

Because **Smkreport** is very flexible, there are a large number of
reports that you can generate. The "[File Format(s)]{.quote}" section
below describes the guidelines that **Smkreport** uses in building the
output reports, based on the instructions the user provides to
**Smkreport**. This section is followed by a large number of example
reports, to help you understand the possible format options.

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#d0e34920}7.4.1. File format(s) {#file-formats .title}

</div>

</div>
:::

::: {.toc}
[[7.4.1.1. Multiple reports in one
file](ch07s04.html#d0e34923)]{.section}

[[7.4.1.2. Basic report structure](ch07s04.html#d0e34937)]{.section}

[[7.4.1.3. Advanced report structures](ch07s04.html#d0e34942)]{.section}

[[7.4.1.4. Structure template](ch07s04.html#d0e34961)]{.section}

[[7.4.1.5. Elements of the REPORTS
section](ch07s04.html#d0e34971)]{.section}

[[7.4.1.6. Elements of the METADATA
section](ch07s04.html#d0e35191)]{.section}
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34923}7.4.1.1. Multiple reports in one file {#multiple-reports-in-one-file .title}

</div>

</div>
:::

Each file output by **Smkreport** can contain multiple reports. The user
has control over how many reports are included in each file (please see
the `REPCONFIG`{.envar} file documentation above for more information on
using the /CREATE REPORT/ and /NEWFILE/ packets). The reports in a file
are separated by a row of pound signs (\#). If having multiple reports
in a single file causes problems for importing the data into other
software, then you should create a `REPCONFIG`{.envar} file that
specifies a new file for each report.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34937}7.4.1.2. Basic report structure {#basic-report-structure .title}

</div>

</div>
:::

The reports in an output file use columns and rows to structure the
information. The reports are structured to permit the user to import a
report into spreadsheet or database software, or some other
data-processing tool for further analysis. The columns in the reports
are semicolon delimited (though the delimiter can be set by the user),
have labels, and have units. Where possible, we have also tried to make
sure that the text versions of the reports can be viewed easily. The
width of the widest entry in a column is used to set the width for the
column, thereby making fixed-file format transfer to other software
possible.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34942}7.4.1.3. Advanced report structures {#advanced-report-structures .title}

</div>

</div>
:::

Using the ARRANGE instruction in the **Smkreport** `REPCONFIG`{.envar}
input file, you can also create reports with more advanced structures: a
single report that is composed of multiple physical files; a report that
is single physical file but has multiple sections; or a report that uses
a "[database]{.quote}" format of one data value (e.g., emissions value)
per line. Use of these formats is described in the `REPCONFIG`{.envar}
file documentation in [Section 7.3, "`REPCONFIG`{.envar} Input
File"](ch07s03.html "7.3. REPCONFIG Input File").
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34961}7.4.1.4. Structure template {#structure-template .title}

</div>

</div>
:::

The following is a general template for the **Smkreport** output files.
It consists of a REPORTS section and a METADATA section. These two
sections are discussed in detail below the template.

``` {.programlisting}
<REPORT1>
     <User Title(s), one per line>
     <Automatic Titles, one per line>
     <Column headers>
     <Units, for columns that need them>
     <Line of minus signs>
     <Data values for all rows>
##########################################################################
<REPORT2, if any>
     <User Title(s), one per line>
     <Automatic Titles, one per line>
     <Column headers>
     <Units, for columns that need them>
     <Line of minus signs>
     <Data values for all rows>
##########################################################################
METADATA
     <Input files>
     <Echoed group definitions from REPCONFIG file>
     <Echoed report instructions from REPCONFIG file>
<End of file>
```
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e34971}7.4.1.5. Elements of the REPORTS section {#elements-of-the-reports-section .title}

</div>

</div>
:::

::: {.toc}
[[7.4.1.5.1. User titles](ch07s04.html#d0e34974)]{.section}

[[7.4.1.5.2. Automatic titles](ch07s04.html#d0e34982)]{.section}

[[7.4.1.5.3. Data columns written](ch07s04.html#d0e35039)]{.section}

[[7.4.1.5.4. Column delimiters](ch07s04.html#d0e35067)]{.section}

[[7.4.1.5.5. Column headers](ch07s04.html#d0e35078)]{.section}

[[7.4.1.5.6. Header units](ch07s04.html#d0e35160)]{.section}

[[7.4.1.5.7. Data rows](ch07s04.html#d0e35176)]{.section}
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e34974}7.4.1.5.1. User titles {#user-titles .title}

</div>

</div>
:::

The first section of each report is a title section. The first title
entries in the report are any titles specified in the /CREATE REPORT/
packets in the `REPCONFIG`{.envar} file, created by the user. They are
listed in the same order as those provided in the input packets for the
report. It is recommended that user titles be no more than 80 characters
wide (to more easily fit on printed documents), although they can have
up to 300 characters.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e34982}7.4.1.5.2. Automatic titles {#automatic-titles .title}

</div>

</div>
:::

Automatic titles are inserted by **Smkreport** to indicate the
operations that were done by **Smkreport** to generate the requested
report. This helps the report be self-describing. The automatic titles
are formatted to be no larger than 80 characters wide, in order to
permit easier viewing as text files. The following automatic titles are
applied, where applicable:

::: {.itemizedlist}
-   The source category processed

-   The year of the base inventory

-   The year of the grown inventory (only if a grown inventory file is
    input to **Smkreport**)

-   Whether growth factors were applied, and if so, for what year

-   Whether multiplicative control factors were applied, and if so, for
    what year

-   Whether a gridding matrix was applied, and if so, the grid name

-   Whether a speciation matrix was applied, and if so, whether it was
    mole-based or mass-based

-   Whether annual, average-day, or hourly data from SMOKE intermediate
    files are the basis of the emissions in the report

-   If hourly data were input, the time period processed with dates,
    hours, and time zones

-   Whether annual or average-day data were the basis for the report

-   Whether the emissions are divided by grid cell area (NORMALIZE
    CELLAREA instruction)

-   Whether the emissions are divided by population (NORMALIZE
    POPULATION instruction)

-   The name of the group used to select the data, if any (the group
    definition will be listed in the METADATA section)

-   The name of the subgrid used to select the data, if any (the subgrid
    definition will be listed in the METADATA section)
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e35039}7.4.1.5.3. Data columns written {#data-columns-written .title}

</div>

</div>
:::

The particular columns of data that are written to a report are
determined by the BY instructions in the /CREATE REPORT/ packet.
Typically, one column is created for each BY instruction, which
corresponds to the name of the BY instruction. The exceptions to this
rule are the following:

::: {.itemizedlist}
-   The BY COUNTRY, BY STATE, and BY COUNTY instructions, which output
    the country, state, and county codes, and optionally the country,
    state, and county names, respectively (if NAME is included at the
    end of the instruction).

-   The BY SOURCE instruction, which outputs columns for all source
    characteristics (point sources: country/state/county, plant, char1,
    char2, char3, char4, char5, SIC; area sources: country/state/county,
    SCC; mobile sources: country/state/county, road class, vehicle type,
    SCC). For point sources, the BY SOURCE instruction can also output
    four additional columns for stack parameters, and another additional
    column for facility name.
:::

In addition to the columns specified by the BY instructions, the
emissions and/or activity data are written out to the report. If no
speciation option is used (i.e., the SPECIATION instruction is not
given), then the other data columns are the emissions and activities
from the SMOKE inventory file (e.g., NOX, VOC, PM10, VMT). If the
speciation option [*is*]{.emphasis} used, then the other data columns
are the speciated emissions data (e.g., NO, NO2, ALD, PAR, ISOP). The
SELECT DATA instruction determines which inventory data and speciated
emissions data are written to the reports. When speciated data are
output, the columns for the corresponding inventory pollutants are
written as well (as explained more fully in the input file description
of the SELECT DATA instruction, earlier).

The order of the columns of data values is taken from the order of the
data in the SMOKE intermediate files. The orders of pollutants and
activities are controlled by the `INVTABLE`{.envar} file when
**Smkinven** is run to create the SMOKE inventory files. Species are
arranged by **Spcmat** based on the order of the pollutants, and then
alphabetically for species coming for the same pollutant, and this order
is used to create the speciation matrix.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e35067}7.4.1.5.4. Column delimiters {#column-delimiters .title}

</div>

</div>
:::

The default column delimiter in most cases is a semicolon (;). However,
if you select the "[BY SCC10 NAME]{.quote}" or "[BY SIC NAME]{.quote}"
instruction, the SCC or SIC description will be included in the report
and the default delimiter will be a pipe symbol (\|). This is because
the SCC and SIC descriptions can include semicolons. In either case, you
can use the /DELIMITER/ packet to manually set your choice of delimiter,
if desired.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e35078}7.4.1.5.5. Column headers {#column-headers .title}

</div>

</div>
:::

Each column of data is labeled with a header name. Where applicable, the
columns also are labeled with units (discussed below), as set by the
UNITS instruction or by the default units for the data used by the
program. For the emissions and activity data, the header names are
simply the names of the pollutants or activity variables input to SMOKE.
For columns generated by the BY instructions, the following possible
column headers are used by SMOKE. These are listed in the order in which
they would appear.

::: {.itemizedlist}
-   Date (values of MM/DD/YYYY)
-   Hour (integer values from 1 through 24)
-   Layer number (integer values \>0)
-   X cell (integer values \>0)
-   Y cell (integer values \>0)
-   Source ID (SMOKE record number, integer values \>0)
-   Co/St/Cy (Country, state, and county code; values of NSSCCC, with SS
    and/or CCC replaced by zeros as necessary, depending on the BY
    option used)
-   Country (value is name; optional when country, state, and county
    code is output)
-   State (value is name; optional when country, state, and county code
    is output)
-   County (value is name; optional when country, state, and county code
    is output)
-   SCC (10-character values, with 2 leading zeros for 8-character SCCs)
-   SIC (4-character values)
-   NAICS (6-character values)
-   MACT (6-character values)
-   ORIS ID (6-character values)
-   Primary Srg (primary surrogate ID code; for area or mobile sources
    only)
-   Fallbk Srg (fallback surrogate ID code; for area or mobile sources
    only)
-   Monthly Prf (monthly temporal profile code)
-   Weekly Prf (weekly temporal profile code)
-   Diurnal Prf (diurnal temporal profile code)
-   Spec Prf (speciation profile code)
-   Plant ID (for ORL) or Facility ID (for FF10)
-   Char 1 point-source stack ID (for ORL) or ?? (for FF10)
-   Char 2 Stack ID (for ORL) or Release Point ID (for FF10)
-   Char 3 Segment ID (for ORL) or Process ID (for FF10)
-   Char 4 (for point sources only; may or may not be defined)
-   Char 5 (for point sources only; may or may not be defined)
-   Stk Ht (stack height; for point sources only)
-   Stk Dm (stack diameter; for point sources only)
-   Stk Tmp (stack exit temperature; for point sources only)
-   Stk Vel (stack exit velocity; for point sources only)
-   Elevstat (E= elevated, P= Plume-in-grid, L= low-level; for point
    sources only)
-   Plt Name (facility name with quotes around it; for point sources
    only)
-   SCC Description (in quotes)
-   SIC Description (in quotes)
-   NAICS Description (in quotes)
-   MACT Description (in quotes)
-   ORIS Description (in quotes)
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e35160}7.4.1.5.6. Header units {#header-units .title}

</div>

</div>
:::

The units used in the header for each column depend on (1) the units in
the input files, (2) the units set as output units in the report
instructions, and (3) any normalization used. **Smkreport** starts with
the units obtained from the input files and application of any matrices
of interest. Then all unit conversions that can be made, are made. The
conversions are done separately on the numerator and the denominator,
but one or both of the conversions will not be done if **Smkreport** has
not been configured for the conversions. If this is the case, a note
will appear to this effect in the log file. Last, the units are
converted to 1/m^2^ if the NORMALIZE CELLAREA instruction has been
given.

Below the header units, a line of minus signs will appear in the
reports.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e35176}7.4.1.5.7. Data rows {#data-rows .title}

</div>

</div>
:::

The rows of data (i.e., emissions totals or activity totals) are listed
sequentially, without spaces between the rows, in sorted order according
to the BY instructions, and based on the order listed in the file (just
explained above). Data-value-based sorting is not done by **Smkreport**,
but rather left for a postprocessing step of other data manipulation
software. Unlike the title rows, the length of the data rows constrained
only by the maximum number of characters up to 3500 per ASCII line,
which varies based on the platform you are using. The ARRANGE
instruction can be used to improve the arrangement of data rows when the
lines are too large or the program is not working properly because of
the large number of data values requested in a report.

The data values in the rows are formatted based on the NUMBER
instruction for the report.

The resolution of the data values (e.g., summed by SCC) depends on the
BY instructions for the report. The inventory records included in the
totals (i.e., which sources are included in the reported emissions)
depend on the SELECT instructions for the report. More description of
these instructions and how they affect the output is provided with the
`REPCONFIG`{.envar} file format information given earlier.
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e35191}7.4.1.6. Elements of the METADATA section {#elements-of-the-metadata-section .title}

</div>

</div>
:::

::: {.toc}
[[7.4.1.6.1. Input files](ch07s04.html#d0e35196)]{.section}

[[7.4.1.6.2. Echoed group definitions](ch07s04.html#d0e35201)]{.section}

[[7.4.1.6.3. Echoed report
instructions](ch07s04.html#d0e35209)]{.section}
:::

Note: this section is not yet implemented in SMOKE. Once implemented,
this section of the reports will begin by a line with the word METADATA
on it.

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e35196}7.4.1.6.1. Input files {#input-files .title}

</div>

</div>
:::

In this part of the METADATA section, all of the input files used in
running the program are provided, one on each line. The full path and
file name will be provided.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e35201}7.4.1.6.2. Echoed group definitions {#echoed-group-definitions .title}

</div>

</div>
:::

The group definitions from the `REPCONFIG`{.envar} file used to generate
the file will be listed in this section. The definitions will be merely
copied directly from the input file to this section of the output
report.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

##### []{#d0e35209}7.4.1.6.3. Echoed report instructions {#echoed-report-instructions .title}

</div>

</div>
:::

The report instructions from the `REPCONFIG`{.envar} file used for
creating each report in the file will be listed in this section. The
instructions will be merely copied directly from the input file.
:::
:::
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  ------------------------------ -------------------- --------------------------
  [Prev](ch07s03s08.html)          [Up](ch07.html)       [Next](ch07s04s02.html)
  7.3.8. The /NEWFILE/ packet     [Home](index.html)      7.4.2. Example reports
  ------------------------------ -------------------- --------------------------
:::
::: {.navheader}
7.4.2. Example reports
:::

[Prev](ch07s04.html) 

7.4. Reports Created by **Smkreport**

 [Next](ch07s05.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#d0e35217}7.4.2. Example reports {#example-reports .title}

</div>

</div>
:::

::: {.toc}
[[7.4.2.1. Example 1](ch07s04s02.html#d0e35225)]{.section}

[[7.4.2.2. Example 2](ch07s04s02.html#d0e35230)]{.section}

[[7.4.2.3. Example 3](ch07s04s02.html#d0e35235)]{.section}

[[7.4.2.4. Example 4](ch07s04s02.html#d0e35240)]{.section}

[[7.4.2.5. Example 5](ch07s04s02.html#d0e35245)]{.section}

[[7.4.2.6. Example 6](ch07s04s02.html#d0e35252)]{.section}

[[7.4.2.7. Example 7](ch07s04s02.html#d0e35257)]{.section}

[[7.4.2.8. Example 8](ch07s04s02.html#d0e35262)]{.section}

[[7.4.2.9. Example 9](ch07s04s02.html#d0e35267)]{.section}

[[7.4.2.10. Example 10](ch07s04s02.html#d0e35272)]{.section}
:::

Given below are just a few examples of the many types of reports
**Smkreport** can generate. Note that no actual emission data values are
given in these examples (and sometimes the emission values are not even
listed). Also, no example is given with two reports in a single file.
When we created these examples, we pretended that the inventory used to
generate the reports had only CO and NOx available. Also, we have not
provided the entire reports, but rather a sampling of what each report
looks like, without showing all states, SCCs, etc.

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e35225}7.4.2.1. Example 1 {#example-1 .title}

</div>

</div>
:::

``` {.programlisting}
Country-total point-source inventory emissions, with country names
1996 Inventory
No gridding

Co/St/Cy, Country Name, CO       , NOX
        ,             , [tons/yr], [tons/yr]
--------------------------------------------
  000000, US          , 602390.4 , 302123.1
  100000, Canada      , 312233.3 , 197158.9
  200000, Mexico      , 809822.1 , 289321.3
```
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e35230}7.4.2.2. Example 2 {#example-2 .title}

</div>

</div>
:::

``` {.programlisting}
State-total point-source emissions, with state names
1996 Inventory
No gridding

Co/St/Cy, State Name    , CO        , NOX   
        ,               , [tons/yr] , [tons/yr]
------------------------------------------------
  010000, Alabama       ,    2390.4 ,    2123.1 
  037000, North Carolina,    5233.3 ,    2400.9 
  045000, South Carolina,    3822.1 ,    1321.3
```
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e35235}7.4.2.3. Example 3 {#example-3 .title}

</div>

</div>
:::

``` {.programlisting}
County-total area-source emissions, with state and county names
1996 Inventory
No gridding

Co/St/Cy, State Name    , County Name , CO        , NOX       
        ,               ,             , [tons/yr] , [tons/yr] 
--------------------------------------------------------------
  037001, North Carolina, Alamance Co , 0.2344E+03, 0.1235E+03
  037003, North Carolina, Alexander Co, 0.1354E+03, 0.9909E+02
  037005, North Carolina, Alleghany Co, 0.9807E+02, 0.7897E+02
  037007, North Carolina, Anson Co    , 0.8734E+03, 0.9807E+02
  037009, North Carolina, Ashe Co     , 0.1140E+03, 0.9871E+02
```
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e35240}7.4.2.4. Example 4 {#example-4 .title}

</div>

</div>
:::

``` {.programlisting}
Hourly area-source emissions by county for first 3 counties in NC
1996 Inventory
No gridding
July 1, 1996 at 0 GMT to July 7, 1996 at 23 GMT

Day       , Hour, Co/St/Cy, CO        , NOX      
          ,     ,         , [tons/hr] , [tons/hr]
-------------------------------------------------
07/01/1996,    0,   037001,     0.1234,   0.5678 
07/01/1996,    0,   037003,     0.1247,   0.5725 
07/01/1996,    0,   037005,     0.1293,   0.5548 
07/01/1996,    1,   037001,     etc. 
07/01/1996,    1,   037003,      
07/01/1996,    1,   037005,      
07/01/1996,    2,   037001,      
07/01/1996,    2,   037003,      
07/01/1996,    2,   037005,
```
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e35245}7.4.2.5. Example 5 {#example-5 .title}

</div>

</div>
:::

In this example, the data are sorted by the first three columns (the BY
settings) from left to right. The x-cell cycles the slowest, followed by
the y-cell, and then by the county code.

``` {.programlisting}
Grid-cell inventory area-source emissions by county, daily average
1996 Inventory
Grid name NC36_03X03

X cell, Y cell, Co/St/Cy, CO      , NOX
      ,       ,         , [kg/day], [kg/day]
--------------------------------------------
     1,      1,   037001, 0.123556, 0.0789112
     1,      1,   037003, etc.
     1,      2,   037001, 
     1,      2,   037003, 
     2,      1,   037001,
```
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e35252}7.4.2.6. Example 6 {#example-6 .title}

</div>

</div>
:::

``` {.programlisting}
SCC-total mobile-source emissions by day from hourly data
1996 Inventory
No gridding
July 1, 1996 at 0 GMT to July 7, 1996 at 23 GMT

Date      , SCC       , CO        , NOX
          ,           , [tons/day], [tons/day]
----------------------------------------------
07/01/1996, 2201001110,    123.321,    456.654
07/01/1996, 2201001130,    etc.
07/01/1996, 2201001150, 
07/01/1996, 2201001170, 
07/01/1996, 2201001190, 
07/01/1996, 2201001210, 
07/01/1996, 2201001230,
```
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e35257}7.4.2.7. Example 7 {#example-7 .title}

</div>

</div>
:::

``` {.programlisting}
SCC-total mobile-source daily-total emissions by state (no state names)
North Carolina and South Carolina
1996 Inventory
No gridding
July 1, 1996 at 0 GMT to July 7, 1996 at 23 GMT

Date      , Co/St/Cy, SCC       , CO        , NOX
          ,         ,           , [tons/day], [tons/day]
--------------------------------------------------------
07/01/1996,    37000, 2201001110,    123.321,    456.654
07/01/1996,    37000, 2201001130,    etc.
07/01/1996,    37000, 2201001150, 
07/01/1996,    37000, 2201001170, 
07/01/1996,    37000, 2201001190, 
07/01/1996,    37000, 2201001210, 
07/01/1996,    37000, 2201001230, 
07/01/1996,    45000, 2201001110, 
07/01/1996,    45000, 2201001130, 
07/01/1996,    45000, 2201001150, 
07/01/1996,    45000, 2201001170, 
07/01/1996,    45000, 2201001190, 
07/01/1996,    45000, 2201001210, 
07/01/1996,    45000, 2201001230,
```
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e35262}7.4.2.8. Example 8 {#example-8 .title}

</div>

</div>
:::

``` {.programlisting}
Elevated hourly emissions by grid cell and point source
Only 2 point sources in inventory (wouldn’t that be nice?)
1996 Inventory
Grid name NC36_03X03
July 1, 1996 at 0 GMT to July 7, 1996 at 23 GMT

Date      , Hour, X cell, Y cell, Source ID, CO        , NOX
          ,         ,           ,          , [tons/day], [tons/day]
-------------------------------------------------------------------
07/01/1996,    0,      1,      1,         1,    123.321,    456.654
07/01/1996,    0,      1,      1,         2,     12.345,     56.789
07/01/1996,    0,      1,      2,         1,    123.321,    456.654
07/01/1996,    0,      1,      2,         2,     12.345,     56.789
07/01/1996,    0,      1,      3,         1,    etc.
07/01/1996,    0,      1,      3,         2,
07/01/1996,    0,      2,      1,         1,
07/01/1996,    0,      2,      1,         2,
07/01/1996,    0,      2,      2,         1,
07/01/1996,    0,      2,      2,         2,
07/01/1996,    0,      2,      3,         1,
07/01/1996,    0,      2,      3,         2,
07/01/1996,    0,      3,      1,         1,
07/01/1996,    0,      3,      1,         2,
07/01/1996,    0,      3,      2,         1,
07/01/1996,    0,      3,      2,         2,
07/01/1996,    0,      3,      3,         1,
07/01/1996,    0,      3,      3,         2,
07/01/1996,    1,      1,      1,         1,
07/01/1996,    1,      1,      1,         2,
07/01/1996,    1,      1,      2,         1,
07/01/1996,    1,      1,      2,         2,
07/01/1996,    1,      1,      3,         1,
07/01/1996,    1,      1,      3,         2,
```
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e35267}7.4.2.9. Example 9 {#example-9 .title}

</div>

</div>
:::

``` {.programlisting}
Breweries and Wineries SCC-total area-source emissions for a subgrid
Grid name: NC36_24X24
Subgrid cells selected:
    (1,1) TO (4,4)
    (6,6) TO (9,9)

X cell, Y cell, SCC       , CO        , NOX
      ,       ,           , [tons/day], [tons/day]
--------------------------------------------------
     1,      1, 2302070001, 0.1234E-03, 0.4567E-04
     1,      1, 2302070005, etc.
     1,      2, 2302070001, 
     1,      2, 2302070005, 
     1,      3, 2302070001, 
     1,      3, 2302070005, 
     1,      4, 2302070001, 
     1,      4, 2302070005, 
     2,      1, 2302070001, 
     2,      1, 2302070005,
```
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#d0e35272}7.4.2.10. Example 10 {#example-10 .title}

</div>

</div>
:::

``` {.programlisting}
Grid-cell-normalized area-source daily-total speciated emissions for NC
Grid name: NC36_24X24
Cell-area-normalized emissions using cell size 36000 m X 36000 m
July 1, 1996 at 0 GMT to July 7, 1996 at 23 GMT

Date      , Co/St/Cy, State         , CO            , NO      , NO2
          ,         ,               , [g/day*m^2], [g/day*m^2], [g/day*m^2]
---------------------------------------------------------------------------
07/01/1996,    37000, North Carolina,    112.3456,     23.3456,      1.1234
07/02/1996,    37000, North Carolina,    112.3456,     23.3456,      1.1234
07/03/1996,    37000, North Carolina,    112.3456,     23.3456,      1.1234
07/04/1996,    37000, North Carolina,    112.3456,     23.3456,      1.1234
07/05/1996,    37000, North Carolina,    112.3456,     23.3456,      1.1234
07/06/1996,    37000, North Carolina,    112.3456,     23.3456,      1.1234
07/07/1996,    37000, North Carolina,    112.3456,     23.3456,      1.1234
```
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  ---------------------------------------- -------------------- ---------------------------------
  [Prev](ch07s04.html)                      [Up](ch07s04.html)               [Next](ch07s05.html)
  7.4. Reports Created by **Smkreport**     [Home](index.html)     7.5. Quality Assurance Methods
  ---------------------------------------- -------------------- ---------------------------------
:::
::: {.navheader}
7.5. Quality Assurance Methods
:::

[Prev](ch07s04s02.html) 

Chapter 7. SMOKE Quality Assurance

 [Next](ch07s05s02.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

[]{#sect_qa_methods}7.5. Quality Assurance Methods {#quality-assurance-methods .title style="clear: both"}
--------------------------------------------------

</div>

</div>
:::

::: {.toc}
[[7.5.1. Setting up
SMOKE](ch07s05.html#sect_qa_methods_setup)]{.section}

[[7.5.2. Reviewing log files](ch07s05s02.html)]{.section}

[[7.5.3. Reviewing reports created by SMOKE core
programs](ch07s05s03.html)]{.section}

[[7.5.4. Reviewing and customizing reports created by
**Smkreport**](ch07s05s04.html)]{.section}
:::

To determine whether your run worked correctly, you must quality assure
your emissions processing. To one degree or another, you must design
your quality assurance techniques to be specific to each emissions
modeling effort, since no two efforts are exactly the same. This section
describes some general methods that can be followed to assist users with
quality assuring their emissions processing.

As stated in the introduction to this chapter, quality assurance
consists of at least the following four components. These are discussed
in [Section 7.5.1, "Setting up
SMOKE"](ch07s05.html#sect_qa_methods_setup "7.5.1. Setting up SMOKE"),
[Section 7.5.2, "Reviewing log
files"](ch07s05s02.html "7.5.2. Reviewing log files"), [Section 7.5.3,
"Reviewing reports created by SMOKE core
programs"](ch07s05s03.html "7.5.3. Reviewing reports created by SMOKE core programs"),
and [Section 7.5.4, "Reviewing and customizing reports created by
**Smkreport**"](ch07s05s04.html "7.5.4. Reviewing and customizing reports created by Smkreport").

::: {.itemizedlist}
-   Setting up SMOKE using available documentation (this manual) on file
    formats and script setup.

-   Reviewing log files for errors and warnings, then resolving any
    problems.

-   Reviewing reports generated by SMOKE core programs (e.g., reports
    from the **Cntlmat** program indicating which controls were applied
    and the changes made to the inventory emissions).

-   Reviewing and customizing reports generated by the **Smkreport**
    program, and comparing these to one another and to totals from the
    emission inventory.
:::

With all reporting and analyses, it is important to keep the following
principles in mind:

::: {.itemizedlist}
-   Focus only on those pollutants and inventories that are key
    components of air quality problems in your modeling case. For
    example, it is often not worthwhile analyzing CO emissions, since
    their contribution to ozone air quality problems is minor. It is
    often worthwhile to first analyze the raw inventories to see which
    source categories are contributing the majority of key pollutants,
    to help target your efforts.

-   When performing analysis on a key inventory and pollutant, focus on
    those SCCs that contribute the majority of the emissions. For
    example, if 10% of the SCCs contribute 90% of the emissions, focus
    on quality assuring those 10% of SCCs.

-   Keep lists of potential issues, their status, and their resolution.
    Such lists will be critical to documenting the emissions modeling
    efforts when you are finished.

-   As problems are found, new inventories may be created and analyses
    rerun. Make sure to use new scenario names in the SMOKE Assigns
    files when running a new version of the inventory. The
    `INVEN`{.envar}, `INVOP`{.envar}, and `INVID`{.envar} environment
    variables can be configured to use the same input directories and
    new output directories.

-   Consider using version-control software (such as the UNIX CVS or
    SCCS programs) to keep track of changes in your inventories and
    SMOKE support files.

-   If possible, archive the SMOKE configuration, including all inputs
    and output files, once a set of "[final]{.quote}" model-ready
    emissions is created and used in an air quality model. Inevitably,
    more changes will be made to the SMOKE setup, but you will most
    likely want or need to go back to the raw inputs used for a specific
    case, once it has been run through an AQM.
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_qa_methods_setup}7.5.1. Setting up SMOKE {#setting-up-smoke .title}

</div>

</div>
:::

The information in [Chapter 8, *SMOKE Input
Files*](ch08.html "Chapter 8. SMOKE Input Files"), which provides
detailed documentation on SMOKE input file formats, can be used to help
ensure the quality of your modeling efforts. Although SMOKE programs
check the input file formats when they are read and used, you should not
rely on this capability entirely. There is no substitute for carefully
comparing your input files with the file formats in this manual. The
files should be checked in the following ways:

::: {.itemizedlist}
-   Make sure all required fields specified in the manual are present.

-   Make sure all fields are in the correct position in the file.

-   Make sure the type of the field (integer, real, character) is
    consistent between the file and the manual. Usually, it is
    acceptable to provide an integer value for a real field, if the data
    warrant this.

-   Make sure the file has been converted from DOS/Windows to UNIX
    format. This is often an issue when users edit their files on a
    Windows computer and move the file to a UNIX (including Linux)
    workstation for further processing. Files that have not been
    transferred properly will have "[\^M]{.quote}" entries at the end of
    each line and possibly a "[\^Z]{.quote}" entry at the end of the
    file. All of these erroneous fields must be removed. Some options
    for making this conversion automatically include the **dos2unix**
    and **to\_unix** UNIX command-line programs.

-   Make sure tabs are not used in the file. SMOKE does not support tabs
    as delimiters in the input files, and the readers will not be able
    to read the data correctly if tabs are present.
:::

[Chapter 4, *How to Use SMOKE*](ch04.html "Chapter 4. How to Use SMOKE")
provides documentation on the SMOKE example scripts. We recommend that
new users start with these example scripts to enhance the quality of
their experience using SMOKE - and thus the ultimate quality of their
emissions modeling results. The script documentation should be reviewed
carefully before making changes to the settings in the scripts. In
addition, [Chapter 5, *SMOKE Utility
Tools*](ch05.html "Chapter 5. SMOKE Utility Tools"), [Chapter 6, *SMOKE
Core Programs*](ch06.html "Chapter 6. SMOKE Core Programs"), and
[Section 7.2, "**Smkreport**
Program"](ch07s02.html "7.2. Smkreport Program") provide documentation
on the UNIX environment variables that the scripts use to control the
SMOKE programs. These settings can make a large difference in the
emissions modeling results. Users should review each setting in the
scripts, understand its purpose, and make an informed decision about the
value to use for each setting prior to using the SMOKE run scripts on
new inventory data. The end of [Chapter 4, *How to Use
SMOKE*](ch04.html "Chapter 4. How to Use SMOKE") provides some
additional information about how to reconfigure your run scripts; these
instructions should be followed carefully to ensure high quality in your
emissions modeling.

A useful way to ensure that the settings have all been checked and set
correctly is to create a table that includes all SMOKE settings for each
source category. This table can then be filled in prior to running SMOKE
for a new case, while reviewing the SMOKE documentation in detail for
the correct settings. As the scripts are created for a new case, this
table can be the reference for setting up the script properly. Prior to
running the new script, its settings should be compared to the reference
table as a final check that all the correct settings have been used.
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  -------------------------- -------------------- -----------------------------
  [Prev](ch07s04s02.html)      [Up](ch07.html)          [Next](ch07s05s02.html)
  7.4.2. Example reports      [Home](index.html)     7.5.2. Reviewing log files
  -------------------------- -------------------- -----------------------------
:::
::: {.navheader}
7.5.2. Reviewing log files
:::

[Prev](ch07s05.html) 

7.5. Quality Assurance Methods

 [Next](ch07s05s03.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_qa_methods_logs}7.5.2. Reviewing log files {#reviewing-log-files .title}

</div>

</div>
:::

The SMOKE log files are the first source of information about whether
your SMOKE run has completed properly. The simplest thing to check in
the log file is that the program ran to completion. If it did, the last
line of the log file will be "[Normal Completion of
program\...]{.quote}" followed by the program name. This line is simply
a first step to understanding whether your program actually completed
successfully because this "[successful completion]{.quote}" statement
will be printed even if your program ran with warnings. If errors
occurred in your program run, this line will not be printed.

To fully evaluate whether your program run was indeed successful, you
must review the entire log file and also perform additional QA as
described in [Section 7.5.3, "Reviewing reports created by SMOKE core
programs"](ch07s05s03.html "7.5.3. Reviewing reports created by SMOKE core programs")
and [Section 7.5.4, "Reviewing and customizing reports created by
**Smkreport**"](ch07s05s04.html "7.5.4. Reviewing and customizing reports created by Smkreport").
In this section, we describe how to further review the log files.
[Figure 7.1, "Flow diagram for examining log
files"](ch07s05s02.html#fig_qa_examine_logs "Figure 7.1. Flow diagram for examining log files")
is a flow diagram that gives step-by-step instructions on how to
evaluate the errors and warnings in the log files.

In the diagram, "[SMOKE support]{.quote}" refers to several resources
that you can use for support on SMOKE. The primary support mechanism is
the Community Modeling and Analysis System (CMAS) Center [Help
Desk](http://www.cmascenter.org/html/help.html). This web site can be
used to look up questions and answers as well as submit new questions
about SMOKE usage and behavior. Another resource available to all
emissions modelers is the [emregional
listserv](http://webmail0.isis.unc.edu:82/lists/index.php?reason=results&list=emregional).
This listserv is hosted by the University of North Carolina at Chapel
Hill's Carolina Environmental Program (CEP) and is open to all
questions, concerns, and issues related to emissions modeling.

::: {.figure}
[]{#fig_qa_examine_logs}

**Figure 7.1. Flow diagram for examining log files**

::: {.mediaobject}
![Flow diagram for examining log files](images\qa\examine_logs_html.jpg)
:::
:::

One technique you can use to quickly create a list of the major types of
errors or warnings that occurred, without listing all of the many
specific instances, is to use the UNIX **grep** command. This approach
will find the types of errors and warnings, but when multiple instances
of an error or warning are present (e.g., for multiple sources) only one
instance of the error or warning will be listed. The UNIX command to
perform this function is:

**`grep ERROR <logfile>` \| **cut -c1-50** \| **sort -u****

The "[ERROR]{.quote}" in this command can be replaced by
"[WARNING]{.quote}", and the number "[50]{.quote}" can be increased or
reduced depending on whether you need more or fewer of the warnings in
order to obtain the information you want. The "[50]{.quote}" controls
how many columns of text are included. The **sort -u** performs a unique
(-u) sort that will eliminate duplicate records created by the **cut**
part of the command. So, since more lines will be similar when the
**cut** command includes fewer columns, the unique sort will produce
fewer unique entries as the **cut** limit is decreased. The number 50 is
usually a good starting point, since it captures the majority of the
critical part of the warning, without capturing less significant details
such as a line number from an input file on which the error or warning
occurred.

In addition to reviewing the log files for errors and warnings, we
recommend that you compare the environment variable settings listed in
the log files with those you intended to use. Previously, we recommended
that you create a table that includes all of the correct SMOKE scripts
settings to be used in the modeling effort. The settings shown in the
log files should be compared back to that master table to ensure that
everything worked properly. This can help you prevent the SMOKE programs
from obtaining and using incorrect settings due to typographical errors
in the scripts.

Finally, the log files include all of the names of the input and output
files. These should be reviewed to confirm that the correct input files
and output files were actually used by the program. It is possible that
an error in the Assigns file or script could cause the wrong input files
to be used, or the output files to be written to the wrong locations.
:::

::: {.navfooter}

------------------------------------------------------------------------

  --------------------------------- -------------------- ----------------------------------------------------------
  [Prev](ch07s05.html)               [Up](ch07s05.html)                                     [Next](ch07s05s03.html)
  7.5. Quality Assurance Methods     [Home](index.html)     7.5.3. Reviewing reports created by SMOKE core programs
  --------------------------------- -------------------- ----------------------------------------------------------
:::
::: {.navheader}
7.5.3. Reviewing reports created by SMOKE core programs
:::

[Prev](ch07s05s02.html) 

7.5. Quality Assurance Methods

 [Next](ch07s05s04.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_qa_methods_core_reports}7.5.3. Reviewing reports created by SMOKE core programs {#reviewing-reports-created-by-smoke-core-programs .title}

</div>

</div>
:::

In addition to log files, some SMOKE programs also create reports. These
reports can help provide quality assurance concerning the steps taken by
the program. The programs and their associated reports and uses are as
follows:

**Smkinven**: Creates the `REPINVEN`{.envar} file, which documents the
inventory data read, which data where kept, and the inventory totals for
each data value. It also includes the area-to-point conversion
information.

**Laypoint**: Creates the `REPRTLAY`{.envar} file, which documents any
point sources for which the **Laypoint** program computed a plume rise
into a layer greater than the layer number set by the
`REP_LAYER_MAX`{.envar} setting.

**Spcmat**: Creates the `ASSUP`{.envar}, `MSSUP`{.envar}, and
`PSSUP`{.envar} files, which include the speciation profile codes
assigned to each source by pollutant. These files can be used with the
ASCII component of the SMOKE intermediate inventory file
(`AREA`{.envar}, `MOBL`{.envar}, and `PNTS`{.envar}) to quickly
determine the speciation profile assigned to a specific source. These
files are also input files to the **Smkreport** program, for creating
more involved summaries of emissions and/or sources including the
speciation profiles.

**Grdmat**: Creates the `AGSUP`{.envar} and `MGSUP`{.envar} files, which
include the spatial surrogate codes assigned to each source. They also
indicate whether that assignment was a fallback or original assignment.
This file can be used with the ASCII component of the SMOKE intermediate
inventory file (`AREA`{.envar} and `MOBL`{.envar}) to quickly determine
the spatial surrogate assigned to a specific source. These files can
also be used by the **Smkreport** program, for creating more involved
summaries of emissions and/or sources including the spatial surrogate
codes.

**Temporal**: Creates the `ATSUP`{.envar}, `MTSUP`{.envar}, and
`PTSUP`{.envar} files, which include the monthly, weekly, and diurnal
profile codes assigned to each source for each pollutant. These files
can be used with the ASCII component of the SMOKE intermediate inventory
file (`AREA`{.envar}, `MOBL`{.envar}, and `PNTS`{.envar}) to quickly
determine the temporal profiles assigned to a specific source. When no
pollutant-specific temporal profile assignments have been made, these
files can also be used by the **Smkreport** program, for creating more
involved summaries of emissions and/or sources including the temporal
profile codes.

**Cntlmat**: Writes several report files (documented with the
**Cntlmat** program in [Chapter 6, *SMOKE Core
Programs*](ch06.html "Chapter 6. SMOKE Core Programs")) that summarize
the growth and control factors. Separate reports are written for each
type of projection (growth, multiplicative control, reactivity control)
with emissions before and after each control. Another report is written
that summarizes all projections made to each source.

**Smkmerge**: Writes a report of state and/or county totals that are
created at the same time as the model-ready files. These totals are
guaranteed to match the actual state/county totals in the model-ready
gridded, hourly outputs (unless there is a problem introduced into
**Smkmerge**). These reports are useful even though they duplicate the
**Smkreport** reports in some ways, because they allow you to ensure
that the **Smkmerge** totals and **Smkreport** totals are the same -
indicating that **Smkreport** was run with the correct files. Because
**Smkreport** is run separately from **Smkmerge**, this is not
necessarily the case, so you should confirm it with the **Smkmerge**
report.
:::

::: {.navfooter}

------------------------------------------------------------------------

  ----------------------------- -------------------- --------------------------------------------------------------------
  [Prev](ch07s05s02.html)        [Up](ch07s05.html)                                               [Next](ch07s05s04.html)
  7.5.2. Reviewing log files     [Home](index.html)     7.5.4. Reviewing and customizing reports created by **Smkreport**
  ----------------------------- -------------------- --------------------------------------------------------------------
:::
::: {.navheader}
7.5.4. Reviewing and customizing reports created by **Smkreport**
:::

[Prev](ch07s05s03.html) 

7.5. Quality Assurance Methods

 [Next](ch08.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_qa_methods_smkreport}7.5.4. Reviewing and customizing reports created by **Smkreport** {#reviewing-and-customizing-reports-created-by-smkreport .title}

</div>

</div>
:::

::: {.toc}
[[7.5.4.1. Area, nonroad mobile, and precomputed emissions for on-road
mobile
sources](ch07s05s04.html#sect_qa_methods_smkreport_area)]{.section}

[[7.5.4.2. Point
sources](ch07s05s04.html#sect_qa_methods_smkreport_point)]{.section}

[[7.5.4.3. On-road mobile sources using
MOBILE6](ch07s05s04.html#sect_qa_methods_smkreport_mobile)]{.section}
:::

This section provides some ideas on things to check after SMOKE has been
run to a successful completion (and after the other QA steps described
above have been completed). The review steps listed here will help
ensure that SMOKE is working properly. However, these recommendations
will not enable you to identify any missing sources (the source exists
but was not included in the inventory) or wrong emissions sources (the
source is in the inventory, but the emissions are completely incorrect),
so it is up to you to understand your emission inventory and make sure
that it is representative of the emissions for the regions and years of
interest.

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#sect_qa_methods_smkreport_area}7.5.4.1. Area, nonroad mobile, and precomputed emissions for on-road mobile sources {#area-nonroad-mobile-and-precomputed-emissions-for-on-road-mobile-sources .title}

</div>

</div>
:::

The following checks should be performed to ensure that the area-source
and nonroad mobile-source processing was done properly:

::: {.orderedlist}
1.  Compare state and/or county totals among the following processing
    steps:

    ::: {.orderedlist}
    a.  Inventory import

    b.  Spatial allocation

    c.  Temporal allocation for key days (e.g., weekday, Saturday, and
        Sunday)

    d.  Chemical speciation (e.g., add up NO/NO~2~ and VOC species using
        the SELECT DATA instruction in **Smkreport** with the S- prefix)

    e.  Final merge

    f.  Make comparisons for multiple grid resolutions, if applicable.
    :::

    The differences and similarities revealed at each stage should be
    these:

    ::: {.orderedlist}
    a.  Import totals (after **Smkinven** processing) should be the same
        as inventory totals outside of SMOKE (if available).

    b.  Spatial allocation totals should be the same as the import
        totals for all states/counties except those on a grid boundary.
        Comparing totals after spatial allocation among multiple grids
        should reveal that the emissions totals are the same in all
        grids for states/counties that are completely within the grids.

    c.  Temporal allocation should be different for weekdays, Saturday,
        and Sunday, and different from the average-weekday or average
        annual value represented by the import totals. The differences
        should be in the correct direction: generally, area sources are
        higher on weekends because of lawn/garden emissions. If you are
        using an average-day inventory (not an annual inventory),
        confirm that monthly adjustments have not been made. Check that
        any holiday days have been processed as directed based on the
        `HOLIDAYS`{.envar} files (e.g., that weekday holidays have been
        processed as Sundays).

    d.  Chemical speciation should match total mass before and after
        (again, the **Smkreport** SELECT DATA option with the S- prefix
        is helpful here).

    e.  Final merged files should match between the **Smkmerge** and
        **Smkreport** reports.
    :::

2.  Create report of temporal allocation factors used, by SCC. Review
    profiles assigned to SCCs representing the top 50%-80% of key
    area/nonroad pollutants for your inventory.

3.  Create report of spatial surrogates used, by SCC. Review spatial
    surrogates assigned to SCCs representing the top 50%-80% of key
    area/nonroad pollutants for your inventory.

4.  Create report of speciation profiles used, by SCC. Review speciation
    profiles assigned to SCCs representing the top 50%-80% of key
    area/nonroad pollutants for your inventory.

5.  Create reports by state/SCC for key states in your domain (the
    SELECT REGION statement in **Smkreport** can be used to isolate
    certain states for this report). Review these reports to ensure that
    the totals are consistent with expectations. Compare and contrast
    emissions by SCC among states. Include per-capita reports as well as
    total emissions reports, and review these to determine if per-capita
    emissions differences make sense from state to state; this approach
    can often identify outliers in inventories (caused by improper
    units, double counting, or out-of-date inventory creation approach).

6.  Create spatial plots (e.g., using VERDI) of average-day emissions
    for each day (these daily-total emissions can be created by running
    **Smkmerge** with `MRG_TEMPORAL`{.envar} set to N). Daily-total
    plots can also be created from the model-ready plots using the I/O
    API utility **m3tproc**. Do for all grids (if applicable) and
    compare.

7.  Create temporal profile plots (e.g., using VERDI) of hourly, gridded
    data over the entire episode. Look for consistent patterns on
    consistent days (e.g., all non-holiday weekdays in a single month
    should have the same value). Do for all grids (if applicable) and
    compare. Check for holidays and ensure these were processed as
    Sundays.
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#sect_qa_methods_smkreport_point}7.5.4.2. Point sources {#point-sources .title}

</div>

</div>
:::

The following checks should be performed to ensure that the
point-sources processing was done properly:

::: {.orderedlist}
1.  Compare state and/or county totals at the following processing steps
    for all grids:

    ::: {.orderedlist}
    a.  Inventory import

    b.  Spatial allocation

    c.  Temporal allocation for weekday, Saturday, and Sunday

    d.  Chemical speciation (e.g., add up NO/NO~2~ and VOC species using
        the SELECT DATA instruction in **Smkreport** with the S- prefix)

    e.  Layer fractions

    f.  Final merge
    :::

    The differences and similarities revealed at each stage should be
    these:

    ::: {.orderedlist}
    a.  Import totals (after **Smkinven** processing) should be the same
        as inventory totals outside of SMOKE (if available)

    b.  Spatial allocation should be the same as the import totals for
        all states/counties except those on a grid boundary. Comparing
        totals after spatial allocation among multiple grids should
        reveal that the emissions totals are the same in all grids for
        states/counties that are completely within the grids.

    c.  Temporal allocation may or may not be different for weekdays,
        Saturday, and Sunday, and different from the average-weekday or
        average annual value represented by the import totals. The
        differences should be in the correct direction: generally, many
        of the electric generating facilities (major emissions sources)
        are the same for all days of the week because the power plants
        never shut down and their emissions do not depend much on the
        day of the week. Emissions for major manufacturing plants will
        often be closed completely on weekends and have no emissions. If
        using an average-day inventory (not an annual inventory),
        confirm that monthly adjustments have not been made. Check that
        any holiday days have been processed as directed based on the
        `HOLIDAYS`{.envar} files (e.g., that weekday holidays have been
        processed as Sundays).

        If using day-specific or hour-specific inventory data, then it
        will be harder to compare the inventory totals before input to
        SMOKE to the emissions totals after temporal processing. This is
        because part of a state/county total when using hour-day- or
        hour-specific data include these data and part do not, but the
        inventory totals are often available only for the annual and/or
        average-day emissions values. This limitation can be rectified
        by calculating the emissions totals for the day- and
        hour-specific data outside of SMOKE, and analyzing these sources
        by SCC instead of only by state/county to separate the analysis
        of the annual and/or average-day emissions from the analysis of
        the day- and/or hour-specific emissions.

    d.  Chemical speciation should match total mass before and after
        (again, the **Smkreport** SELECT DATA option with the S- prefix
        is helpful here).

    e.  Emissions totals should match before and after layer fractions
        for all grids. Note that the layer fractions will be different
        across grids for sources that are in multiple grids because the
        meteorology data are different.

    f.  Final merged files should match between the **Smkmerge** and
        **Smkreport** reports.
    :::

2.  Create report of temporal allocation factors used, by SCC. Review
    profiles assigned to SCCs representing the top 50%-80% of key
    point-source pollutants for your inventory.

3.  Create report of speciation profiles used, by SCC. Review speciation
    profiles assigned to SCCs representing the top 50%-80% of key
    point-source pollutants for your inventory.

4.  Create reports by state/plant for key states. These should include
    the grid cell in which the plant is located, which should be
    reviewed for correctness. A GIS analysis approach could be helpful
    for this step, to match the grid cells in the report with an
    independent assessment of the state/county. Major sources should be
    reviewed for correct emissions and correct locations.

5.  Create reports with layer fractions for all major power plants in
    key states. Include grid cell in which the plant is located. Perform
    a reality-check on the plume rise; large power plants should have
    high plume rise, but the plumes should still be well distributed
    throughout the model layers.

6.  Create the spatial and temporal profile plots discussed in items 6
    and 7 above for area/nonroad processing, except for the spatial
    plots you need to first condense the I/O API model-ready files to
    2-D instead of 3-D files. The I/O API utility **vertot** can be used
    to sum layers from 3-D files to 2-D files.
:::
:::

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

#### []{#sect_qa_methods_smkreport_mobile}7.5.4.3. On-road mobile sources using MOBILE6 {#on-road-mobile-sources-using-mobile6 .title}

</div>

</div>
:::

The following checks should be performed to ensure that the on-road
mobile-source processing was done properly:

::: {.orderedlist}
1.  Compare state and/or county totals at the following processing steps
    for all grids (if applicable):

    ::: {.orderedlist}
    a.  Inventory import (VMT only)

    b.  Spatial allocation (VMT only)

    c.  Compare emissions among all days by states. Compare sample
        weekday emissions daily-totals with average-day VMT to see if
        sources with high VMT have high emissions. Calculate ratios
        between VMT and emissions and look for outliers.

    d.  Compare temporalized daily-totals with speciation/temporalized
        daily-totals of mass emissions

    e.  Final merge
    :::

    The differences and similarities revealed at each stage should be
    these:

    ::: {.orderedlist}
    a.  Import totals (after **Smkinven** processing) should be the same
        as inventory totals outside of SMOKE (if available)

    b.  Spatial allocation should be the same as the import totals for
        all states/counties except those on a grid boundary. Comparing
        totals after spatial allocation among multiple grids should
        reveal that the emissions totals are the same in all grids for
        states/counties that are completely within the grids.

    c.  Temporal allocation should be different for weekdays, Saturday,
        and Sunday (note: no average-day values are available for
        on-road mobile-source processing using MOBILE6). The differences
        should be in the correct direction: generally, mobile sources
        are lower on weekends. Check any holidays to ensure that Sunday
        emissions were used.

    d.  Chemical speciation should match total mass before and after
        (the SELECT DATA statement in **Smkreport** with the S- prefix
        can be helpful here).

    e.  Final merged files emissions totals from **Smkmerge** should
        match the temporal/speciated emissions reports from
        **Smkreport**.
    :::

2.  Create report of temporal allocation factors used, by SCC; review
    assignments.

3.  Create report of speciation profiles used, by SCC; review
    assignments.

4.  Create reports by state/SCC for key states. Review these for major
    sources (e.g., gasoline fueled automobiles on interstates, heavy
    duty diesel vehicles) and to compare contributions among states to
    see if these make sense.

5.  Create the spatial and temporal profile plots discussed in items 6
    and 7 above for area/nonroad processing ([Section 7.5.4.1, "Area,
    nonroad mobile, and precomputed emissions for on-road mobile
    sources"](ch07s05s04.html#sect_qa_methods_smkreport_area "7.5.4.1. Area, nonroad mobile, and precomputed emissions for on-road mobile sources")).
:::
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  ---------------------------------------------------------- -------------------- -------------------------------
  [Prev](ch07s05s03.html)                                     [Up](ch07s05.html)                [Next](ch08.html)
  7.5.3. Reviewing reports created by SMOKE core programs     [Home](index.html)     Chapter 8. SMOKE Input Files
  ---------------------------------------------------------- -------------------- -------------------------------
:::
