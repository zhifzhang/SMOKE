::: {.navheader}
4.4.23. Generating CMAQ-ready Source Apportionment Input Data Files
:::

[Prev](ch04s04s22.html) 

4.4. How to use SMOKE

 [Next](ch04s04s24.html)

------------------------------------------------------------------------

::: {.section lang="en"}
::: {.titlepage}
<div>

<div>

### []{#sect_scripts_source_apportionment}4.4.23. Generating CMAQ-ready Source Apportionment Input Data Files {#generating-cmaq-ready-source-apportionment-input-data-files .title}

</div>

</div>
:::

Source apportionment in SMOKE consists of grouping sources by
characteristics (i.e. FIPS code, SCC, and point source information) and
then tagging the emissions from those groupings for further analysis in
the air quality model. The SMOKE programs **Movesmrg** and **Smkmerge**
can optionally output the emissions in special files used for later
source apportionment processing.

The following steps outline the process for creating the source
apportionment output files:

::: {.orderedlist}
1.  Define source groups using the `SOURCE_GROUPS`{.envar} file

    The format for the `SOURCE_GROUPS`{.envar} file is described in
    [Section 8.10.13, "`SOURCE_GROUPS`{.envar}: Source apportionment
    groups"](ch08s10s13.html "8.10.13. SOURCE_GROUPS: Source apportionment groups").
    When assigning sources to groups, SMOKE will match each source to
    the most specific line in the `SOURCE_GROUPS`{.envar} file. The
    hierarchy of assignment priority is listed below.

    ::: {.orderedlist}
    a.  Country/state/county code, SCC, plant ID, point ID \[point
        sources only\]

    b.  Country/state/county code, SCC, plant ID \[point sources only\]

    c.  Country/state/county code, plant ID, point ID \[point sources
        only\]

    d.  Country/state/county code, plant ID \[point sources only\]

    e.  Country/state/county code, SCC \[non-biogenic sources only\]

    f.  Country/state code, SCC \[non-biogenic sources only\]

    g.  SCC \[non-biogenic sources only\]

    h.  Country/state/county code

    i.  Country/state code

    j.  Default group (country/state/county code = 0, SCC = 0)
    :::

2.  Define locations for the output files `SRCGROUPS_OUT`{.envar}
    (source group information), `SGINLNTS_L`{.envar} (emissions data),
    and `SRCGRP_REPORT`{.envar} (source group report file)

3.  For point source processing, use in-line plume rise calculation

    Review [Section 4.4.18, "In-line Plume Rise Calculation in CMAQ
    model (as of version
    4.7)"](ch04s04s18.html "4.4.18. In-line Plume Rise Calculation in CMAQ model (as of version 4.7)")
    for instructions on configuring **Elevpoint** and **Laypoint** for
    in-line emissions processing.

4.  After completing other SMOKE processing, run **Movesmrg** (on-road
    mobile emissions using MOVES lookup tables) or **Smkmerge** with
    `SMK_SRCGROUP_OUTPUT_YN`{.envar} set to Y

    When processing emissions using source apportionment, you can only
    run **Smkmerge** for a single source category (i.e. A, B, M, or P).
    For point source processing, **Smkmerge** cannot merge layers
    (`MRG_LAYERS_YN`{.envar} must be N) and in-line emissions must be
    output (`SMK_ELEV_METHOD`{.envar} must be 2). **Movesmrg** and
    **Smkmerge** will create both the source apportionment data files
    and the model-ready output files in a single run. For biogenics, if
    you are running **Smkmerge** for reporting purposes (i.e. to create
    state and county totals), make sure to set the units correctly for
    the source apportionment output data, typically the same as the
    model-ready output units.

5.  Review source grouping assignments

    After running **Movesmrg** or **Smkmerge**, the
    `SRCGRP_REPORT`{.envar} file will list each source in the inventory
    and the group it was assigned to. You can review this report to
    verify that the sources were grouped as desired.
:::
:::

::: {.navfooter}

------------------------------------------------------------------------

  -------------------------- -------------------- -------------------------------------------------------------------
  [Prev](ch04s04s22.html)     [Up](ch04s04.html)                                              [Next](ch04s04s24.html)
  4.4.22. Change reports      [Home](index.html)     4.4.24. Generating AERMOD-ready Input Data Files \[SMOKE4AERMOD)
  -------------------------- -------------------- -------------------------------------------------------------------
:::
